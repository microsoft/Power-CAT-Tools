/*! For license information please see bundle.js.LICENSE.txt */
var pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad;(()=>{var e={641:(e,t,n)=>{e.exports=function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,(function(e){return i(t[a][1][e]||e)}),c,c.exports,e,t,n,r)}return n[a].exports}for(var o=void 0,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){"use strict";var r=e("./utils"),i=e("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,i,a,s,l,c,u=[],d=0,p=e.length,f=p,h="string"!==r.getTypeOf(e);d<e.length;)f=p-d,i=h?(t=e[d++],n=d<p?e[d++]:0,d<p?e[d++]:0):(t=e.charCodeAt(d++),n=d<p?e.charCodeAt(d++):0,d<p?e.charCodeAt(d++):0),a=t>>2,s=(3&t)<<4|n>>4,l=1<f?(15&n)<<2|i>>6:64,c=2<f?63&i:64,u.push(o.charAt(a)+o.charAt(s)+o.charAt(l)+o.charAt(c));return u.join("")},n.decode=function(e){var t,n,r,a,s,l,c=0,u=0,d="data:";if(e.substr(0,5)===d)throw new Error("Invalid base64 input, it looks like a data url.");var p,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===o.charAt(64)&&f--,e.charAt(e.length-2)===o.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(p=i.uint8array?new Uint8Array(0|f):new Array(0|f);c<e.length;)t=o.indexOf(e.charAt(c++))<<2|(a=o.indexOf(e.charAt(c++)))>>4,n=(15&a)<<4|(s=o.indexOf(e.charAt(c++)))>>2,r=(3&s)<<6|(l=o.indexOf(e.charAt(c++))),p[u++]=t,64!==s&&(p[u++]=n),64!==l&&(p[u++]=r);return p}},{"./support":30,"./utils":32}],2:[function(e,t,n){"use strict";var r=e("./external"),i=e("./stream/DataWorker"),o=e("./stream/Crc32Probe"),a=e("./stream/DataLengthProbe");function s(e,t,n,r,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=r,this.compressedContent=i}s.prototype={getContentWorker:function(){var e=new i(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new i(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,n){return e.pipe(new o).pipe(new a("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new a("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){"use strict";var r=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){"use strict";var r=e("./utils"),i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==r.getTypeOf(e)?function(e,t,n){var r=i,o=0+n;e^=-1;for(var a=0;a<o;a++)e=e>>>8^r[255&(e^t[a])];return~e}(0|t,e,e.length):function(e,t,n){var r=i,o=0+n;e^=-1;for(var a=0;a<o;a++)e=e>>>8^r[255&(e^t.charCodeAt(a))];return~e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){"use strict";var r;r="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:r}},{lie:37}],7:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako"),o=e("./utils"),a=e("./stream/GenericWorker"),s=r?"uint8array":"array";function l(e,t){a.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",o.inherits(l,a),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(o.transformTo(s,e.data),!1)},l.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new l("Deflate",e)},n.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){"use strict";function r(e,t){var n,r="";for(n=0;n<t;n++)r+=String.fromCharCode(255&e),e>>>=8;return r}function i(e,t,n,i,a,u){var d,p,f=e.file,h=e.compression,m=u!==s.utf8encode,g=o.transformTo("string",u(f.name)),v=o.transformTo("string",s.utf8encode(f.name)),y=f.comment,b=o.transformTo("string",u(y)),w=o.transformTo("string",s.utf8encode(y)),_=v.length!==f.name.length,k=w.length!==y.length,S="",C="",A="",x=f.dir,N=f.date,E={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(E.crc32=e.crc32,E.compressedSize=e.compressedSize,E.uncompressedSize=e.uncompressedSize);var I=0;t&&(I|=8),m||!_&&!k||(I|=2048);var O=0,R=0;x&&(O|=16),"UNIX"===a?(R=798,O|=function(e,t){var n=e;return e||(n=t?16893:33204),(65535&n)<<16}(f.unixPermissions,x)):(R=20,O|=function(e){return 63&(e||0)}(f.dosPermissions)),d=N.getUTCHours(),d<<=6,d|=N.getUTCMinutes(),d<<=5,d|=N.getUTCSeconds()/2,p=N.getUTCFullYear()-1980,p<<=4,p|=N.getUTCMonth()+1,p<<=5,p|=N.getUTCDate(),_&&(C=r(1,1)+r(l(g),4)+v,S+="up"+r(C.length,2)+C),k&&(A=r(1,1)+r(l(b),4)+w,S+="uc"+r(A.length,2)+A);var D="";return D+="\n\0",D+=r(I,2),D+=h.magic,D+=r(d,2),D+=r(p,2),D+=r(E.crc32,4),D+=r(E.compressedSize,4),D+=r(E.uncompressedSize,4),D+=r(g.length,2),D+=r(S.length,2),{fileRecord:c.LOCAL_FILE_HEADER+D+g+S,dirRecord:c.CENTRAL_FILE_HEADER+r(R,2)+D+r(b.length,2)+"\0\0\0\0"+r(O,4)+r(i,4)+g+S+b}}var o=e("../utils"),a=e("../stream/GenericWorker"),s=e("../utf8"),l=e("../crc32"),c=e("../signature");function u(e,t,n,r){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(u,a),u.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,a.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-r-1))/n:100}}))},u.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=i(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=i(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:function(e){return c.DATA_DESCRIPTOR+r(e.crc32,4)+r(e.compressedSize,4)+r(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e,i=function(e,t,n,i,a){var s=o.transformTo("string",a(i));return c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(e,2)+r(e,2)+r(t,4)+r(n,4)+r(s.length,2)+s}(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},u.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(e){var t=this._sources;if(!a.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},u.prototype.lock=function(){a.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){"use strict";var r=e("../compressions"),i=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var o=new i(t.streamFiles,n,t.platform,t.encodeFileName),a=0;try{e.forEach((function(e,n){a++;var i=function(e,t){var n=e||t,i=r[n];if(!i)throw new Error(n+" is not a valid compression method !");return i}(n.options.compression,t.compression),s=n.options.compressionOptions||t.compressionOptions||{},l=n.dir,c=n.date;n._compressWorker(i,s).withStreamInfo("file",{name:e,dir:l,date:c,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(o)})),o.entriesCount=a}catch(e){o.error(e)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){"use strict";function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new r;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.10.1",r.loadAsync=function(e,t){return(new r).loadAsync(e,t)},r.external=e("./external"),t.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){"use strict";var r=e("./utils"),i=e("./external"),o=e("./utf8"),a=e("./zipEntries"),s=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function c(e){return new i.Promise((function(t,n){var r=e.decompressed.getContentWorker().pipe(new s);r.on("error",(function(e){n(e)})).on("end",(function(){r.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}t.exports=function(e,t){var n=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),l.isNode&&l.isStream(e)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var n=new a(t);return n.load(e),n})).then((function(e){var n=[i.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var o=0;o<r.length;o++)n.push(c(r[o]));return i.Promise.all(n)})).then((function(e){for(var i=e.shift(),o=i.files,a=0;a<o.length;a++){var s=o[a],l=s.fileNameStr,c=r.resolve(s.fileNameStr);n.file(c,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders}),s.dir||(n.file(c).unsafeOriginalName=l)}return i.zipComment.length&&(n.comment=i.zipComment),n}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){"use strict";var r=e("../utils"),i=e("../stream/GenericWorker");function o(e,t){i.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(o,i),o.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},o.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){"use strict";var r=e("readable-stream").Readable;function i(e,t,n){r.call(this,t),this._helper=e;var i=this;e.on("data",(function(e,t){i.push(e)||i._helper.pause(),n&&n(t)})).on("error",(function(e){i.emit("error",e)})).on("end",(function(){i.push(null)}))}e("../utils").inherits(i,r),i.prototype._read=function(){this._helper.resume()},t.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){"use strict";function r(e,t,n){var r,i=o.getTypeOf(t),s=o.extend(n||{},l);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(e=m(e)),s.createFolders&&(r=h(e))&&g.call(this,r,!0);var d="string"===i&&!1===s.binary&&!1===s.base64;n&&void 0!==n.binary||(s.binary=!d),(t instanceof c&&0===t.uncompressedSize||s.dir||!t||0===t.length)&&(s.base64=!1,s.binary=!0,t="",s.compression="STORE",i="string");var v;v=t instanceof c||t instanceof a?t:p.isNode&&p.isStream(t)?new f(e,t):o.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var y=new u(e,v,s);this.files[e]=y}var i=e("./utf8"),o=e("./utils"),a=e("./stream/GenericWorker"),s=e("./stream/StreamHelper"),l=e("./defaults"),c=e("./compressedObject"),u=e("./zipObject"),d=e("./generate"),p=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),h=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:l.createFolders,e=m(e),this.files[e]||r.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function v(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,r;for(t in this.files)r=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,r)},filter:function(e){var t=[];return this.forEach((function(n,r){e(n,r)&&t.push(r)})),t},file:function(e,t,n){if(1!==arguments.length)return e=this.root+e,r.call(this,e,t,n),this;if(v(e)){var i=e;return this.filter((function(e,t){return!t.dir&&i.test(e)}))}var o=this.files[this.root+e];return o&&!o.dir?o:null},folder:function(e){if(!e)return this;if(v(e))return this.filter((function(t,n){return n.dir&&e.test(t)}));var t=this.root+e,n=g.call(this,t),r=this.clone();return r.root=n.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter((function(t,n){return n.name.slice(0,e.length)===e})),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=o.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");o.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var r=n.comment||this.comment||"";t=d.generateWorker(this,n,r)}catch(e){(t=new a("error")).error(e)}return new s(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){"use strict";var r=e("./DataReader");function i(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),o=this.length-4;0<=o;--o)if(this.data[o]===t&&this.data[o+1]===n&&this.data[o+2]===r&&this.data[o+3]===i)return o-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),o=this.readData(4);return t===o[0]&&n===o[1]&&r===o[2]&&i===o[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){"use strict";var r=e("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,n){"use strict";var r=e("./Uint8ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){"use strict";var r=e("./DataReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){"use strict";var r=e("./ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){"use strict";var r=e("../utils"),i=e("../support"),o=e("./ArrayReader"),a=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),"string"!==t||i.uint8array?"nodebuffer"===t?new s(e):i.uint8array?new l(r.transformTo("uint8array",e)):new o(r.transformTo("array",e)):new a(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,n){"use strict";var r=e("./GenericWorker"),i=e("../utils");function o(e){r.call(this,"ConvertWorker to "+e),this.destType=e}i.inherits(o,r),o.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},t.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){"use strict";var r=e("./GenericWorker"),i=e("../crc32");function o(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(o,r),o.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./GenericWorker");function o(e){i.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(o,i),o.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},t.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./GenericWorker");function o(e){i.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}r.inherits(o,i),o.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){"use strict";function r(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=r},{}],29:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./ConvertWorker"),o=e("./GenericWorker"),a=e("../base64"),s=e("../support"),l=e("../external"),c=null;if(s.nodestream)try{c=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function u(e,t,n){var a=t;switch(t){case"blob":case"arraybuffer":a="uint8array";break;case"base64":a="string"}try{this._internalType=a,this._outputType=t,this._mimeType=n,r.checkSupport(a),this._worker=e.pipe(new i(a)),e.lock()}catch(e){this._worker=new o("error"),this._worker.error(e)}}u.prototype={accumulate:function(e){return function(e,t){return new l.Promise((function(n,i){var o=[],s=e._internalType,l=e._outputType,c=e._mimeType;e.on("data",(function(e,n){o.push(e),t&&t(n)})).on("error",(function(e){o=[],i(e)})).on("end",(function(){try{var e=function(e,t,n){switch(e){case"blob":return r.newBlob(r.transformTo("arraybuffer",t),n);case"base64":return a.encode(t);default:return r.transformTo(e,t)}}(l,function(e,t){var n,r=0,i=null,o=0;for(n=0;n<t.length;n++)o+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(i=new Uint8Array(o),n=0;n<t.length;n++)i.set(t[n],r),r+=t[n].length;return i;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,o),c);n(e)}catch(e){i(e)}o=[]})).resume()}))}(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,(function(e){t.call(n,e.data,e.meta)})):this._worker.on(e,(function(){r.delay(t,arguments,n)})),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var r=new ArrayBuffer(0);try{n.blob=0===new Blob([r],{type:"application/zip"}).size}catch(e){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(r),n.blob=0===i.getBlob("application/zip").size}catch(e){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(e){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){"use strict";for(var r=e("./utils"),i=e("./support"),o=e("./nodejsUtils"),a=e("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){a.call(this,"utf-8 decode"),this.leftOver=null}function u(){a.call(this,"utf-8 encode")}s[254]=s[254]=1,n.utf8encode=function(e){return i.nodebuffer?o.newBufferFrom(e,"utf-8"):function(e){var t,n,r,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=i.uint8array?new Uint8Array(l):new Array(l),o=a=0;a<l;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),n<128?t[a++]=n:(n<2048?t[a++]=192|n>>>6:(n<65536?t[a++]=224|n>>>12:(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63),t[a++]=128|n>>>6&63),t[a++]=128|63&n);return t}(e)},n.utf8decode=function(e){return i.nodebuffer?r.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,i,o,a=e.length,l=new Array(2*a);for(t=n=0;t<a;)if((i=e[t++])<128)l[n++]=i;else if(4<(o=s[i]))l[n++]=65533,t+=o-1;else{for(i&=2===o?31:3===o?15:7;1<o&&t<a;)i=i<<6|63&e[t++],o--;1<o?l[n++]=65533:i<65536?l[n++]=i:(i-=65536,l[n++]=55296|i>>10&1023,l[n++]=56320|1023&i)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),r.applyFromCharCode(l)}(e=r.transformTo(i.uint8array?"uint8array":"array",e))},r.inherits(c,a),c.prototype.processChunk=function(e){var t=r.transformTo(i.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var o=t;(t=new Uint8Array(o.length+this.leftOver.length)).set(this.leftOver,0),t.set(o,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var a=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+s[e[n]]>t?n:t}(t),l=t;a!==t.length&&(i.uint8array?(l=t.subarray(0,a),this.leftOver=t.subarray(a,t.length)):(l=t.slice(0,a),this.leftOver=t.slice(a,t.length))),this.push({data:n.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=c,r.inherits(u,a),u.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){"use strict";var r=e("./support"),i=e("./base64"),o=e("./nodejsUtils"),a=e("./external");function s(e){return e}function l(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}e("setimmediate"),n.newBlob=function(e,t){n.checkSupport("blob");try{return new Blob([e],{type:t})}catch(n){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return r.append(e),r.getBlob(t)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(e,t,n){var r=[],i=0,o=e.length;if(o<=n)return String.fromCharCode.apply(null,e);for(;i<o;)"array"===t||"nodebuffer"===t?r.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+n,o)))):r.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+n,o)))),i+=n;return r.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,o.allocBuffer(1)).length}catch(e){return!1}}()}};function u(e){var t=65536,r=n.getTypeOf(e),i=!0;if("uint8array"===r?i=c.applyCanBeUsed.uint8array:"nodebuffer"===r&&(i=c.applyCanBeUsed.nodebuffer),i)for(;1<t;)try{return c.stringifyByChunk(e,r,t)}catch(e){t=Math.floor(t/2)}return c.stringifyByChar(e)}function d(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.applyFromCharCode=u;var p={};p.string={string:s,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return p.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,o.allocBuffer(e.length))}},p.array={string:u,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(e)}},p.arraybuffer={string:function(e){return u(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(new Uint8Array(e))}},p.uint8array={string:u,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return o.newBufferFrom(e)}},p.nodebuffer={string:u,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return p.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:s},n.transformTo=function(e,t){if(t=t||"",!e)return t;n.checkSupport(e);var r=n.getTypeOf(t);return p[r][e](t)},n.resolve=function(e){for(var t=e.split("/"),n=[],r=0;r<t.length;r++){var i=t[r];"."===i||""===i&&0!==r&&r!==t.length-1||(".."===i?n.pop():n.push(i))}return n.join("/")},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":r.nodebuffer&&o.isBuffer(e)?"nodebuffer":r.uint8array&&e instanceof Uint8Array?"uint8array":r.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,r="";for(n=0;n<(e||"").length;n++)r+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return r},n.delay=function(e,t,n){setImmediate((function(){e.apply(n||null,t||[])}))},n.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,o,s,c){return a.Promise.resolve(t).then((function(e){return r.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new a.Promise((function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){n(e.target.error)},r.readAsArrayBuffer(e)})):e})).then((function(t){var u=n.getTypeOf(t);return u?("arraybuffer"===u?t=n.transformTo("uint8array",t):"string"===u&&(c?t=i.decode(t):o&&!0!==s&&(t=function(e){return l(e,r.uint8array?new Uint8Array(e.length):new Array(e.length))}(t))),t):a.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),i=e("./utils"),o=e("./signature"),a=e("./zipEntry"),s=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(t)+", expected "+i.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4)===t;return this.reader.setIndex(n),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",n=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var r=t-n;if(0<r)this.isSignature(t,o.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw new Error("Corrupted zip: missing "+Math.abs(r)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),i=e("./utils"),o=e("./compressedObject"),a=e("./crc32"),s=e("./utf8"),l=e("./compressions"),c=e("./support");function u(e,t){this.options=e,this.loadOptions=t}u.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=r(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,n,r,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),n=e.readInt(2),r=e.readData(n),this.extraFields[t]={id:t,length:n,value:r};e.setIndex(i)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=i.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var o=i.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(o)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)||a(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)||a(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},t.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){"use strict";function r(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var i=e("./stream/StreamHelper"),o=e("./stream/DataWorker"),a=e("./utf8"),s=e("./compressedObject"),l=e("./stream/GenericWorker");r.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var o=!this._dataBinary;o&&!r&&(t=t.pipe(new a.Utf8EncodeWorker)),!o&&r&&(t=t.pipe(new a.Utf8DecodeWorker))}catch(e){(t=new l("error")).error(e)}return new i(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof s&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new a.Utf8EncodeWorker)),s.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof l?this._data:new o(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<c.length;d++)r.prototype[c[d]]=u;t.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){(function(e){"use strict";var n,r,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var o=0,a=new i(u),s=e.document.createTextNode("");a.observe(s,{characterData:!0}),n=function(){s.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,n=function(){l.port2.postMessage(0)}}var c=[];function u(){var e,t;r=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}r=!1}t.exports=function(e){1!==c.push(e)||r||n()}}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){"use strict";var r=e("immediate");function i(){}var o={},a=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==i&&f(this,e)}function u(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(e,t,n){r((function(){var r;try{r=t(n)}catch(r){return o.reject(e,r)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)}))}function p(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var n=!1;function r(t){n||(n=!0,o.reject(e,t))}function i(t){n||(n=!0,o.resolve(e,t))}var a=h((function(){t(i,r)}));"error"===a.status&&r(a.value)}function h(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}(t.exports=c).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){throw n}))}))},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===a)return this;var n=new this.constructor(i);return this.state!==l?d(n,this.state===s?e:t,this.outcome):this.queue.push(new u(n,e,t)),n},u.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){o.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},o.resolve=function(e,t){var n=h(p,t);if("error"===n.status)return o.reject(e,n.value);var r=n.value;if(r)f(e,r);else{e.state=s,e.outcome=t;for(var i=-1,a=e.queue.length;++i<a;)e.queue[i].callFulfilled(t)}return e},o.reject=function(e,t){e.state=a,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:o.resolve(new this(i),e)},c.reject=function(e){var t=new this(i);return o.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var a=new Array(n),s=0,l=-1,c=new this(i);++l<n;)u(e[l],l);return c;function u(e,i){t.resolve(e).then((function(e){a[i]=e,++s!==n||r||(r=!0,o.resolve(c,a))}),(function(e){r||(r=!0,o.reject(c,e))}))}},c.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return this.resolve([]);for(var r,a=-1,s=new this(i);++a<t;)r=e[a],this.resolve(r).then((function(e){n||(n=!0,o.resolve(s,e))}),(function(e){n||(n=!0,o.reject(s,e))}));return s}},{immediate:36}],38:[function(e,t,n){"use strict";var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){"use strict";var r=e("./zlib/deflate"),i=e("./utils/common"),o=e("./utils/strings"),a=e("./zlib/messages"),s=e("./zlib/zstream"),l=Object.prototype.toString,c=0,u=-1,d=0,p=8;function f(e){if(!(this instanceof f))return new f(e);this.options=i.assign({level:u,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==c)throw new Error(a[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var h;if(h="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=r.deflateSetDictionary(this.strm,h))!==c)throw new Error(a[n]);this._dict_set=!0}}function h(e,t){var n=new f(t);if(n.push(e,!0),n.err)throw n.msg||a[n.err];return n.result}f.prototype.push=function(e,t){var n,a,s=this.strm,u=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=o.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(u),s.next_out=0,s.avail_out=u),1!==(n=r.deflate(s,a))&&n!==c)return this.onEnd(n),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==n);return 4===a?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===c):2!==a||(this.onEnd(c),!(s.avail_out=0))},f.prototype.onData=function(e){this.chunks.push(e)},f.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=f,n.deflate=h,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,h(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){"use strict";var r=e("./zlib/inflate"),i=e("./utils/common"),o=e("./utils/strings"),a=e("./zlib/constants"),s=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),u=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==a.Z_OK)throw new Error(s[n]);this.header=new c,r.inflateGetHeader(this.strm,this.header)}function p(e,t){var n=new d(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}d.prototype.push=function(e,t){var n,s,l,c,d,p,f=this.strm,h=this.options.chunkSize,m=this.options.dictionary,g=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?f.input=o.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new i.Buf8(h),f.next_out=0,f.avail_out=h),(n=r.inflate(f,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&m&&(p="string"==typeof m?o.string2buf(m):"[object ArrayBuffer]"===u.call(m)?new Uint8Array(m):m,n=r.inflateSetDictionary(this.strm,p)),n===a.Z_BUF_ERROR&&!0===g&&(n=a.Z_OK,g=!1),n!==a.Z_STREAM_END&&n!==a.Z_OK)return this.onEnd(n),!(this.ended=!0);f.next_out&&(0!==f.avail_out&&n!==a.Z_STREAM_END&&(0!==f.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(f.output,f.next_out),c=f.next_out-l,d=o.buf2string(f.output,l),f.next_out=c,f.avail_out=h-c,c&&i.arraySet(f.output,f.output,l,c,0),this.onData(d)):this.onData(i.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(g=!0)}while((0<f.avail_in||0===f.avail_out)&&n!==a.Z_STREAM_END);return n===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),!(f.avail_out=0))},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=d,n.inflate=p,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,p(e,t)},n.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){var t,n,r,i,o,a;for(t=r=0,n=e.length;t<n;t++)r+=e[t].length;for(a=new Uint8Array(r),t=i=0,n=e.length;t<n;t++)o=e[t],a.set(o,i),i+=o.length;return a}},o={arraySet:function(e,t,n,r,i){for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(r)},{}],42:[function(e,t,n){"use strict";var r=e("./common"),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var a=new r.Buf8(256),s=0;s<256;s++)a[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function l(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",a=0;a<t;a++)n+=String.fromCharCode(e[a]);return n}a[254]=a[254]=1,n.string2buf=function(e){var t,n,i,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(l),o=a=0;a<l;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?t[a++]=n:(n<2048?t[a++]=192|n>>>6:(n<65536?t[a++]=224|n>>>12:(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63),t[a++]=128|n>>>6&63),t[a++]=128|63&n);return t},n.buf2binstring=function(e){return l(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,i,o,s=t||e.length,c=new Array(2*s);for(n=r=0;n<s;)if((i=e[n++])<128)c[r++]=i;else if(4<(o=a[i]))c[r++]=65533,n+=o-1;else{for(i&=2===o?31:3===o?15:7;1<o&&n<s;)i=i<<6|63&e[n++],o--;1<o?c[r++]=65533:i<65536?c[r++]=i:(i-=65536,c[r++]=55296|i>>10&1023,c[r++]=56320|1023&i)}return l(c,r)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+a[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){for(var i=65535&e,o=e>>>16&65535,a=0;0!==n;){for(n-=a=2e3<n?2e3:n;o=o+(i=i+t[r++]|0)|0,--a;);i%=65521,o%=65521}return i|o<<16}},{}],44:[function(e,t,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){"use strict";var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,i){var o=r,a=i+n;e^=-1;for(var s=i;s<a;s++)e=e>>>8^o[255&(e^t[s])];return~e}},{}],46:[function(e,t,n){"use strict";var r,i=e("../utils/common"),o=e("./trees"),a=e("./adler32"),s=e("./crc32"),l=e("./messages"),c=0,u=0,d=-2,p=2,f=8,h=286,m=30,g=19,v=2*h+1,y=15,b=3,w=258,_=w+b+1,k=42,S=113;function C(e,t){return e.msg=l[t],t}function A(e){return(e<<1)-(4<e?9:0)}function x(e){for(var t=e.length;0<=--t;)e[t]=0}function N(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(i.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function E(e,t){o._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,N(e.strm)}function I(e,t){e.pending_buf[e.pending++]=t}function O(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function R(e,t){var n,r,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-_?e.strstart-(e.w_size-_):0,c=e.window,u=e.w_mask,d=e.prev,p=e.strstart+w,f=c[o+a-1],h=c[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(n=t)+a]===h&&c[n+a-1]===f&&c[n]===c[o]&&c[++n]===c[o+1]){o+=2,n++;do{}while(c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&o<p);if(r=w-(p-o),o=p-w,a<r){if(e.match_start=t,s<=(a=r))break;f=c[o+a-1],h=c[o+a]}}}while((t=d[t&u])>l&&0!=--i);return a<=e.lookahead?a:e.lookahead}function D(e){var t,n,r,o,l,c,u,d,p,f,h=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=h+(h-_)){for(i.arraySet(e.window,e.window,h,h,0),e.match_start-=h,e.strstart-=h,e.block_start-=h,t=n=e.hash_size;r=e.head[--t],e.head[t]=h<=r?r-h:0,--n;);for(t=n=h;r=e.prev[--t],e.prev[t]=h<=r?r-h:0,--n;);o+=h}if(0===e.strm.avail_in)break;if(c=e.strm,u=e.window,d=e.strstart+e.lookahead,f=void 0,(p=o)<(f=c.avail_in)&&(f=p),n=0===f?0:(c.avail_in-=f,i.arraySet(u,c.input,c.next_in,f,d),1===c.state.wrap?c.adler=a(c.adler,u,f,d):2===c.state.wrap&&(c.adler=s(c.adler,u,f,d)),c.next_in+=f,c.total_in+=f,f),e.lookahead+=n,e.lookahead+e.insert>=b)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+b-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<b)););}while(e.lookahead<_&&0!==e.strm.avail_in)}function P(e,t){for(var n,r;;){if(e.lookahead<_){if(D(e),e.lookahead<_&&t===c)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=b&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+b-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-_&&(e.match_length=R(e,n)),e.match_length>=b)if(r=o._tr_tally(e,e.strstart-e.match_start,e.match_length-b),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=b){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+b-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(E(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<b-1?e.strstart:b-1,4===t?(E(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(E(e,!1),0===e.strm.avail_out)?1:2}function F(e,t){for(var n,r,i;;){if(e.lookahead<_){if(D(e),e.lookahead<_&&t===c)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=b&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+b-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=b-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-_&&(e.match_length=R(e,n),e.match_length<=5&&(1===e.strategy||e.match_length===b&&4096<e.strstart-e.match_start)&&(e.match_length=b-1)),e.prev_length>=b&&e.match_length<=e.prev_length){for(i=e.strstart+e.lookahead-b,r=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-b),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+b-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=b-1,e.strstart++,r&&(E(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=o._tr_tally(e,0,e.window[e.strstart-1]))&&E(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<b-1?e.strstart:b-1,4===t?(E(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(E(e,!1),0===e.strm.avail_out)?1:2}function T(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function z(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=f,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*v),this.dyn_dtree=new i.Buf16(2*(2*m+1)),this.bl_tree=new i.Buf16(2*(2*g+1)),x(this.dyn_ltree),x(this.dyn_dtree),x(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(y+1),this.heap=new i.Buf16(2*h+1),x(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*h+1),x(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function L(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=p,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?k:S,e.adler=2===t.wrap?0:1,t.last_flush=c,o._tr_init(t),u):C(e,d)}function j(e){var t=L(e);return t===u&&function(e){e.window_size=2*e.w_size,x(e.head),e.max_lazy_match=r[e.level].max_lazy,e.good_match=r[e.level].good_length,e.nice_match=r[e.level].nice_length,e.max_chain_length=r[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=b-1,e.match_available=0,e.ins_h=0}(e.state),t}function M(e,t,n,r,o,a){if(!e)return d;var s=1;if(-1===t&&(t=6),r<0?(s=0,r=-r):15<r&&(s=2,r-=16),o<1||9<o||n!==f||r<8||15<r||t<0||9<t||a<0||4<a)return C(e,d);8===r&&(r=9);var l=new z;return(e.state=l).strm=e,l.wrap=s,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+b-1)/b),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=n,j(e)}r=[new T(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(D(e),0===e.lookahead&&t===c)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,E(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-_&&(E(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(E(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(E(e,!1),e.strm.avail_out),1)})),new T(4,4,8,4,P),new T(4,5,16,8,P),new T(4,6,32,32,P),new T(4,4,16,16,F),new T(8,16,32,32,F),new T(8,16,128,128,F),new T(8,32,128,256,F),new T(32,128,258,1024,F),new T(32,258,258,4096,F)],n.deflateInit=function(e,t){return M(e,t,f,15,8,0)},n.deflateInit2=M,n.deflateReset=j,n.deflateResetKeep=L,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?d:(e.state.gzhead=t,u):d},n.deflate=function(e,t){var n,i,a,l;if(!e||!e.state||5<t||t<0)return e?C(e,d):d;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&4!==t)return C(e,0===e.avail_out?-5:d);if(i.strm=e,n=i.last_flush,i.last_flush=t,i.status===k)if(2===i.wrap)e.adler=0,I(i,31),I(i,139),I(i,8),i.gzhead?(I(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),I(i,255&i.gzhead.time),I(i,i.gzhead.time>>8&255),I(i,i.gzhead.time>>16&255),I(i,i.gzhead.time>>24&255),I(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),I(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(I(i,255&i.gzhead.extra.length),I(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=s(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(I(i,0),I(i,0),I(i,0),I(i,0),I(i,0),I(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),I(i,3),i.status=S);else{var p=f+(i.w_bits-8<<4)<<8;p|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(p|=32),p+=31-p%31,i.status=S,O(i,p),0!==i.strstart&&(O(i,e.adler>>>16),O(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(a=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),N(e),a=i.pending,i.pending!==i.pending_buf_size));)I(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),N(e),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,I(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),N(e),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,I(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&N(e),i.pending+2<=i.pending_buf_size&&(I(i,255&e.adler),I(i,e.adler>>8&255),e.adler=0,i.status=S)):i.status=S),0!==i.pending){if(N(e),0===e.avail_out)return i.last_flush=-1,u}else if(0===e.avail_in&&A(t)<=A(n)&&4!==t)return C(e,-5);if(666===i.status&&0!==e.avail_in)return C(e,-5);if(0!==e.avail_in||0!==i.lookahead||t!==c&&666!==i.status){var h=2===i.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(D(e),0===e.lookahead)){if(t===c)return 1;break}if(e.match_length=0,n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(E(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(E(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(E(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var n,r,i,a,s=e.window;;){if(e.lookahead<=w){if(D(e),e.lookahead<=w&&t===c)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=b&&0<e.strstart&&(r=s[i=e.strstart-1])===s[++i]&&r===s[++i]&&r===s[++i]){a=e.strstart+w;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<a);e.match_length=w-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=b?(n=o._tr_tally(e,1,e.match_length-b),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(E(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(E(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(E(e,!1),0===e.strm.avail_out)?1:2}(i,t):r[i.level].func(i,t);if(3!==h&&4!==h||(i.status=666),1===h||3===h)return 0===e.avail_out&&(i.last_flush=-1),u;if(2===h&&(1===t?o._tr_align(i):5!==t&&(o._tr_stored_block(i,0,0,!1),3===t&&(x(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),N(e),0===e.avail_out))return i.last_flush=-1,u}return 4!==t?u:i.wrap<=0?1:(2===i.wrap?(I(i,255&e.adler),I(i,e.adler>>8&255),I(i,e.adler>>16&255),I(i,e.adler>>24&255),I(i,255&e.total_in),I(i,e.total_in>>8&255),I(i,e.total_in>>16&255),I(i,e.total_in>>24&255)):(O(i,e.adler>>>16),O(i,65535&e.adler)),N(e),0<i.wrap&&(i.wrap=-i.wrap),0!==i.pending?u:1)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==k&&69!==t&&73!==t&&91!==t&&103!==t&&t!==S&&666!==t?C(e,d):(e.state=null,t===S?C(e,-3):u):d},n.deflateSetDictionary=function(e,t){var n,r,o,s,l,c,p,f,h=t.length;if(!e||!e.state)return d;if(2===(s=(n=e.state).wrap)||1===s&&n.status!==k||n.lookahead)return d;for(1===s&&(e.adler=a(e.adler,t,h,0)),n.wrap=0,h>=n.w_size&&(0===s&&(x(n.head),n.strstart=0,n.block_start=0,n.insert=0),f=new i.Buf8(n.w_size),i.arraySet(f,t,h-n.w_size,n.w_size,0),t=f,h=n.w_size),l=e.avail_in,c=e.next_in,p=e.input,e.avail_in=h,e.next_in=0,e.input=t,D(n);n.lookahead>=b;){for(r=n.strstart,o=n.lookahead-(b-1);n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+b-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++,--o;);n.strstart=r,n.lookahead=b-1,D(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=b-1,n.match_available=0,e.next_in=c,e.input=p,e.avail_in=l,n.wrap=s,u},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){"use strict";t.exports=function(e,t){var n,r,i,o,a,s,l,c,u,d,p,f,h,m,g,v,y,b,w,_,k,S,C,A,x;n=e.state,r=e.next_in,A=e.input,i=r+(e.avail_in-5),o=e.next_out,x=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=n.dmax,c=n.wsize,u=n.whave,d=n.wnext,p=n.window,f=n.hold,h=n.bits,m=n.lencode,g=n.distcode,v=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{h<15&&(f+=A[r++]<<h,h+=8,f+=A[r++]<<h,h+=8),b=m[f&v];t:for(;;){if(f>>>=w=b>>>24,h-=w,0==(w=b>>>16&255))x[o++]=65535&b;else{if(!(16&w)){if(!(64&w)){b=m[(65535&b)+(f&(1<<w)-1)];continue t}if(32&w){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}_=65535&b,(w&=15)&&(h<w&&(f+=A[r++]<<h,h+=8),_+=f&(1<<w)-1,f>>>=w,h-=w),h<15&&(f+=A[r++]<<h,h+=8,f+=A[r++]<<h,h+=8),b=g[f&y];n:for(;;){if(f>>>=w=b>>>24,h-=w,!(16&(w=b>>>16&255))){if(!(64&w)){b=g[(65535&b)+(f&(1<<w)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(k=65535&b,h<(w&=15)&&(f+=A[r++]<<h,(h+=8)<w&&(f+=A[r++]<<h,h+=8)),l<(k+=f&(1<<w)-1)){e.msg="invalid distance too far back",n.mode=30;break e}if(f>>>=w,h-=w,(w=o-a)<k){if(u<(w=k-w)&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(C=p,(S=0)===d){if(S+=c-w,w<_){for(_-=w;x[o++]=p[S++],--w;);S=o-k,C=x}}else if(d<w){if(S+=c+d-w,(w-=d)<_){for(_-=w;x[o++]=p[S++],--w;);if(S=0,d<_){for(_-=w=d;x[o++]=p[S++],--w;);S=o-k,C=x}}}else if(S+=d-w,w<_){for(_-=w;x[o++]=p[S++],--w;);S=o-k,C=x}for(;2<_;)x[o++]=C[S++],x[o++]=C[S++],x[o++]=C[S++],_-=3;_&&(x[o++]=C[S++],1<_&&(x[o++]=C[S++]))}else{for(S=o-k;x[o++]=x[S++],x[o++]=x[S++],x[o++]=x[S++],2<(_-=3););_&&(x[o++]=x[S++],1<_&&(x[o++]=x[S++]))}break}}break}}while(r<i&&o<s);r-=_=h>>3,f&=(1<<(h-=_<<3))-1,e.next_in=r,e.next_out=o,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=o<s?s-o+257:257-(o-s),n.hold=f,n.bits=h}},{}],49:[function(e,t,n){"use strict";var r=e("../utils/common"),i=e("./adler32"),o=e("./crc32"),a=e("./inffast"),s=e("./inftrees"),l=0,c=-2,u=1,d=852,p=592;function f(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function h(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function m(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=u,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(d),t.distcode=t.distdyn=new r.Buf32(p),t.sane=1,t.back=-1,l):c}function g(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,m(e)):c}function v(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?c:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,g(e))):c}function y(e,t){var n,r;return e?(r=new h,(e.state=r).window=null,(n=v(e,t))!==l&&(e.state=null),n):c}var b,w,_=!0;function k(e){if(_){var t;for(b=new r.Buf32(512),w=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,b,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,w,0,e.work,{bits:5}),_=!1}e.lencode=b,e.lenbits=9,e.distcode=w,e.distbits=5}function S(e,t,n,i){var o,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new r.Buf8(a.wsize)),i>=a.wsize?(r.arraySet(a.window,t,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(i<(o=a.wsize-a.wnext)&&(o=i),r.arraySet(a.window,t,n-i,o,a.wnext),(i-=o)?(r.arraySet(a.window,t,n-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}n.inflateReset=g,n.inflateReset2=v,n.inflateResetKeep=m,n.inflateInit=function(e){return y(e,15)},n.inflateInit2=y,n.inflate=function(e,t){var n,d,p,h,m,g,v,y,b,w,_,C,A,x,N,E,I,O,R,D,P,F,T,z,L=0,j=new r.Buf8(4),M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return c;12===(n=e.state).mode&&(n.mode=13),m=e.next_out,p=e.output,v=e.avail_out,h=e.next_in,d=e.input,g=e.avail_in,y=n.hold,b=n.bits,w=g,_=v,F=l;e:for(;;)switch(n.mode){case u:if(0===n.wrap){n.mode=13;break}for(;b<16;){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}if(2&n.wrap&&35615===y){j[n.check=0]=255&y,j[1]=y>>>8&255,n.check=o(n.check,j,2,0),b=y=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&y)<<8)+(y>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&y)){e.msg="unknown compression method",n.mode=30;break}if(b-=4,P=8+(15&(y>>>=4)),0===n.wbits)n.wbits=P;else if(P>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<P,e.adler=n.check=1,n.mode=512&y?10:12,b=y=0;break;case 2:for(;b<16;){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}if(n.flags=y,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=y>>8&1),512&n.flags&&(j[0]=255&y,j[1]=y>>>8&255,n.check=o(n.check,j,2,0)),b=y=0,n.mode=3;case 3:for(;b<32;){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}n.head&&(n.head.time=y),512&n.flags&&(j[0]=255&y,j[1]=y>>>8&255,j[2]=y>>>16&255,j[3]=y>>>24&255,n.check=o(n.check,j,4,0)),b=y=0,n.mode=4;case 4:for(;b<16;){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}n.head&&(n.head.xflags=255&y,n.head.os=y>>8),512&n.flags&&(j[0]=255&y,j[1]=y>>>8&255,n.check=o(n.check,j,2,0)),b=y=0,n.mode=5;case 5:if(1024&n.flags){for(;b<16;){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}n.length=y,n.head&&(n.head.extra_len=y),512&n.flags&&(j[0]=255&y,j[1]=y>>>8&255,n.check=o(n.check,j,2,0)),b=y=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(g<(C=n.length)&&(C=g),C&&(n.head&&(P=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,d,h,C,P)),512&n.flags&&(n.check=o(n.check,d,C,h)),g-=C,h+=C,n.length-=C),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===g)break e;for(C=0;P=d[h+C++],n.head&&P&&n.length<65536&&(n.head.name+=String.fromCharCode(P)),P&&C<g;);if(512&n.flags&&(n.check=o(n.check,d,C,h)),g-=C,h+=C,P)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===g)break e;for(C=0;P=d[h+C++],n.head&&P&&n.length<65536&&(n.head.comment+=String.fromCharCode(P)),P&&C<g;);if(512&n.flags&&(n.check=o(n.check,d,C,h)),g-=C,h+=C,P)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;b<16;){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}if(y!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}b=y=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;b<32;){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}e.adler=n.check=f(y),b=y=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=m,e.avail_out=v,e.next_in=h,e.avail_in=g,n.hold=y,n.bits=b,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){y>>>=7&b,b-=7&b,n.mode=27;break}for(;b<3;){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}switch(n.last=1&y,b-=1,3&(y>>>=1)){case 0:n.mode=14;break;case 1:if(k(n),n.mode=20,6!==t)break;y>>>=2,b-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}y>>>=2,b-=2;break;case 14:for(y>>>=7&b,b-=7&b;b<32;){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}if((65535&y)!=(y>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&y,b=y=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(C=n.length){if(g<C&&(C=g),v<C&&(C=v),0===C)break e;r.arraySet(p,d,h,C,m),g-=C,h+=C,v-=C,m+=C,n.length-=C;break}n.mode=12;break;case 17:for(;b<14;){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}if(n.nlen=257+(31&y),y>>>=5,b-=5,n.ndist=1+(31&y),y>>>=5,b-=5,n.ncode=4+(15&y),y>>>=4,b-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;b<3;){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}n.lens[M[n.have++]]=7&y,y>>>=3,b-=3}for(;n.have<19;)n.lens[M[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,T={bits:n.lenbits},F=s(0,n.lens,0,19,n.lencode,0,n.work,T),n.lenbits=T.bits,F){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;E=(L=n.lencode[y&(1<<n.lenbits)-1])>>>16&255,I=65535&L,!((N=L>>>24)<=b);){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}if(I<16)y>>>=N,b-=N,n.lens[n.have++]=I;else{if(16===I){for(z=N+2;b<z;){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}if(y>>>=N,b-=N,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}P=n.lens[n.have-1],C=3+(3&y),y>>>=2,b-=2}else if(17===I){for(z=N+3;b<z;){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}b-=N,P=0,C=3+(7&(y>>>=N)),y>>>=3,b-=3}else{for(z=N+7;b<z;){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}b-=N,P=0,C=11+(127&(y>>>=N)),y>>>=7,b-=7}if(n.have+C>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;C--;)n.lens[n.have++]=P}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,T={bits:n.lenbits},F=s(1,n.lens,0,n.nlen,n.lencode,0,n.work,T),n.lenbits=T.bits,F){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,T={bits:n.distbits},F=s(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,T),n.distbits=T.bits,F){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=g&&258<=v){e.next_out=m,e.avail_out=v,e.next_in=h,e.avail_in=g,n.hold=y,n.bits=b,a(e,_),m=e.next_out,p=e.output,v=e.avail_out,h=e.next_in,d=e.input,g=e.avail_in,y=n.hold,b=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;E=(L=n.lencode[y&(1<<n.lenbits)-1])>>>16&255,I=65535&L,!((N=L>>>24)<=b);){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}if(E&&!(240&E)){for(O=N,R=E,D=I;E=(L=n.lencode[D+((y&(1<<O+R)-1)>>O)])>>>16&255,I=65535&L,!(O+(N=L>>>24)<=b);){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}y>>>=O,b-=O,n.back+=O}if(y>>>=N,b-=N,n.back+=N,n.length=I,0===E){n.mode=26;break}if(32&E){n.back=-1,n.mode=12;break}if(64&E){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&E,n.mode=22;case 22:if(n.extra){for(z=n.extra;b<z;){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}n.length+=y&(1<<n.extra)-1,y>>>=n.extra,b-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;E=(L=n.distcode[y&(1<<n.distbits)-1])>>>16&255,I=65535&L,!((N=L>>>24)<=b);){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}if(!(240&E)){for(O=N,R=E,D=I;E=(L=n.distcode[D+((y&(1<<O+R)-1)>>O)])>>>16&255,I=65535&L,!(O+(N=L>>>24)<=b);){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}y>>>=O,b-=O,n.back+=O}if(y>>>=N,b-=N,n.back+=N,64&E){e.msg="invalid distance code",n.mode=30;break}n.offset=I,n.extra=15&E,n.mode=24;case 24:if(n.extra){for(z=n.extra;b<z;){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}n.offset+=y&(1<<n.extra)-1,y>>>=n.extra,b-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===v)break e;if(C=_-v,n.offset>C){if((C=n.offset-C)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}A=C>n.wnext?(C-=n.wnext,n.wsize-C):n.wnext-C,C>n.length&&(C=n.length),x=n.window}else x=p,A=m-n.offset,C=n.length;for(v<C&&(C=v),v-=C,n.length-=C;p[m++]=x[A++],--C;);0===n.length&&(n.mode=21);break;case 26:if(0===v)break e;p[m++]=n.length,v--,n.mode=21;break;case 27:if(n.wrap){for(;b<32;){if(0===g)break e;g--,y|=d[h++]<<b,b+=8}if(_-=v,e.total_out+=_,n.total+=_,_&&(e.adler=n.check=n.flags?o(n.check,p,_,m-_):i(n.check,p,_,m-_)),_=v,(n.flags?y:f(y))!==n.check){e.msg="incorrect data check",n.mode=30;break}b=y=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;b<32;){if(0===g)break e;g--,y+=d[h++]<<b,b+=8}if(y!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}b=y=0}n.mode=29;case 29:F=1;break e;case 30:F=-3;break e;case 31:return-4;default:return c}return e.next_out=m,e.avail_out=v,e.next_in=h,e.avail_in=g,n.hold=y,n.bits=b,(n.wsize||_!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&S(e,e.output,e.next_out,_-e.avail_out)?(n.mode=31,-4):(w-=e.avail_in,_-=e.avail_out,e.total_in+=w,e.total_out+=_,n.total+=_,n.wrap&&_&&(e.adler=n.check=n.flags?o(n.check,p,_,e.next_out-_):i(n.check,p,_,e.next_out-_)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==w&&0===_||4===t)&&F===l&&(F=-5),F)},n.inflateEnd=function(e){if(!e||!e.state)return c;var t=e.state;return t.window&&(t.window=null),e.state=null,l},n.inflateGetHeader=function(e,t){var n;return e&&e.state&&2&(n=e.state).wrap?((n.head=t).done=!1,l):c},n.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?c:11===n.mode&&i(1,t,r,0)!==n.check?-3:S(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,l):c},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){"use strict";var r=e("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,l,c,u,d,p){var f,h,m,g,v,y,b,w,_,k=p.bits,S=0,C=0,A=0,x=0,N=0,E=0,I=0,O=0,R=0,D=0,P=null,F=0,T=new r.Buf16(16),z=new r.Buf16(16),L=null,j=0;for(S=0;S<=15;S++)T[S]=0;for(C=0;C<l;C++)T[t[n+C]]++;for(N=k,x=15;1<=x&&0===T[x];x--);if(x<N&&(N=x),0===x)return c[u++]=20971520,c[u++]=20971520,p.bits=1,0;for(A=1;A<x&&0===T[A];A++);for(N<A&&(N=A),S=O=1;S<=15;S++)if(O<<=1,(O-=T[S])<0)return-1;if(0<O&&(0===e||1!==x))return-1;for(z[1]=0,S=1;S<15;S++)z[S+1]=z[S]+T[S];for(C=0;C<l;C++)0!==t[n+C]&&(d[z[t[n+C]]++]=C);if(y=0===e?(P=L=d,19):1===e?(P=i,F-=257,L=o,j-=257,256):(P=a,L=s,-1),S=A,v=u,I=C=D=0,m=-1,g=(R=1<<(E=N))-1,1===e&&852<R||2===e&&592<R)return 1;for(;;){for(b=S-I,_=d[C]<y?(w=0,d[C]):d[C]>y?(w=L[j+d[C]],P[F+d[C]]):(w=96,0),f=1<<S-I,A=h=1<<E;c[v+(D>>I)+(h-=f)]=b<<24|w<<16|_,0!==h;);for(f=1<<S-1;D&f;)f>>=1;if(0!==f?(D&=f-1,D+=f):D=0,C++,0==--T[S]){if(S===x)break;S=t[n+d[C]]}if(N<S&&(D&g)!==m){for(0===I&&(I=N),v+=A,O=1<<(E=S-I);E+I<x&&!((O-=T[E+I])<=0);)E++,O<<=1;if(R+=1<<E,1===e&&852<R||2===e&&592<R)return 1;c[m=D&g]=N<<24|E<<16|v-u}}return 0!==D&&(c[v+D]=S-I<<24|64<<16),p.bits=N,0}},{"../utils/common":41}],51:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){"use strict";var r=e("../utils/common");function i(e){for(var t=e.length;0<=--t;)e[t]=0}var o=256,a=286,s=30,l=15,c=16,u=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],d=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],f=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],h=new Array(576);i(h);var m=new Array(60);i(m);var g=new Array(512);i(g);var v=new Array(256);i(v);var y=new Array(29);i(y);var b,w,_,k=new Array(s);function S(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function C(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function A(e){return e<256?g[e]:g[256+(e>>>7)]}function x(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function N(e,t,n){e.bi_valid>c-n?(e.bi_buf|=t<<e.bi_valid&65535,x(e,e.bi_buf),e.bi_buf=t>>c-e.bi_valid,e.bi_valid+=n-c):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function E(e,t,n){N(e,n[2*t],n[2*t+1])}function I(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function O(e,t,n){var r,i,o=new Array(l+1),a=0;for(r=1;r<=l;r++)o[r]=a=a+n[r-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=I(o[s]++,s))}}function R(e){var t;for(t=0;t<a;t++)e.dyn_ltree[2*t]=0;for(t=0;t<s;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function D(e){8<e.bi_valid?x(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function P(e,t,n,r){var i=2*t,o=2*n;return e[i]<e[o]||e[i]===e[o]&&r[t]<=r[n]}function F(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&P(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!P(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function T(e,t,n){var r,i,a,s,l=0;if(0!==e.last_lit)for(;r=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],i=e.pending_buf[e.l_buf+l],l++,0===r?E(e,i,t):(E(e,(a=v[i])+o+1,t),0!==(s=u[a])&&N(e,i-=y[a],s),E(e,a=A(--r),n),0!==(s=d[a])&&N(e,r-=k[a],s)),l<e.last_lit;);E(e,256,t)}function z(e,t){var n,r,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,c=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<c;n++)0!==o[2*n]?(e.heap[++e.heap_len]=u=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=u,n=e.heap_len>>1;1<=n;n--)F(e,o,n);for(i=c;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],F(e,o,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,o[2*i]=o[2*n]+o[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,o[2*n+1]=o[2*r+1]=i,e.heap[1]=i++,F(e,o,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,o,a,s,c=t.dyn_tree,u=t.max_code,d=t.stat_desc.static_tree,p=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,h=t.stat_desc.extra_base,m=t.stat_desc.max_length,g=0;for(o=0;o<=l;o++)e.bl_count[o]=0;for(c[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)m<(o=c[2*c[2*(r=e.heap[n])+1]+1]+1)&&(o=m,g++),c[2*r+1]=o,u<r||(e.bl_count[o]++,a=0,h<=r&&(a=f[r-h]),s=c[2*r],e.opt_len+=s*(o+a),p&&(e.static_len+=s*(d[2*r+1]+a)));if(0!==g){do{for(o=m-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[m]--,g-=2}while(0<g);for(o=m;0!==o;o--)for(r=e.bl_count[o];0!==r;)u<(i=e.heap[--n])||(c[2*i+1]!==o&&(e.opt_len+=(o-c[2*i+1])*c[2*i],c[2*i+1]=o),r--)}}(e,t),O(o,u,e.bl_count)}function L(e,t,n){var r,i,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=a,a=t[2*(r+1)+1],++s<l&&i===a||(s<c?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=i,c=(s=0)===a?(l=138,3):i===a?(l=6,3):(l=7,4))}function j(e,t,n){var r,i,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),r=0;r<=n;r++)if(i=a,a=t[2*(r+1)+1],!(++s<l&&i===a)){if(s<c)for(;E(e,i,e.bl_tree),0!=--s;);else 0!==i?(i!==o&&(E(e,i,e.bl_tree),s--),E(e,16,e.bl_tree),N(e,s-3,2)):s<=10?(E(e,17,e.bl_tree),N(e,s-3,3)):(E(e,18,e.bl_tree),N(e,s-11,7));o=i,c=(s=0)===a?(l=138,3):i===a?(l=6,3):(l=7,4)}}i(k);var M=!1;function U(e,t,n,i){N(e,0+(i?1:0),3),function(e,t,n){D(e),x(e,n),x(e,~n),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n)}n._tr_init=function(e){M||(function(){var e,t,n,r,i,o=new Array(l+1);for(r=n=0;r<28;r++)for(y[r]=n,e=0;e<1<<u[r];e++)v[n++]=r;for(v[n-1]=r,r=i=0;r<16;r++)for(k[r]=i,e=0;e<1<<d[r];e++)g[i++]=r;for(i>>=7;r<s;r++)for(k[r]=i<<7,e=0;e<1<<d[r]-7;e++)g[256+i++]=r;for(t=0;t<=l;t++)o[t]=0;for(e=0;e<=143;)h[2*e+1]=8,e++,o[8]++;for(;e<=255;)h[2*e+1]=9,e++,o[9]++;for(;e<=279;)h[2*e+1]=7,e++,o[7]++;for(;e<=287;)h[2*e+1]=8,e++,o[8]++;for(O(h,287,o),e=0;e<s;e++)m[2*e+1]=5,m[2*e]=I(e,5);b=new S(h,u,257,a,l),w=new S(m,d,0,s,l),_=new S(new Array(0),p,0,19,7)}(),M=!0),e.l_desc=new C(e.dyn_ltree,b),e.d_desc=new C(e.dyn_dtree,w),e.bl_desc=new C(e.bl_tree,_),e.bi_buf=0,e.bi_valid=0,R(e)},n._tr_stored_block=U,n._tr_flush_block=function(e,t,n,r){var i,a,s=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<o;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),z(e,e.l_desc),z(e,e.d_desc),s=function(e){var t;for(L(e,e.dyn_ltree,e.l_desc.max_code),L(e,e.dyn_dtree,e.d_desc.max_code),z(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*f[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=i&&(i=a)):i=a=n+5,n+4<=i&&-1!==t?U(e,t,n,r):4===e.strategy||a===i?(N(e,2+(r?1:0),3),T(e,h,m)):(N(e,4+(r?1:0),3),function(e,t,n,r){var i;for(N(e,t-257,5),N(e,n-1,5),N(e,r-4,4),i=0;i<r;i++)N(e,e.bl_tree[2*f[i]+1],3);j(e,e.dyn_ltree,t-1),j(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),T(e,e.dyn_ltree,e.dyn_dtree)),R(e),r&&D(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(v[n]+o+1)]++,e.dyn_dtree[2*A(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){N(e,2,3),E(e,256,h),function(e){16===e.bi_valid?(x(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,r){(function(e){!function(e,t){"use strict";if(!e.setImmediate){var n,r,i,o,a=1,s={},l=!1,c=e.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(e);u=u&&u.setTimeout?u:e,n="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick((function(){p(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(o="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",f,!1):e.attachEvent("onmessage",f),function(t){e.postMessage(o+t,"*")}):e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){p(e.data)},function(e){i.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(r=c.documentElement,function(e){var t=c.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):function(e){setTimeout(p,0,e)},u.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var i={callback:e,args:t};return s[a]=i,n(a),a++},u.clearImmediate=d}function d(e){delete s[e]}function p(e){if(l)setTimeout(p,0,e);else{var n=s[e];if(n){l=!0;try{!function(e){var n=e.callback,r=e.args;switch(r.length){case 0:n();break;case 1:n(r[0]);break;case 2:n(r[0],r[1]);break;case 3:n(r[0],r[1],r[2]);break;default:n.apply(t,r)}}(n)}finally{d(e),l=!1}}}}function f(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&p(+t.data.slice(o.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},86:e=>{"use strict";function t(e){try{return JSON.stringify(e)}catch(e){return'"[Circular]"'}}e.exports=function(e,n,r){var i=r&&r.stringify||t;if("object"==typeof e&&null!==e){var o=n.length+1;if(1===o)return e;var a=new Array(o);a[0]=i(e);for(var s=1;s<o;s++)a[s]=i(n[s]);return a.join(" ")}if("string"!=typeof e)return e;var l=n.length;if(0===l)return e;for(var c="",u=0,d=-1,p=e&&e.length||0,f=0;f<p;){if(37===e.charCodeAt(f)&&f+1<p){switch(d=d>-1?d:0,e.charCodeAt(f+1)){case 100:case 102:if(u>=l)break;if(null==n[u])break;d<f&&(c+=e.slice(d,f)),c+=Number(n[u]),d=f+2,f++;break;case 105:if(u>=l)break;if(null==n[u])break;d<f&&(c+=e.slice(d,f)),c+=Math.floor(Number(n[u])),d=f+2,f++;break;case 79:case 111:case 106:if(u>=l)break;if(void 0===n[u])break;d<f&&(c+=e.slice(d,f));var h=typeof n[u];if("string"===h){c+="'"+n[u]+"'",d=f+2,f++;break}if("function"===h){c+=n[u].name||"<anonymous>",d=f+2,f++;break}c+=i(n[u]),d=f+2,f++;break;case 115:if(u>=l)break;d<f&&(c+=e.slice(d,f)),c+=String(n[u]),d=f+2,f++;break;case 37:d<f&&(c+=e.slice(d,f)),c+="%",d=f+2,f++,u--}++u}++f}return-1===d?e:(d<p&&(c+=e.slice(d)),c)}},451:(e,t,n)=>{"use strict";var r=n(86);e.exports=d;var i=function(){function e(e){return void 0!==e&&e}try{return"undefined"!=typeof globalThis||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{},o={mapHttpRequest:v,mapHttpResponse:v,wrapRequestSerializer:y,wrapResponseSerializer:y,wrapErrorSerializer:y,req:v,res:v,err:m,errWithCause:m};function a(e,t){return"silent"===e?1/0:t.levels.values[e]}var s=Symbol("pino.logFuncs"),l=Symbol("pino.hierarchy"),c={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function u(e,t){var n={logger:t,parent:e[l]};t[l]=n}function d(e){(e=e||{}).browser=e.browser||{};var t=e.browser.transmit;if(t&&"function"!=typeof t.send)throw Error("pino: transmit option must have a send function");var n=e.browser.write||i;e.browser.write&&(e.browser.asObject=!0);var r=e.serializers||{},o=function(e,t){return Array.isArray(e)?e.filter((function(e){return"!stdSerializers.err"!==e})):!0===e&&Object.keys(t)}(e.browser.serialize,r),l=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(l=!1);var m=Object.keys(e.customLevels||{}),v=["error","fatal","warn","info","debug","trace"].concat(m);"function"==typeof n&&v.forEach((function(e){n[e]=n})),(!1===e.enabled||e.browser.disabled)&&(e.level="silent");var y=e.level||"info",w=Object.create(n);w.log||(w.log=b),function(e,t,n){var r={};t.forEach((e=>{r[e]=n[e]?n[e]:i[e]||i[c[e]||"log"]||b})),e[s]=r}(w,v,n),u({},w),Object.defineProperty(w,"levelVal",{get:function(){return a(this.level,this)}}),Object.defineProperty(w,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,p(this,_,w,"error"),p(this,_,w,"fatal"),p(this,_,w,"warn"),p(this,_,w,"info"),p(this,_,w,"debug"),p(this,_,w,"trace"),m.forEach((e=>{p(this,_,w,e)}))}});var _={transmit:t,serialize:o,asObject:e.browser.asObject,formatters:e.browser.formatters,levels:v,timestamp:g(e),messageKey:e.messageKey||"msg",onChild:e.onChild||b};function k(n,i,a){if(!i)throw new Error("missing bindings for child Pino");a=a||{},o&&i.serializers&&(a.serializers=i.serializers);var s=a.serializers;if(o&&s){var l=Object.assign({},r,s),c=!0===e.browser.serialize?Object.keys(l):o;delete i.serializers,f([i],c,l,this._stdErrSerialize)}function d(e){this._childLevel=1+(0|e._childLevel),this.bindings=i,l&&(this.serializers=l,this._serialize=c),t&&(this._logEvent=h([].concat(e._logEvent.bindings,i)))}d.prototype=this;var p=new d(this);return u(this,p),p.child=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return k.call(this,n,...t)},p.level=a.level||this.level,n.onChild(p),p}return w.levels=function(e){var t,n,r=e.customLevels||{};return{values:Object.assign({},d.levels.values,r),labels:Object.assign({},d.levels.labels,(t=r,n={},Object.keys(t).forEach((function(e){n[t[e]]=e})),n))}}(e),w.level=y,w.setMaxListeners=w.getMaxListeners=w.emit=w.addListener=w.on=w.prependListener=w.once=w.prependOnceListener=w.removeListener=w.removeAllListeners=w.listeners=w.listenerCount=w.eventNames=w.write=w.flush=b,w.serializers=r,w._serialize=o,w._stdErrSerialize=l,w.child=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return k.call(this,_,...t)},t&&(w._logEvent=h()),w}function p(e,t,n,o){if(Object.defineProperty(e,o,{value:a(e.level,n)>a(o,n)?b:n[s][o],writable:!0,enumerable:!0,configurable:!0}),e[o]===b){if(!t.transmit)return;var c=t.transmit.level||e.level,u=n.levels.values[c];if(n.levels.values[o]<u)return}e[o]=function(e,t,n,o){return l=e[s][o],function(){for(var s=t.timestamp(),c=new Array(arguments.length),u=Object.getPrototypeOf&&Object.getPrototypeOf(this)===i?i:this,d=0;d<c.length;d++)c[d]=arguments[d];var p=!1;if(t.serialize&&(f(c,this._serialize,this.serializers,this._stdErrSerialize),p=!0),t.asObject||t.formatters?l.call(u,function(e,t,n,i,o){var{level:a,log:s=e=>e}=o.formatters||{},l=n.slice(),c=l[0],u={};if(i&&(u.time=i),a){var d=a(t,e.levels.values[t]);Object.assign(u,d)}else u.level=e.levels.values[t];var p=1+(0|e._childLevel);if(p<1&&(p=1),null!==c&&"object"==typeof c){for(;p--&&"object"==typeof l[0];)Object.assign(u,l.shift());c=l.length?r(l.shift(),l):void 0}else"string"==typeof c&&(c=r(l.shift(),l));return void 0!==c&&(u[o.messageKey]=c),s(u)}(this,o,c,s,t)):l.apply(u,c),t.transmit){var m=t.transmit.level||e._level,g=n.levels.values[m],v=n.levels.values[o];if(v<g)return;!function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=t.send,o=t.ts,a=t.methodLevel,s=t.methodValue,l=t.val,c=e._logEvent.bindings;r||f(n,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=o,e._logEvent.messages=n.filter((function(e){return-1===c.indexOf(e)})),e._logEvent.level.label=a,e._logEvent.level.value=s,i(a,e._logEvent,l),e._logEvent=h(c)}(this,{ts:s,methodLevel:o,methodValue:v,transmitLevel:m,transmitValue:n.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:a(e._level,n)},c,p)}};var l}(e,t,n,o);var d=function(e){var t=[];e.bindings&&t.push(e.bindings);for(var n=e[l];n.parent;)(n=n.parent).logger.bindings&&t.push(n.logger.bindings);return t.reverse()}(e);0!==d.length&&(e[o]=function(e,t){return function(){return t.apply(this,[...e,...arguments])}}(d,e[o]))}function f(e,t,n,r){for(var i in e)if(r&&e[i]instanceof Error)e[i]=d.stdSerializers.err(e[i]);else if("object"==typeof e[i]&&!Array.isArray(e[i])&&t)for(var o in e[i])t.indexOf(o)>-1&&o in n&&(e[i][o]=n[o](e[i][o]))}function h(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function m(e){var t={type:e.constructor.name,msg:e.message,stack:e.stack};for(var n in e)void 0===t[n]&&(t[n]=e[n]);return t}function g(e){return"function"==typeof e.timestamp?e.timestamp:!1===e.timestamp?w:_}function v(){return{}}function y(e){return e}function b(){}function w(){return!1}function _(){return Date.now()}d.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},d.stdSerializers=o,d.stdTimeFunctions=Object.assign({},{nullTime:w,epochTime:_,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}}),e.exports.default=d,e.exports.pino=d}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.r(r),n.d(r,{IntelligentReviewVisualizer:()=>kr});const e=React,t=FluentUIReactv940;var i=n(641),o=n.n(i);function a(e){return null==e}var s={isNothing:a,isObject:function(e){return"object"==typeof e&&null!==e},toArray:function(e){return Array.isArray(e)?e:a(e)?[]:[e]},repeat:function(e,t){var n,r="";for(n=0;n<t;n+=1)r+=e;return r},isNegativeZero:function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e},extend:function(e,t){var n,r,i,o;if(t)for(n=0,r=(o=Object.keys(t)).length;n<r;n+=1)e[i=o[n]]=t[i];return e}};function l(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+="\n\n"+e.mark.snippet),r+" "+n):r}function c(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=l(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}c.prototype=Object.create(Error.prototype),c.prototype.constructor=c,c.prototype.toString=function(e){return this.name+": "+l(this,e)};var u=c;function d(e,t,n,r,i){var o="",a="",s=Math.floor(i/2)-1;return r-t>s&&(t=r-s+(o=" ... ").length),n-r>s&&(n=r+s-(a=" ...").length),{str:o+e.slice(t,n).replace(/\t/g,"→")+a,pos:r-t+o.length}}function p(e,t){return s.repeat(" ",t-e.length)+e}var f=function(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var n,r=/\r?\n|\r|\0/g,i=[0],o=[],a=-1;n=r.exec(e.buffer);)o.push(n.index),i.push(n.index+n[0].length),e.position<=n.index&&a<0&&(a=i.length-2);a<0&&(a=i.length-1);var l,c,u="",f=Math.min(e.line+t.linesAfter,o.length).toString().length,h=t.maxLength-(t.indent+f+3);for(l=1;l<=t.linesBefore&&!(a-l<0);l++)c=d(e.buffer,i[a-l],o[a-l],e.position-(i[a]-i[a-l]),h),u=s.repeat(" ",t.indent)+p((e.line-l+1).toString(),f)+" | "+c.str+"\n"+u;for(c=d(e.buffer,i[a],o[a],e.position,h),u+=s.repeat(" ",t.indent)+p((e.line+1).toString(),f)+" | "+c.str+"\n",u+=s.repeat("-",t.indent+f+3+c.pos)+"^\n",l=1;l<=t.linesAfter&&!(a+l>=o.length);l++)c=d(e.buffer,i[a+l],o[a+l],e.position-(i[a]-i[a+l]),h),u+=s.repeat(" ",t.indent)+p((e.line+l+1).toString(),f)+" | "+c.str+"\n";return u.replace(/\n$/,"")},h=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],m=["scalar","sequence","mapping"],g=function(e,t){if(t=t||{},Object.keys(t).forEach((function(t){if(-1===h.indexOf(t))throw new u('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')})),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=function(e){var t={};return null!==e&&Object.keys(e).forEach((function(n){e[n].forEach((function(e){t[String(e)]=n}))})),t}(t.styleAliases||null),-1===m.indexOf(this.kind))throw new u('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')};function v(e,t){var n=[];return e[t].forEach((function(e){var t=n.length;n.forEach((function(n,r){n.tag===e.tag&&n.kind===e.kind&&n.multi===e.multi&&(t=r)})),n[t]=e})),n}function y(e){return this.extend(e)}y.prototype.extend=function(e){var t=[],n=[];if(e instanceof g)n.push(e);else if(Array.isArray(e))n=n.concat(e);else{if(!e||!Array.isArray(e.implicit)&&!Array.isArray(e.explicit))throw new u("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit))}t.forEach((function(e){if(!(e instanceof g))throw new u("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new u("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new u("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")})),n.forEach((function(e){if(!(e instanceof g))throw new u("Specified list of YAML types (or a single Type object) contains a non-Type object.")}));var r=Object.create(y.prototype);return r.implicit=(this.implicit||[]).concat(t),r.explicit=(this.explicit||[]).concat(n),r.compiledImplicit=v(r,"implicit"),r.compiledExplicit=v(r,"explicit"),r.compiledTypeMap=function(){var e,t,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function r(e){e.multi?(n.multi[e.kind].push(e),n.multi.fallback.push(e)):n[e.kind][e.tag]=n.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(r);return n}(r.compiledImplicit,r.compiledExplicit),r};var b=y,w=new g("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),_=new g("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),k=new g("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}}),S=new b({explicit:[w,_,k]}),C=new g("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),A=new g("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function x(e){return 48<=e&&e<=55}function N(e){return 48<=e&&e<=57}var E=new g("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,r=e.length,i=0,o=!1;if(!r)return!1;if("-"!==(t=e[i])&&"+"!==t||(t=e[++i]),"0"===t){if(i+1===r)return!0;if("b"===(t=e[++i])){for(i++;i<r;i++)if("_"!==(t=e[i])){if("0"!==t&&"1"!==t)return!1;o=!0}return o&&"_"!==t}if("x"===t){for(i++;i<r;i++)if("_"!==(t=e[i])){if(!(48<=(n=e.charCodeAt(i))&&n<=57||65<=n&&n<=70||97<=n&&n<=102))return!1;o=!0}return o&&"_"!==t}if("o"===t){for(i++;i<r;i++)if("_"!==(t=e[i])){if(!x(e.charCodeAt(i)))return!1;o=!0}return o&&"_"!==t}}if("_"===t)return!1;for(;i<r;i++)if("_"!==(t=e[i])){if(!N(e.charCodeAt(i)))return!1;o=!0}return!(!o||"_"===t)},construct:function(e){var t,n=e,r=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),"-"!==(t=n[0])&&"+"!==t||("-"===t&&(r=-1),t=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===t){if("b"===n[1])return r*parseInt(n.slice(2),2);if("x"===n[1])return r*parseInt(n.slice(2),16);if("o"===n[1])return r*parseInt(n.slice(2),8)}return r*parseInt(n,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!s.isNegativeZero(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),I=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),O=/^[-+]?[0-9]+e/,R=new g("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!(!I.test(e)||"_"===e[e.length-1])},construct:function(e){var t,n;return n="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:n*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||s.isNegativeZero(e))},represent:function(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(s.isNegativeZero(e))return"-0.0";return n=e.toString(10),O.test(n)?n.replace("e",".e"):n},defaultStyle:"lowercase"}),D=S.extend({implicit:[C,A,E,R]}),P=D,F=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),T=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),z=new g("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==F.exec(e)||null!==T.exec(e))},construct:function(e){var t,n,r,i,o,a,s,l,c=0,u=null;if(null===(t=F.exec(e))&&(t=T.exec(e)),null===t)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(n,r,i));if(o=+t[4],a=+t[5],s=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(u=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(u=-u)),l=new Date(Date.UTC(n,r,i,o,a,s,c)),u&&l.setTime(l.getTime()-u),l},instanceOf:Date,represent:function(e){return e.toISOString()}}),L=new g("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}}),j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",M=new g("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,r=0,i=e.length,o=j;for(n=0;n<i;n++)if(!((t=o.indexOf(e.charAt(n)))>64)){if(t<0)return!1;r+=6}return r%8==0},construct:function(e){var t,n,r=e.replace(/[\r\n=]/g,""),i=r.length,o=j,a=0,s=[];for(t=0;t<i;t++)t%4==0&&t&&(s.push(a>>16&255),s.push(a>>8&255),s.push(255&a)),a=a<<6|o.indexOf(r.charAt(t));return 0==(n=i%4*6)?(s.push(a>>16&255),s.push(a>>8&255),s.push(255&a)):18===n?(s.push(a>>10&255),s.push(a>>2&255)):12===n&&s.push(a>>4&255),new Uint8Array(s)},predicate:function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},represent:function(e){var t,n,r="",i=0,o=e.length,a=j;for(t=0;t<o;t++)t%3==0&&t&&(r+=a[i>>18&63],r+=a[i>>12&63],r+=a[i>>6&63],r+=a[63&i]),i=(i<<8)+e[t];return 0==(n=o%3)?(r+=a[i>>18&63],r+=a[i>>12&63],r+=a[i>>6&63],r+=a[63&i]):2===n?(r+=a[i>>10&63],r+=a[i>>4&63],r+=a[i<<2&63],r+=a[64]):1===n&&(r+=a[i>>2&63],r+=a[i<<4&63],r+=a[64],r+=a[64]),r}}),U=Object.prototype.hasOwnProperty,B=Object.prototype.toString,V=new g("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,r,i,o,a=[],s=e;for(t=0,n=s.length;t<n;t+=1){if(r=s[t],o=!1,"[object Object]"!==B.call(r))return!1;for(i in r)if(U.call(r,i)){if(o)return!1;o=!0}if(!o)return!1;if(-1!==a.indexOf(i))return!1;a.push(i)}return!0},construct:function(e){return null!==e?e:[]}}),W=Object.prototype.toString,q=new g("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,r,i,o,a=e;for(o=new Array(a.length),t=0,n=a.length;t<n;t+=1){if(r=a[t],"[object Object]"!==W.call(r))return!1;if(1!==(i=Object.keys(r)).length)return!1;o[t]=[i[0],r[i[0]]]}return!0},construct:function(e){if(null===e)return[];var t,n,r,i,o,a=e;for(o=new Array(a.length),t=0,n=a.length;t<n;t+=1)r=a[t],i=Object.keys(r),o[t]=[i[0],r[i[0]]];return o}}),Z=Object.prototype.hasOwnProperty,H=new g("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,n=e;for(t in n)if(Z.call(n,t)&&null!==n[t])return!1;return!0},construct:function(e){return null!==e?e:{}}}),K=P.extend({implicit:[z,L],explicit:[M,V,q,H]}),G=Object.prototype.hasOwnProperty,Y=1,Q=2,J=3,X=4,$=1,ee=2,te=3,ne=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,re=/[\x85\u2028\u2029]/,ie=/[,\[\]\{\}]/,oe=/^(?:!|!!|![a-z\-]+!)$/i,ae=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function se(e){return Object.prototype.toString.call(e)}function le(e){return 10===e||13===e}function ce(e){return 9===e||32===e}function ue(e){return 9===e||32===e||10===e||13===e}function de(e){return 44===e||91===e||93===e||123===e||125===e}function pe(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function fe(e){return 48===e?"\0":97===e?"":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"":95===e?" ":76===e?"\u2028":80===e?"\u2029":""}function he(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}for(var me=new Array(256),ge=new Array(256),ve=0;ve<256;ve++)me[ve]=fe(ve)?1:0,ge[ve]=fe(ve);function ye(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||K,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function be(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=f(n),new u(t,n)}function we(e,t){throw be(e,t)}function _e(e,t){e.onWarning&&e.onWarning.call(null,be(e,t))}var ke={YAML:function(e,t,n){var r,i,o;null!==e.version&&we(e,"duplication of %YAML directive"),1!==n.length&&we(e,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(n[0]))&&we(e,"ill-formed argument of the YAML directive"),i=parseInt(r[1],10),o=parseInt(r[2],10),1!==i&&we(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=o<2,1!==o&&2!==o&&_e(e,"unsupported YAML version of the document")},TAG:function(e,t,n){var r,i;2!==n.length&&we(e,"TAG directive accepts exactly two arguments"),r=n[0],i=n[1],oe.test(r)||we(e,"ill-formed tag handle (first argument) of the TAG directive"),G.call(e.tagMap,r)&&we(e,'there is a previously declared suffix for "'+r+'" tag handle'),ae.test(i)||we(e,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch(t){we(e,"tag prefix is malformed: "+i)}e.tagMap[r]=i}};function Se(e,t,n,r){var i,o,a,s;if(t<n){if(s=e.input.slice(t,n),r)for(i=0,o=s.length;i<o;i+=1)9===(a=s.charCodeAt(i))||32<=a&&a<=1114111||we(e,"expected valid JSON character");else ne.test(s)&&we(e,"the stream contains non-printable characters");e.result+=s}}function Ce(e,t,n,r){var i,o,a,l;for(s.isObject(n)||we(e,"cannot merge mappings; the provided source object is unacceptable"),a=0,l=(i=Object.keys(n)).length;a<l;a+=1)o=i[a],G.call(t,o)||(t[o]=n[o],r[o]=!0)}function Ae(e,t,n,r,i,o,a,s,l){var c,u;if(Array.isArray(i))for(c=0,u=(i=Array.prototype.slice.call(i)).length;c<u;c+=1)Array.isArray(i[c])&&we(e,"nested arrays are not supported inside keys"),"object"==typeof i&&"[object Object]"===se(i[c])&&(i[c]="[object Object]");if("object"==typeof i&&"[object Object]"===se(i)&&(i="[object Object]"),i=String(i),null===t&&(t={}),"tag:yaml.org,2002:merge"===r)if(Array.isArray(o))for(c=0,u=o.length;c<u;c+=1)Ce(e,t,o[c],n);else Ce(e,t,o,n);else e.json||G.call(n,i)||!G.call(t,i)||(e.line=a||e.line,e.lineStart=s||e.lineStart,e.position=l||e.position,we(e,"duplicated mapping key")),"__proto__"===i?Object.defineProperty(t,i,{configurable:!0,enumerable:!0,writable:!0,value:o}):t[i]=o,delete n[i];return t}function xe(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):we(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function Ne(e,t,n){for(var r=0,i=e.input.charCodeAt(e.position);0!==i;){for(;ce(i);)9===i&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&35===i)do{i=e.input.charCodeAt(++e.position)}while(10!==i&&13!==i&&0!==i);if(!le(i))break;for(xe(e),i=e.input.charCodeAt(e.position),r++,e.lineIndent=0;32===i;)e.lineIndent++,i=e.input.charCodeAt(++e.position)}return-1!==n&&0!==r&&e.lineIndent<n&&_e(e,"deficient indentation"),r}function Ee(e){var t,n=e.position;return!(45!==(t=e.input.charCodeAt(n))&&46!==t||t!==e.input.charCodeAt(n+1)||t!==e.input.charCodeAt(n+2)||(n+=3,0!==(t=e.input.charCodeAt(n))&&!ue(t)))}function Ie(e,t){1===t?e.result+=" ":t>1&&(e.result+=s.repeat("\n",t-1))}function Oe(e,t){var n,r,i=e.tag,o=e.anchor,a=[],s=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=a),r=e.input.charCodeAt(e.position);0!==r&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,we(e,"tab characters must not be used in indentation")),45===r)&&ue(e.input.charCodeAt(e.position+1));)if(s=!0,e.position++,Ne(e,!0,-1)&&e.lineIndent<=t)a.push(null),r=e.input.charCodeAt(e.position);else if(n=e.line,Pe(e,t,J,!1,!0),a.push(e.result),Ne(e,!0,-1),r=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&0!==r)we(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!s&&(e.tag=i,e.anchor=o,e.kind="sequence",e.result=a,!0)}function Re(e){var t,n,r,i,o=!1,a=!1;if(33!==(i=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&we(e,"duplication of a tag property"),60===(i=e.input.charCodeAt(++e.position))?(o=!0,i=e.input.charCodeAt(++e.position)):33===i?(a=!0,n="!!",i=e.input.charCodeAt(++e.position)):n="!",t=e.position,o){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&62!==i);e.position<e.length?(r=e.input.slice(t,e.position),i=e.input.charCodeAt(++e.position)):we(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==i&&!ue(i);)33===i&&(a?we(e,"tag suffix cannot contain exclamation marks"):(n=e.input.slice(t-1,e.position+1),oe.test(n)||we(e,"named tag handle cannot contain such characters"),a=!0,t=e.position+1)),i=e.input.charCodeAt(++e.position);r=e.input.slice(t,e.position),ie.test(r)&&we(e,"tag suffix cannot contain flow indicator characters")}r&&!ae.test(r)&&we(e,"tag name cannot contain such characters: "+r);try{r=decodeURIComponent(r)}catch(t){we(e,"tag name is malformed: "+r)}return o?e.tag=r:G.call(e.tagMap,n)?e.tag=e.tagMap[n]+r:"!"===n?e.tag="!"+r:"!!"===n?e.tag="tag:yaml.org,2002:"+r:we(e,'undeclared tag handle "'+n+'"'),!0}function De(e){var t,n;if(38!==(n=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&we(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!ue(n)&&!de(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&we(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function Pe(e,t,n,r,i){var o,a,l,c,u,d,p,f,h,m=1,g=!1,v=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,o=a=l=X===n||J===n,r&&Ne(e,!0,-1)&&(g=!0,e.lineIndent>t?m=1:e.lineIndent===t?m=0:e.lineIndent<t&&(m=-1)),1===m)for(;Re(e)||De(e);)Ne(e,!0,-1)?(g=!0,l=o,e.lineIndent>t?m=1:e.lineIndent===t?m=0:e.lineIndent<t&&(m=-1)):l=!1;if(l&&(l=g||i),1!==m&&X!==n||(f=Y===n||Q===n?t:t+1,h=e.position-e.lineStart,1===m?l&&(Oe(e,h)||function(e,t,n){var r,i,o,a,s,l,c,u=e.tag,d=e.anchor,p={},f=Object.create(null),h=null,m=null,g=null,v=!1,y=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=p),c=e.input.charCodeAt(e.position);0!==c;){if(v||-1===e.firstTabInLine||(e.position=e.firstTabInLine,we(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),o=e.line,63!==c&&58!==c||!ue(r)){if(a=e.line,s=e.lineStart,l=e.position,!Pe(e,n,Q,!1,!0))break;if(e.line===o){for(c=e.input.charCodeAt(e.position);ce(c);)c=e.input.charCodeAt(++e.position);if(58===c)ue(c=e.input.charCodeAt(++e.position))||we(e,"a whitespace character is expected after the key-value separator within a block mapping"),v&&(Ae(e,p,f,h,m,null,a,s,l),h=m=g=null),y=!0,v=!1,i=!1,h=e.tag,m=e.result;else{if(!y)return e.tag=u,e.anchor=d,!0;we(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!y)return e.tag=u,e.anchor=d,!0;we(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===c?(v&&(Ae(e,p,f,h,m,null,a,s,l),h=m=g=null),y=!0,v=!0,i=!0):v?(v=!1,i=!0):we(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,c=r;if((e.line===o||e.lineIndent>t)&&(v&&(a=e.line,s=e.lineStart,l=e.position),Pe(e,t,X,!0,i)&&(v?m=e.result:g=e.result),v||(Ae(e,p,f,h,m,g,a,s,l),h=m=g=null),Ne(e,!0,-1),c=e.input.charCodeAt(e.position)),(e.line===o||e.lineIndent>t)&&0!==c)we(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return v&&Ae(e,p,f,h,m,null,a,s,l),y&&(e.tag=u,e.anchor=d,e.kind="mapping",e.result=p),y}(e,h,f))||function(e,t){var n,r,i,o,a,s,l,c,u,d,p,f,h=!0,m=e.tag,g=e.anchor,v=Object.create(null);if(91===(f=e.input.charCodeAt(e.position)))a=93,c=!1,o=[];else{if(123!==f)return!1;a=125,c=!0,o={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=o),f=e.input.charCodeAt(++e.position);0!==f;){if(Ne(e,!0,t),(f=e.input.charCodeAt(e.position))===a)return e.position++,e.tag=m,e.anchor=g,e.kind=c?"mapping":"sequence",e.result=o,!0;h?44===f&&we(e,"expected the node content, but found ','"):we(e,"missed comma between flow collection entries"),p=null,s=l=!1,63===f&&ue(e.input.charCodeAt(e.position+1))&&(s=l=!0,e.position++,Ne(e,!0,t)),n=e.line,r=e.lineStart,i=e.position,Pe(e,t,Y,!1,!0),d=e.tag,u=e.result,Ne(e,!0,t),f=e.input.charCodeAt(e.position),!l&&e.line!==n||58!==f||(s=!0,f=e.input.charCodeAt(++e.position),Ne(e,!0,t),Pe(e,t,Y,!1,!0),p=e.result),c?Ae(e,o,v,d,u,p,n,r,i):s?o.push(Ae(e,null,v,d,u,p,n,r,i)):o.push(u),Ne(e,!0,t),44===(f=e.input.charCodeAt(e.position))?(h=!0,f=e.input.charCodeAt(++e.position)):h=!1}we(e,"unexpected end of the stream within a flow collection")}(e,f)?v=!0:(a&&function(e,t){var n,r,i,o,a,l=$,c=!1,u=!1,d=t,p=0,f=!1;if(124===(o=e.input.charCodeAt(e.position)))r=!1;else{if(62!==o)return!1;r=!0}for(e.kind="scalar",e.result="";0!==o;)if(43===(o=e.input.charCodeAt(++e.position))||45===o)$===l?l=43===o?te:ee:we(e,"repeat of a chomping mode identifier");else{if(!((i=48<=(a=o)&&a<=57?a-48:-1)>=0))break;0===i?we(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):u?we(e,"repeat of an indentation width identifier"):(d=t+i-1,u=!0)}if(ce(o)){do{o=e.input.charCodeAt(++e.position)}while(ce(o));if(35===o)do{o=e.input.charCodeAt(++e.position)}while(!le(o)&&0!==o)}for(;0!==o;){for(xe(e),e.lineIndent=0,o=e.input.charCodeAt(e.position);(!u||e.lineIndent<d)&&32===o;)e.lineIndent++,o=e.input.charCodeAt(++e.position);if(!u&&e.lineIndent>d&&(d=e.lineIndent),le(o))p++;else{if(e.lineIndent<d){l===te?e.result+=s.repeat("\n",c?1+p:p):l===$&&c&&(e.result+="\n");break}for(r?ce(o)?(f=!0,e.result+=s.repeat("\n",c?1+p:p)):f?(f=!1,e.result+=s.repeat("\n",p+1)):0===p?c&&(e.result+=" "):e.result+=s.repeat("\n",p):e.result+=s.repeat("\n",c?1+p:p),c=!0,u=!0,p=0,n=e.position;!le(o)&&0!==o;)o=e.input.charCodeAt(++e.position);Se(e,n,e.position,!1)}}return!0}(e,f)||function(e,t){var n,r,i;if(39!==(n=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,r=i=e.position;0!==(n=e.input.charCodeAt(e.position));)if(39===n){if(Se(e,r,e.position,!0),39!==(n=e.input.charCodeAt(++e.position)))return!0;r=e.position,e.position++,i=e.position}else le(n)?(Se(e,r,i,!0),Ie(e,Ne(e,!1,t)),r=i=e.position):e.position===e.lineStart&&Ee(e)?we(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);we(e,"unexpected end of the stream within a single quoted scalar")}(e,f)||function(e,t){var n,r,i,o,a,s,l;if(34!==(s=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;0!==(s=e.input.charCodeAt(e.position));){if(34===s)return Se(e,n,e.position,!0),e.position++,!0;if(92===s){if(Se(e,n,e.position,!0),le(s=e.input.charCodeAt(++e.position)))Ne(e,!1,t);else if(s<256&&me[s])e.result+=ge[s],e.position++;else if((a=120===(l=s)?2:117===l?4:85===l?8:0)>0){for(i=a,o=0;i>0;i--)(a=pe(s=e.input.charCodeAt(++e.position)))>=0?o=(o<<4)+a:we(e,"expected hexadecimal character");e.result+=he(o),e.position++}else we(e,"unknown escape sequence");n=r=e.position}else le(s)?(Se(e,n,r,!0),Ie(e,Ne(e,!1,t)),n=r=e.position):e.position===e.lineStart&&Ee(e)?we(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}we(e,"unexpected end of the stream within a double quoted scalar")}(e,f)?v=!0:function(e){var t,n,r;if(42!==(r=e.input.charCodeAt(e.position)))return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;0!==r&&!ue(r)&&!de(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&we(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),G.call(e.anchorMap,n)||we(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],Ne(e,!0,-1),!0}(e)?(v=!0,null===e.tag&&null===e.anchor||we(e,"alias node should not have any properties")):function(e,t,n){var r,i,o,a,s,l,c,u,d=e.kind,p=e.result;if(ue(u=e.input.charCodeAt(e.position))||de(u)||35===u||38===u||42===u||33===u||124===u||62===u||39===u||34===u||37===u||64===u||96===u)return!1;if((63===u||45===u)&&(ue(r=e.input.charCodeAt(e.position+1))||n&&de(r)))return!1;for(e.kind="scalar",e.result="",i=o=e.position,a=!1;0!==u;){if(58===u){if(ue(r=e.input.charCodeAt(e.position+1))||n&&de(r))break}else if(35===u){if(ue(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&Ee(e)||n&&de(u))break;if(le(u)){if(s=e.line,l=e.lineStart,c=e.lineIndent,Ne(e,!1,-1),e.lineIndent>=t){a=!0,u=e.input.charCodeAt(e.position);continue}e.position=o,e.line=s,e.lineStart=l,e.lineIndent=c;break}}a&&(Se(e,i,o,!1),Ie(e,e.line-s),i=o=e.position,a=!1),ce(u)||(o=e.position+1),u=e.input.charCodeAt(++e.position)}return Se(e,i,o,!1),!!e.result||(e.kind=d,e.result=p,!1)}(e,f,Y===n)&&(v=!0,null===e.tag&&(e.tag="?")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===m&&(v=l&&Oe(e,h))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&we(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),c=0,u=e.implicitTypes.length;c<u;c+=1)if((p=e.implicitTypes[c]).resolve(e.result)){e.result=p.construct(e.result),e.tag=p.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if(G.call(e.typeMap[e.kind||"fallback"],e.tag))p=e.typeMap[e.kind||"fallback"][e.tag];else for(p=null,c=0,u=(d=e.typeMap.multi[e.kind||"fallback"]).length;c<u;c+=1)if(e.tag.slice(0,d[c].tag.length)===d[c].tag){p=d[c];break}p||we(e,"unknown tag !<"+e.tag+">"),null!==e.result&&p.kind!==e.kind&&we(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+p.kind+'", not "'+e.kind+'"'),p.resolve(e.result,e.tag)?(e.result=p.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):we(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||v}function Fe(e){var t,n,r,i,o=e.position,a=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(i=e.input.charCodeAt(e.position))&&(Ne(e,!0,-1),i=e.input.charCodeAt(e.position),!(e.lineIndent>0||37!==i));){for(a=!0,i=e.input.charCodeAt(++e.position),t=e.position;0!==i&&!ue(i);)i=e.input.charCodeAt(++e.position);for(r=[],(n=e.input.slice(t,e.position)).length<1&&we(e,"directive name must not be less than one character in length");0!==i;){for(;ce(i);)i=e.input.charCodeAt(++e.position);if(35===i){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&!le(i));break}if(le(i))break;for(t=e.position;0!==i&&!ue(i);)i=e.input.charCodeAt(++e.position);r.push(e.input.slice(t,e.position))}0!==i&&xe(e),G.call(ke,n)?ke[n](e,n,r):_e(e,'unknown document directive "'+n+'"')}Ne(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,Ne(e,!0,-1)):a&&we(e,"directives end mark is expected"),Pe(e,e.lineIndent-1,X,!1,!0),Ne(e,!0,-1),e.checkLineBreaks&&re.test(e.input.slice(o,e.position))&&_e(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&Ee(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,Ne(e,!0,-1)):e.position<e.length-1&&we(e,"end of the stream or a document separator is expected")}function Te(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var n=new ye(e,t),r=e.indexOf("\0");for(-1!==r&&(n.position=r,we(n,"null byte is not allowed in input")),n.input+="\0";32===n.input.charCodeAt(n.position);)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)Fe(n);return n.documents}var ze={loadAll:function(e,t,n){null!==t&&"object"==typeof t&&void 0===n&&(n=t,t=null);var r=Te(e,n);if("function"!=typeof t)return r;for(var i=0,o=r.length;i<o;i+=1)t(r[i])},load:function(e,t){var n=Te(e,t);if(0!==n.length){if(1===n.length)return n[0];throw new u("expected a single document in the stream, but found more")}}},Le=Object.prototype.toString,je=Object.prototype.hasOwnProperty,Me=65279,Ue=9,Be=10,Ve=13,We=32,qe=33,Ze=34,He=35,Ke=37,Ge=38,Ye=39,Qe=42,Je=44,Xe=45,$e=58,et=61,tt=62,nt=63,rt=64,it=91,ot=93,at=96,st=123,lt=124,ct=125,ut={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},dt=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],pt=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function ft(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else{if(!(e<=4294967295))throw new u("code point within a string may not be greater than 0xFFFFFFFF");n="U",r=8}return"\\"+n+s.repeat("0",r-t.length)+t}var ht=2;function mt(e){this.schema=e.schema||K,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=s.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=function(e,t){var n,r,i,o,a,s,l;if(null===t)return{};for(n={},i=0,o=(r=Object.keys(t)).length;i<o;i+=1)a=r[i],s=String(t[a]),"!!"===a.slice(0,2)&&(a="tag:yaml.org,2002:"+a.slice(2)),(l=e.compiledTypeMap.fallback[a])&&je.call(l.styleAliases,s)&&(s=l.styleAliases[s]),n[a]=s;return n}(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType='"'===e.quotingType?ht:1,this.forceQuotes=e.forceQuotes||!1,this.replacer="function"==typeof e.replacer?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function gt(e,t){for(var n,r=s.repeat(" ",t),i=0,o=-1,a="",l=e.length;i<l;)-1===(o=e.indexOf("\n",i))?(n=e.slice(i),i=l):(n=e.slice(i,o+1),i=o+1),n.length&&"\n"!==n&&(a+=r),a+=n;return a}function vt(e,t){return"\n"+s.repeat(" ",e.indent*t)}function yt(e){return e===We||e===Ue}function bt(e){return 32<=e&&e<=126||161<=e&&e<=55295&&8232!==e&&8233!==e||57344<=e&&e<=65533&&e!==Me||65536<=e&&e<=1114111}function wt(e){return bt(e)&&e!==Me&&e!==Ve&&e!==Be}function _t(e,t,n){var r=wt(e),i=r&&!yt(e);return(n?r:r&&e!==Je&&e!==it&&e!==ot&&e!==st&&e!==ct)&&e!==He&&!(t===$e&&!i)||wt(t)&&!yt(t)&&e===He||t===$e&&i}function kt(e,t){var n,r=e.charCodeAt(t);return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1))>=56320&&n<=57343?1024*(r-55296)+n-56320+65536:r}function St(e){return/^\n* /.test(e)}var Ct=1,At=2,xt=3,Nt=4,Et=5;function It(e,t,n,r,i){e.dump=function(){if(0===t.length)return e.quotingType===ht?'""':"''";if(!e.noCompatMode&&(-1!==dt.indexOf(t)||pt.test(t)))return e.quotingType===ht?'"'+t+'"':"'"+t+"'";var o=e.indent*Math.max(1,n),a=-1===e.lineWidth?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-o),s=r||e.flowLevel>-1&&n>=e.flowLevel;switch(function(e,t,n,r,i,o,a,s){var l,c,u=0,d=null,p=!1,f=!1,h=-1!==r,m=-1,g=bt(c=kt(e,0))&&c!==Me&&!yt(c)&&c!==Xe&&c!==nt&&c!==$e&&c!==Je&&c!==it&&c!==ot&&c!==st&&c!==ct&&c!==He&&c!==Ge&&c!==Qe&&c!==qe&&c!==lt&&c!==et&&c!==tt&&c!==Ye&&c!==Ze&&c!==Ke&&c!==rt&&c!==at&&function(e){return!yt(e)&&e!==$e}(kt(e,e.length-1));if(t||a)for(l=0;l<e.length;u>=65536?l+=2:l++){if(!bt(u=kt(e,l)))return Et;g=g&&_t(u,d,s),d=u}else{for(l=0;l<e.length;u>=65536?l+=2:l++){if((u=kt(e,l))===Be)p=!0,h&&(f=f||l-m-1>r&&" "!==e[m+1],m=l);else if(!bt(u))return Et;g=g&&_t(u,d,s),d=u}f=f||h&&l-m-1>r&&" "!==e[m+1]}return p||f?n>9&&St(e)?Et:a?o===ht?Et:At:f?Nt:xt:!g||a||i(e)?o===ht?Et:At:Ct}(t,s,e.indent,a,(function(t){return function(e,t){var n,r;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(e.implicitTypes[n].resolve(t))return!0;return!1}(e,t)}),e.quotingType,e.forceQuotes&&!r,i)){case Ct:return t;case At:return"'"+t.replace(/'/g,"''")+"'";case xt:return"|"+Ot(t,e.indent)+Rt(gt(t,o));case Nt:return">"+Ot(t,e.indent)+Rt(gt(function(e,t){for(var n,r,i,o=/(\n+)([^\n]*)/g,a=(i=-1!==(i=e.indexOf("\n"))?i:e.length,o.lastIndex=i,Dt(e.slice(0,i),t)),s="\n"===e[0]||" "===e[0];r=o.exec(e);){var l=r[1],c=r[2];n=" "===c[0],a+=l+(s||n||""===c?"":"\n")+Dt(c,t),s=n}return a}(t,a),o));case Et:return'"'+function(e){for(var t,n="",r=0,i=0;i<e.length;r>=65536?i+=2:i++)r=kt(e,i),!(t=ut[r])&&bt(r)?(n+=e[i],r>=65536&&(n+=e[i+1])):n+=t||ft(r);return n}(t)+'"';default:throw new u("impossible error: invalid scalar style")}}()}function Ot(e,t){var n=St(e)?String(t):"",r="\n"===e[e.length-1];return n+(!r||"\n"!==e[e.length-2]&&"\n"!==e?r?"":"-":"+")+"\n"}function Rt(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}function Dt(e,t){if(""===e||" "===e[0])return e;for(var n,r,i=/ [^ ]/g,o=0,a=0,s=0,l="";n=i.exec(e);)(s=n.index)-o>t&&(r=a>o?a:s,l+="\n"+e.slice(o,r),o=r+1),a=s;return l+="\n",e.length-o>t&&a>o?l+=e.slice(o,a)+"\n"+e.slice(a+1):l+=e.slice(o),l.slice(1)}function Pt(e,t,n,r){var i,o,a,s="",l=e.tag;for(i=0,o=n.length;i<o;i+=1)a=n[i],e.replacer&&(a=e.replacer.call(n,String(i),a)),(Tt(e,t+1,a,!0,!0,!1,!0)||void 0===a&&Tt(e,t+1,null,!0,!0,!1,!0))&&(r&&""===s||(s+=vt(e,t)),e.dump&&Be===e.dump.charCodeAt(0)?s+="-":s+="- ",s+=e.dump);e.tag=l,e.dump=s||"[]"}function Ft(e,t,n){var r,i,o,a,s,l;for(o=0,a=(i=n?e.explicitTypes:e.implicitTypes).length;o<a;o+=1)if(((s=i[o]).instanceOf||s.predicate)&&(!s.instanceOf||"object"==typeof t&&t instanceof s.instanceOf)&&(!s.predicate||s.predicate(t))){if(n?s.multi&&s.representName?e.tag=s.representName(t):e.tag=s.tag:e.tag="?",s.represent){if(l=e.styleMap[s.tag]||s.defaultStyle,"[object Function]"===Le.call(s.represent))r=s.represent(t,l);else{if(!je.call(s.represent,l))throw new u("!<"+s.tag+'> tag resolver accepts not "'+l+'" style');r=s.represent[l](t,l)}e.dump=r}return!0}return!1}function Tt(e,t,n,r,i,o,a){e.tag=null,e.dump=n,Ft(e,n,!1)||Ft(e,n,!0);var s,l=Le.call(e.dump),c=r;r&&(r=e.flowLevel<0||e.flowLevel>t);var d,p,f="[object Object]"===l||"[object Array]"===l;if(f&&(p=-1!==(d=e.duplicates.indexOf(n))),(null!==e.tag&&"?"!==e.tag||p||2!==e.indent&&t>0)&&(i=!1),p&&e.usedDuplicates[d])e.dump="*ref_"+d;else{if(f&&p&&!e.usedDuplicates[d]&&(e.usedDuplicates[d]=!0),"[object Object]"===l)r&&0!==Object.keys(e.dump).length?(function(e,t,n,r){var i,o,a,s,l,c,d="",p=e.tag,f=Object.keys(n);if(!0===e.sortKeys)f.sort();else if("function"==typeof e.sortKeys)f.sort(e.sortKeys);else if(e.sortKeys)throw new u("sortKeys must be a boolean or a function");for(i=0,o=f.length;i<o;i+=1)c="",r&&""===d||(c+=vt(e,t)),s=n[a=f[i]],e.replacer&&(s=e.replacer.call(n,a,s)),Tt(e,t+1,a,!0,!0,!0)&&((l=null!==e.tag&&"?"!==e.tag||e.dump&&e.dump.length>1024)&&(e.dump&&Be===e.dump.charCodeAt(0)?c+="?":c+="? "),c+=e.dump,l&&(c+=vt(e,t)),Tt(e,t+1,s,!0,l)&&(e.dump&&Be===e.dump.charCodeAt(0)?c+=":":c+=": ",d+=c+=e.dump));e.tag=p,e.dump=d||"{}"}(e,t,e.dump,i),p&&(e.dump="&ref_"+d+e.dump)):(function(e,t,n){var r,i,o,a,s,l="",c=e.tag,u=Object.keys(n);for(r=0,i=u.length;r<i;r+=1)s="",""!==l&&(s+=", "),e.condenseFlow&&(s+='"'),a=n[o=u[r]],e.replacer&&(a=e.replacer.call(n,o,a)),Tt(e,t,o,!1,!1)&&(e.dump.length>1024&&(s+="? "),s+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),Tt(e,t,a,!1,!1)&&(l+=s+=e.dump));e.tag=c,e.dump="{"+l+"}"}(e,t,e.dump),p&&(e.dump="&ref_"+d+" "+e.dump));else if("[object Array]"===l)r&&0!==e.dump.length?(e.noArrayIndent&&!a&&t>0?Pt(e,t-1,e.dump,i):Pt(e,t,e.dump,i),p&&(e.dump="&ref_"+d+e.dump)):(function(e,t,n){var r,i,o,a="",s=e.tag;for(r=0,i=n.length;r<i;r+=1)o=n[r],e.replacer&&(o=e.replacer.call(n,String(r),o)),(Tt(e,t,o,!1,!1)||void 0===o&&Tt(e,t,null,!1,!1))&&(""!==a&&(a+=","+(e.condenseFlow?"":" ")),a+=e.dump);e.tag=s,e.dump="["+a+"]"}(e,t,e.dump),p&&(e.dump="&ref_"+d+" "+e.dump));else{if("[object String]"!==l){if("[object Undefined]"===l)return!1;if(e.skipInvalid)return!1;throw new u("unacceptable kind of an object to dump "+l)}"?"!==e.tag&&It(e,e.dump,t,o,c)}null!==e.tag&&"?"!==e.tag&&(s=encodeURI("!"===e.tag[0]?e.tag.slice(1):e.tag).replace(/!/g,"%21"),s="!"===e.tag[0]?"!"+s:"tag:yaml.org,2002:"===s.slice(0,18)?"!!"+s.slice(18):"!<"+s+">",e.dump=s+" "+e.dump)}return!0}function zt(e,t){var n,r,i=[],o=[];for(Lt(e,i,o),n=0,r=o.length;n<r;n+=1)t.duplicates.push(i[o[n]]);t.usedDuplicates=new Array(r)}function Lt(e,t,n){var r,i,o;if(null!==e&&"object"==typeof e)if(-1!==(i=t.indexOf(e)))-1===n.indexOf(i)&&n.push(i);else if(t.push(e),Array.isArray(e))for(i=0,o=e.length;i<o;i+=1)Lt(e[i],t,n);else for(i=0,o=(r=Object.keys(e)).length;i<o;i+=1)Lt(e[r[i]],t,n)}function jt(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}const Mt={Type:g,Schema:b,FAILSAFE_SCHEMA:S,JSON_SCHEMA:D,CORE_SCHEMA:P,DEFAULT_SCHEMA:K,load:ze.load,loadAll:ze.loadAll,dump:function(e,t){var n=new mt(t=t||{});n.noRefs||zt(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),Tt(n,0,r,!0,!0)?n.dump+"\n":""},YAMLException:u,types:{binary:M,float:R,map:k,null:C,pairs:q,set:H,timestamp:z,bool:A,int:E,merge:L,omap:V,seq:_,str:w},safeLoad:jt("safeLoad","load"),safeLoadAll:jt("safeLoadAll","loadAll"),safeDump:jt("safeDump","dump")};var Ut=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};function Bt(e){var t,n;return(null===(n=null===(t=null==e?void 0:e.beginDialog)||void 0===t?void 0:t.intent)||void 0===n?void 0:n.triggerQueries)||[]}function Vt(e){var t=0;for(var n of e)if("ConditionGroup"===n.kind&&n.conditions)for(var r of(t+=n.conditions.length,n.conditions))r.actions&&(t+=Vt(r.actions));else n.actions&&(t+=Vt(n.actions));return t}function Wt(e,t){e.forEach((e=>{"InvokeFlowAction"===e.kind&&e.flowId&&t.add(e.flowId),Object.keys(e).forEach((n=>{Array.isArray(e[n])&&Wt(e[n],t)}))}))}function qt(e,t){for(var n of e)if("BeginDialog"===n.kind&&n.dialog&&t.add(n.dialog),Array.isArray(n.actions)&&qt(n.actions,t),Array.isArray(n.conditions))for(var r of n.conditions)Array.isArray(r.actions)&&qt(r.actions,t)}function Zt(e,t){var n=t.replace(/\s+/g,"");return"".concat(e,".topic.").concat(n)}var Ht,Kt,Gt="customizations.xml";!function(e){e.TriggerPhraseCount="TriggerPhraseCount",e.SingleWordPhrases="SingleWordPhrases",e.LongPhrases="LongPhrases",e.ConditionCount="ConditionCount",e.SharePointAuthMode="SharePointAuthMode",e.FlowCount="FlowCount",e.UnusedTopics="UnusedTopics",e.SynonymsQuality="SynonymsQuality",e.DuplicateRegexEntities="DuplicateRegexEntities"}(Ht||(Ht={})),function(e){e.UnusedVariables="UnusedVariables",e.ActionCount="ActionCount",e.NamingConventions="NamingConventions",e.NestedLoops="NestedLoops",e.Concurrency="Concurrency",e.MultipleInitializeVariableActions="MultipleInitializeVariableActions",e.StaticVariables="StaticVariables",e.PowerAppResponse="PowerAppResponse",e.ScopeUsage="ScopeUsage",e.TriggerCondition="TriggerCondition",e.DataRetrievalParameters="DataRetrievalParameters",e.ActionNote="ActionNote",e.CreateUpdateInsideLoop="CreateUpdateInsideLoop"}(Kt||(Kt={}));var Yt,Qt={[Kt.UnusedVariables]:{patternID:"flow-UnusedVariables",patternName:"Unused Variables",description:"Check for unused variables in the flow.",docLink:"https://learn.microsoft.com/en-us/power-automate/best-practices",recommendation:"Remove any variables that are initialized but never used."},[Kt.ActionCount]:{patternID:"flow-ActionCount",patternName:"Action Count",description:"Optimize the number of actions in the flow to ensure performance efficiency.",docLink:"https://learn.microsoft.com/en-us/power-automate/best-practices",recommendation:"Reduce the number of actions to improve performance."},[Kt.NamingConventions]:{patternID:"flow-NamingConventions",patternName:"Naming Conventions",description:"Check if trigger starts with 'Trg_' and actions start with 'Act_' prefix for flow components.",docLink:"https://learn.microsoft.com/en-us/power-automate/naming-conventions",recommendation:"Follow consistent naming conventions (e.g., CamelCase, prefixes) for triggers, actions, and variables."},[Kt.NestedLoops]:{patternID:"flow-NestedLoops",patternName:"Nested Loops",description:"Avoid using nested loops for better performance.",docLink:"https://learn.microsoft.com/en-us/power-automate/loops",recommendation:"Optimize flow logic to avoid nested loops."},[Kt.Concurrency]:{patternID:"flow-Concurrency",patternName:"Concurrency",description:"Ensure that parallel execution and concurrency are configured for Foreach loops.",docLink:"https://learn.microsoft.com/en-us/power-automate/concurrency",recommendation:"Set concurrency limits and enable parallel execution for Foreach loops where appropriate."},[Kt.MultipleInitializeVariableActions]:{patternID:"flow-MultipleInitializeVariableActions",patternName:"Multiple Initialize Variable Actions",description:"Check if 'Initialize Variable' actions are used more than once.",docLink:"https://learn.microsoft.com/en-us/power-automate/api-calls",recommendation:"Combine multiple 'InitializeVariable' actions into a single 'InitializeVariable' action of type object or Use parallel initialization for faster execution."},[Kt.StaticVariables]:{patternID:"flow-StaticVariables",patternName:"Static Variables",description:"Identify variables that are initialized but never updated using Variable actions.",docLink:"https://learn.microsoft.com/en-us/power-automate/api-calls",recommendation:"Use 'Compose' actions instead of variables that are initialized but never updated."},[Kt.PowerAppResponse]:{patternID:"flow-PowerAppResponse",patternName:"PowerApp Response",description:"Check if a Respond to a Power App or flow action is present in the flow.",docLink:"https://learn.microsoft.com/en-us/power-automate/api-calls",recommendation:"Ensure the response is sent within 120 seconds to avoid potential failures."},[Kt.ScopeUsage]:{patternID:"flow-ScopeUsage",patternName:"Scope Usage",description:"Check if the flow has a lot of actions and lacks any 'Scope' action.",docLink:"https://learn.microsoft.com/en-us/power-automate/api-calls",recommendation:"Use Scopes to group actions and implement error handling (with Run After conditions) to handle failures gracefully."},[Kt.TriggerCondition]:{patternID:"flow-TriggerCondition",patternName:"Trigger Condition",description:"Check if trigger conditions are defined for trigger component.",docLink:"https://learn.microsoft.com/en-us/power-automate/infinite-runs",recommendation:"Define trigger conditions to avoid unnecessary flow executions. This ensures that the flow only runs when specific conditions are met."},[Kt.DataRetrievalParameters]:{patternID:"flow-DataRetrievalParameters",patternName:"Data Retrieval Parameters",description:"Check if the flow uses Filter, select, top count metadata in get actions of CDS or sharepoint",docLink:"https://learn.microsoft.com/en-us/power-automate/api-calls",recommendation:"Get actions need to get only relevant data to be used in flow in terms of row and column count. Use top, filter, select parameters to retrieve only required data."},[Kt.ActionNote]:{patternID:"flow-ActionNote",patternName:"Action Note",description:"Ensure every action has a non-empty description.",docLink:"https://learn.microsoft.com/en-us/power-automate/api-calls",recommendation:"Add meaningful notes/descriptions to all actions for better documentation and maintainability."},[Kt.CreateUpdateInsideLoop]:{patternID:"flow-CreateUpdateInsideLoop",patternName:"Create/Update Inside Loop",description:"Check if Create/Update actions are inside a loop action.",docLink:"https://learn.microsoft.com/en-us/power-automate/batch-operations",recommendation:"Avoid using Create/Update actions to create/update large number of records inside loops. Use BulkOperations APIs or batch processing for better performance."}},Jt={[Ht.TriggerPhraseCount]:{patternID:"bot-TriggerPhraseCount",patternName:"Trigger Phrase Count",description:"This pattern ensures that each topic contains at least 5 trigger phrases, which helps bots respond to a wider variety of user queries.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance/trigger-phrases-best-practices#2",recommendation:"Ensure each topic has at least 5 trigger queries."},[Ht.SingleWordPhrases]:{patternID:"bot-SingleWordPhrases",patternName:"Single Word Phrases",description:"This pattern identifies single-word trigger phrases, recommending the use of multi-word phrases for more accurate and meaningful responses.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance/trigger-phrases-best-practices#3",recommendation:"Ensure all trigger phrases are more than one word."},[Ht.LongPhrases]:{patternID:"bot-LongPhrases",patternName:"Long Phrases",description:"This pattern flags trigger phrases that exceed 10 words in length, encouraging shorter and more concise queries for better bot performance.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance/trigger-phrases-best-practices#4",recommendation:"Ensure all trigger phrases have fewer than 10 words."},[Ht.ConditionCount]:{patternID:"bot-ConditionCount",patternName:"Condition Count",description:"Checks if topics have too many condition action branches.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance",recommendation:"Consider breaking the topic into subtopics and redirect the conversation to those subtopics to improve maintainability."},[Ht.SharePointAuthMode]:{patternID:"bot-SharePointAuthMode",patternName:"SharePoint Auth Mode",description:"Checks if Agent has any SharePoint knowledge sources and is using 'No Authentication' as authentication mode.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance",recommendation:"Ensure an Agent with SharePoint sources use 'Authenticate Manually' or 'Authenticate with Microsoft' for authentication mode."},[Ht.FlowCount]:{patternID:"bot-FlowCount",patternName:"Flow Count",description:"Checks the number of unique flowIds used in InvokeFlowAction and fails if more than 10 are found.",docLink:"https://learn.microsoft.com/en-us/power-platform",recommendation:"Reduce the usage of flows(no more than 10 flows) to optimize performance and maintainability."},[Ht.UnusedTopics]:{patternID:"bot-UnusedTopics",patternName:"Unused Topics",description:"Checks for topics that do not have trigger phrases and are not referenced in any other topics.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance",recommendation:"Consider removing unused topics to keep the bot optimized."},[Ht.SynonymsQuality]:{patternID:"bot-SynonymsQuality",patternName:"Synonyms Quality",description:"Checks synonyms in ClosedListEntity items to ensure no synonym exceeds 2 words.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance",recommendation:"Synonyms should only be keywords (no more than 2 words)."},[Ht.DuplicateRegexEntities]:{patternID:"bot-DuplicateRegexEntities",patternName:"Duplicate Regex Entities",description:"Checks if multiple RegexEntity entities share the exact same pattern.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance",recommendation:"Use unique regex patterns to avoid confusion or conflicts."}};!function(e){e.MediaFileSize="MediaFileSize",e.AppSettings="AppSettings",e.AppCheckerAccessibilityIssues="AppCheckerAccessibilityIssues",e.UnusedElements="UnusedElements",e.NPlusOne="NPlusOne",e.ErrorHandling="ErrorHandling",e.CodeReadability="CodeReadability",e.InefficientDataRetrieval="InefficientDataRetrieval",e.NestedFilters="NestedFilters",e.PatchFormulaOptimization="PatchFormulaOptimization",e.NestedAPICalls="NestedAPICalls",e.NamedFormulas="NamedFormulas",e.UxLayout="UxLayout"}(Yt||(Yt={}));var Xt={[Yt.MediaFileSize]:{patternID:"app-AssetOptimization",patternName:"Asset Optimization",description:"Review embedded asset compression/size optimization. Validate apps respect limitations related to media and audio asset sizes.",docLinks:"",recommendation:"Ensure that all files do not exceed 300KB file size. Please consider compressing the listed files.",severity:"Medium",category:"Performance"},[Yt.AppSettings]:{patternID:"app-AppSettings",patternName:"App Settings flags",description:"Ensure that all necessary settings are enabled for optimal performance.",docLinks:"https://www.microsoft.com/en-us/power-platform/blog/power-apps/app-checker-now-includes-performance-optimization-tips/",recommendation:"Please consider turning on the listed settings.",severity:"Medium",category:"Performance"},[Yt.AppCheckerAccessibilityIssues]:{patternID:"app-Accessibility",patternName:"Accessibility",description:"Review accessibility checker. Notes: Alternate Text labels can reveal otherwise hidden media and context to users with disabilities. Use natural language text when naming screens to optimize results from screen readers.",docLinks:"https://docs.microsoft.com/power-apps/maker/canvas-apps/accessible-apps",recommendation:"Please address the listed accessibility issues in failure reason.",severity:"High",category:"Accessibility"},[Yt.UnusedElements]:{patternID:"app-UnusedVariables",patternName:"Formulas, Controls with Low/No Usage",description:"This pattern refers to any formulas, assets, or controls that might be included in the app, but are potentially unnecessary, redundant, or not used.",docLinks:"https://docs.microsoft.com/powerapps/maker/canvas-apps/performance-tips",recommendation:"Please address the listed issues in failure reason.",severity:"Medium",category:"Performance"},[Yt.NPlusOne]:{patternID:"app-CheckForNplusOneCalls",patternName:"N+1 Database or API requests",description:"N+1 query, which are used often in galleries, can trigger too many requests to servers. Optimize data retrieval to reduce the number of requests.",docLinks:"https://powerapps.microsoft.com/blog/considerations-for-optimized-performance-in-power-apps",recommendation:"Consider optimizing data retrieval to reduce the number of requests.",severity:"High",category:"Performance"},[Yt.ErrorHandling]:{patternID:"app-ErrorHandling",patternName:"Error Handling",description:"Always ensure apps have appropriate error handling methods. It is best to use the IfError() function to manage data validation for Patch() commands and the OnSuccess/OnFail properties when submitting form data.",docLinks:"https://docs.microsoft.com/powerapps/maker/canvas-apps/functions/function-iferror",recommendation:"Implement error handling using IfError() or similar mechanisms.",severity:"Low",category:"Coding Standards"},[Yt.CodeReadability]:{patternID:"app-CodeReadability",patternName:"Code Readability",description:"Avoid expressions or formulas that are very long as they will become hard to read. Examples include, but are not limited to nested If/Then/Else statements and nested operators such as OR or AND.",docLinks:"",recommendation:"Simplify code to improve readability.",severity:"Low",category:"Maintainability"},[Yt.InefficientDataRetrieval]:{patternID:"app-FormulaOptimization-FirstFilter",patternName:"Inefficient Data Retrieval",description:"Using Filter or Search inside First or Last functions with external data sources.",docLinks:"https://docs.microsoft.com/powerapps/maker/canvas-apps/performance-tips",recommendation:"Optimize data retrieval by avoiding inefficient use of functions.",severity:"High",category:"Performance"},[Yt.NestedFilters]:{patternID:"app-FormulaOptimization-NestedFilter",patternName:"Nested Filters",description:"Consider simplifying nested formulas with Search() and Filter() operations. Avoiding the nesting of these two together leads to a more compact/concise formula and performance improvement.",docLinks:"",recommendation:"Simplify nested filters to improve performance.",severity:"Medium",category:"Performance"},[Yt.PatchFormulaOptimization]:{patternID:"app-FormulaOptimization-Patch",patternName:"Patch Formula Optimization",description:"Ensure the second parameter is not using a LookUp() function. It is a best practice to use ThisItem whenever patching from a gallery or { id: userid }.",docLinks:"",recommendation:"Optimize Patch formulas by avoiding unnecessary LookUp() functions.",severity:"Low",category:"Performance"},[Yt.NestedAPICalls]:{patternID:"app-FormulaOptimization-NestedApiCalls",patternName:"Nested API Calls",description:"Avoid making API calls within Filter() and LookUp() operations in combination.",docLinks:"",recommendation:"Avoid nesting API calls to improve performance.",severity:"Medium",category:"Performance"},[Yt.NamedFormulas]:{patternID:"app-NamedFormulas",patternName:"Named Formulas",description:"Use Named Formulas to improve performance and maintainability by defining formulas that can be reused throughout the app.",docLinks:"https://learn.microsoft.com/en-us/power-platform/power-fx/formula-reuse-named-formulas",recommendation:"Utilize Named Formulas for better code reuse and maintainability.",severity:"Low",category:"Maintainability"},[Yt.UxLayout]:{patternID:"app-UxLayout",patternName:"UX Layout",description:"Use containers to make responsive apps.",docLinks:"https://learn.microsoft.com/en-us/powerapps/maker/canvas-apps/create-responsive-layout",recommendation:"Implement responsive design using containers.",severity:"Low",category:"UX"}},$t=307200,en=["projectionmapping","delayloadscreens","reliableconcurrent","keeprecentscreensloaded","formuladataprefetch","enableappembeddingux","usenonblockingonstartrule","commentgeneratedformulasv2"],tn=["Filter","LookUp","Search","CountRows","ForAll","Patch"],nn=["app-UnusedVariables"],rn=["app-UnusedMediaResources"],on=["X","Y","PaddingBottom","PaddingTop","PaddingLeft","PaddingRight","Height","Width","HoverBorderColor","BorderColor","FocusedBorderColor","PressedFill","HoverFill","PressedBorderColor","PressedColor","Size","DisabledBorderColor","LoadingSpinnerColor","DisabledFill","Align","Padding","Margin","LineHeight","TextAlign","VerticalAlign","BorderStyle","BorderRadius","BorderThickness","FontSize","FontWeight","FontStyle","FontFamily","LineHeight"],an=["ConversationStart","EndofConversation","MultipleTopicsMatched","OnError","ResetConversation","Search","Signin","Escalate","Fallback","Goodbye","Greeting","ThankYou","StartOver"],sn=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};function ln(e){return sn(this,void 0,void 0,(function*(){var t=[];return e.forEach((e=>{var n=e.data;n&&n.beginDialog&&n.beginDialog.actions&&Vt(n.beginDialog.actions)>15&&t.push({TopicName:e.name})})),{patternID:Jt.ConditionCount.patternID,patternName:Jt.ConditionCount.patternName,description:Jt.ConditionCount.description,status:0===t.length?"Pass":"Fail",instanceValue:[{Topic:t.length>0?t:void 0,Flows:void 0,KnowledgeSource:void 0}],failureReason:t.length>0?"Some topic(s) have more than 15 conditions.":"",recommendation:Jt.ConditionCount.recommendation,docLinks:Jt.ConditionCount.docLink,severity:"Medium",category:"Maintainability"}}))}function cn(e){return sn(this,void 0,void 0,(function*(){var t=new Set;e.forEach((e=>{var n=e.data;n&&n.beginDialog&&n.beginDialog.actions&&Wt(n.beginDialog.actions,t)}));var n=t.size,r=n>10,i=r?Array.from(t):[];return{patternID:Jt.FlowCount.patternID,patternName:Jt.FlowCount.patternName,description:Jt.FlowCount.description,status:r?"Fail":"Pass",instanceValue:[{Topic:void 0,Flows:i,KnowledgeSource:void 0}],failureReason:r?"More than 10 Flows found (".concat(n,")."):"",recommendation:Jt.FlowCount.recommendation,docLinks:Jt.FlowCount.docLink,severity:r?"High":"Medium",category:"Data"}}))}var un=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};function dn(e,t){var n,r,i,o;return un(this,void 0,void 0,(function*(){var a=this,s="bots/",l="botcomponents/",c=new Set;Object.keys(e.files).forEach((t=>{if(!e.files[t].dir&&t.startsWith(s)){var n=t.replace(s,"").split("/")[0];n&&c.add(n)}}));var u=[],d=0,p=Object.keys(Ht).length,f=[],h=function*(){var c=yield function(e,t){var n;return Ut(this,void 0,void 0,(function*(){var r="bots/".concat(t,"/bot.xml");if(e.files[r]){var i=yield null===(n=e.file(r))||void 0===n?void 0:n.async("string"),o=null==i?void 0:i.match(/<name>(.*?)<\/name>/);return o?o[1]:""}return""}))}(e,m),p={botLogicalName:m,botDisplayName:c,botXml:null,botConfig:null,botComponents:[]},h="".concat(s).concat(m,"/bot.xml");p.botXml=(yield null===(n=e.file(h))||void 0===n?void 0:n.async("string"))||null;var g="".concat(s).concat(m,"/configuration.json"),v=(yield null===(r=e.file(g))||void 0===r?void 0:r.async("string"))||null;p.botConfig=v?JSON.parse(v):null;var y=function*(){if(b.startsWith(l)&&b.includes("".concat(l).concat(m,"."))){var t=b.replace(l,"").split("/");if(t.length>1){var n=t[0].split(".");if(n[0]===m&&n.length>2){var r=n[1],a=n.slice(2).join(".");if(!p.botComponents.find((e=>e.componentName===a&&e.componentType===r))){var s={componentType:r,componentName:a,botComponentXml:null,data:null},c="".concat(l).concat(t[0],"/botcomponent.xml");s.botComponentXml=(yield null===(i=e.file(c))||void 0===i?void 0:i.async("string"))||null;var u="".concat(l).concat(t[0],"/data"),d=(yield null===(o=e.file(u))||void 0===o?void 0:o.async("string"))||null;s.data=d?Mt.load(d):null,p.botComponents.push(s)}}}}};for(var b of Object.keys(e.files))yield*y();var w={};p.botComponents.forEach((e=>{w[e.componentType]||(w[e.componentType]=[]),w[e.componentType].push({name:e.componentName,xml:e.botComponentXml,data:e.data})}));var _=Object.assign(Object.assign({},p),{botComponents:w}),k=(_.botComponents.topic||[]).filter((e=>!an.includes(e.name))),S=[{fn:()=>un(a,void 0,void 0,(function*(){return e=k,new Promise((t=>{var n=[];e.forEach((e=>{Bt(e.data).length<5&&n.push({TopicName:e.name})})),t({patternID:Jt.TriggerPhraseCount.patternID,patternName:Jt.TriggerPhraseCount.patternName,description:Jt.TriggerPhraseCount.description,status:0===n.length?"Pass":"Fail",instanceValue:[{Topic:n.length>0?n:void 0,Flows:void 0,KnowledgeSource:void 0}],failureReason:n.length>0?"Some topics have less than 5 trigger queries.":"",recommendation:Jt.TriggerPhraseCount.recommendation,docLinks:Jt.TriggerPhraseCount.docLink,severity:"Medium",category:"Usage"})}));var e})),name:"TriggerPhraseCount"},{fn:()=>un(a,void 0,void 0,(function*(){return e=k,new Promise((t=>{var n=[];e.forEach((e=>{var t=Bt(e.data).filter((e=>1===e.trim().split(/\s+/).length));t.length>0&&n.push({TopicName:e.name,InvalidTriggerQueries:t})})),t({patternID:Jt.SingleWordPhrases.patternID,patternName:Jt.SingleWordPhrases.patternName,description:Jt.SingleWordPhrases.description,status:0===n.length?"Pass":"Fail",instanceValue:[{Topic:n.length>0?n:void 0,Flows:void 0,KnowledgeSource:void 0}],failureReason:n.length>0?"Some trigger queries are single words.":"",recommendation:Jt.SingleWordPhrases.recommendation,docLinks:Jt.SingleWordPhrases.docLink,severity:"Medium",category:"Usage"})}));var e})),name:"SingleWordPhrases"},{fn:()=>un(a,void 0,void 0,(function*(){return e=k,new Promise((t=>{var n=[];e.forEach((e=>{var t=Bt(e.data).filter((e=>e.trim().split(/\s+/).length>10));t.length>0&&n.push({TopicName:e.name,InvalidTriggerQueries:t})})),t({patternID:Jt.LongPhrases.patternID,patternName:Jt.LongPhrases.patternName,description:Jt.LongPhrases.description,status:0===n.length?"Pass":"Fail",instanceValue:[{Topic:n.length>0?n:void 0,Flows:void 0,KnowledgeSource:void 0}],failureReason:n.length>0?"Some trigger queries are too long.":"",recommendation:Jt.LongPhrases.recommendation,docLinks:Jt.LongPhrases.docLink,severity:"Low",category:"Usage"})}));var e})),name:"LongPhrases"},{fn:()=>un(a,void 0,void 0,(function*(){return ln(_.botComponents.topic||[])})),name:"ConditionCount"},{fn:()=>un(a,void 0,void 0,(function*(){return cn(_.botComponents.topic||[])})),name:"FlowCount"},{fn:()=>un(a,void 0,void 0,(function*(){return function(e){return sn(this,void 0,void 0,(function*(){var t=(yield function(e){return Ut(this,void 0,void 0,(function*(){var t=null==e?void 0:e.match(/<authenticationmode>(.*?)<\/authenticationmode>/);return t?t[1]:""}))}(e.botXml)).toString(),n=function(e){switch(e){case"1":return"No Authentication";case"2":return"EntraID";case"3":return"Manual";default:return"Unknown"}}(t),r=(e.botComponents.knowledge||[]).filter((e=>{var n,r;return"SharePointSearchSource"===(null===(r=null===(n=e.data)||void 0===n?void 0:n.source)||void 0===r?void 0:r.kind)&&"1"===t})),i=r.length>0;return{patternID:Jt.SharePointAuthMode.patternID,patternName:Jt.SharePointAuthMode.patternName,description:Jt.SharePointAuthMode.description,status:i?"Fail":"Pass",instanceValue:i?[{Topic:void 0,Flows:void 0,Entity:void 0,KnowledgeSource:r.map((e=>e.name))}]:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:void 0}],failureReason:i?"Found SharePoint knowledge sources with incorrect authentication mode '".concat(n,"'."):"",recommendation:Jt.SharePointAuthMode.recommendation,docLinks:Jt.SharePointAuthMode.docLink,severity:i?"High":"Medium",category:"Security"}}))}(_)})),name:"SharePointAuthMode"},{fn:()=>un(a,void 0,void 0,(function*(){return function(e,t){var n,r,i,o,a;return sn(this,void 0,void 0,(function*(){var s=new Set;for(var l of e)(null===(r=null===(n=l.data)||void 0===n?void 0:n.beginDialog)||void 0===r?void 0:r.actions)&&qt(l.data.beginDialog.actions,s);var c=[];for(var u of e)if(0===((null===(a=null===(o=null===(i=u.data)||void 0===i?void 0:i.beginDialog)||void 0===o?void 0:o.intent)||void 0===a?void 0:a.triggerQueries)||[]).length){var d=Zt(t,u.name);s.has(d)||c.push(u.name)}var p=c.length>0;return{patternID:Jt.UnusedTopics.patternID,patternName:Jt.UnusedTopics.patternName,description:Jt.UnusedTopics.description,status:p?"Fail":"Pass",instanceValue:p?[{Topic:c.map((e=>({TopicName:e,InvalidTriggerQueries:void 0}))),Flows:void 0,KnowledgeSource:void 0,Entity:void 0}]:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:void 0}],failureReason:p?"Some topics do not have trigger queries and are not referenced in any other topics.":"",recommendation:Jt.UnusedTopics.recommendation,docLinks:Jt.UnusedTopics.docLink,severity:"Medium",category:"Usage"}}))}(k,p.botLogicalName)})),name:"UnusedTopics"},{fn:()=>un(a,void 0,void 0,(function*(){return function(e){var t;return sn(this,void 0,void 0,(function*(){if(!e||0===e.length)return{patternID:Jt.SynonymsQuality.patternID,patternName:Jt.SynonymsQuality.patternName,description:Jt.SynonymsQuality.description,status:"Pass",instanceValue:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:void 0}],failureReason:"",recommendation:Jt.SynonymsQuality.recommendation,docLinks:Jt.SynonymsQuality.docLink,severity:"Medium",category:"Usage"};var n=[];for(var r of e)if("ClosedListEntity"===(null===(t=r.data)||void 0===t?void 0:t.kind)&&Array.isArray(r.data.items)){var i=new Set;for(var o of r.data.items){var a=Array.isArray(o.synonyms)?o.synonyms:[];for(var s of a)s.trim().split(/\s+/).length>2&&i.add(s)}i.size>0&&n.push({name:r.name,longSynonyms:Array.from(i)})}var l=0===n.length;return{patternID:Jt.SynonymsQuality.patternID,patternName:Jt.SynonymsQuality.patternName,description:Jt.SynonymsQuality.description,status:l?"Pass":"Fail",instanceValue:l?[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:void 0}]:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:{ClosedListEntity:n.map((e=>({name:e.name,longSynonyms:e.longSynonyms})))}}],failureReason:l?"":"Some ClosedListEntity synonyms exceed 2 words.",recommendation:Jt.SynonymsQuality.recommendation,docLinks:Jt.SynonymsQuality.docLink,severity:"Medium",category:"Usage"}}))}(_.botComponents.entity)})),name:"SynonymsQuality"},{fn:()=>un(a,void 0,void 0,(function*(){return function(e){var t,n,r;return sn(this,void 0,void 0,(function*(){if(!e||0===e.length)return{patternID:Jt.DuplicateRegexEntities.patternID,patternName:Jt.DuplicateRegexEntities.patternName,description:Jt.DuplicateRegexEntities.description,status:"Pass",instanceValue:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:void 0}],failureReason:"",recommendation:Jt.DuplicateRegexEntities.recommendation,docLinks:Jt.DuplicateRegexEntities.docLink,severity:"Medium",category:"Usage"};var i=new Map;for(var o of e)if("RegexEntity"===(null===(t=o.data)||void 0===t?void 0:t.kind)&&(null===(n=o.data)||void 0===n?void 0:n.pattern)){var a=o.data.pattern;i.has(a)||i.set(a,[]),null===(r=i.get(a))||void 0===r||r.push(o.name)}var s=[];for(var[l,c]of i.entries())c.length>1&&s.push({name:c[0],pattern:l,matchingPatternEntityList:c.slice(1)});var u=0===s.length;return{patternID:Jt.DuplicateRegexEntities.patternID,patternName:Jt.DuplicateRegexEntities.patternName,description:Jt.DuplicateRegexEntities.description,status:u?"Pass":"Fail",instanceValue:u?[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:void 0}]:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:{RegexEntity:s}}],failureReason:u?"":"Multiple entities of kind RegexEntity use the same regex pattern.",recommendation:Jt.DuplicateRegexEntities.recommendation,docLinks:Jt.DuplicateRegexEntities.docLink,severity:"Medium",category:"Usage"}}))}(_.botComponents.entity)})),name:"DuplicateRegexEntities"}],C=[],A=0,x=new Set,N=function*(){var{fn:e,name:n}=E;try{var r=yield e();if(t&&t.length>0&&!x.has(r.patternID)){var i=t.find((e=>e.data.patternID===r.patternID));if(i){var o=i.data;r.patternName=o.patternName||r.patternName,r.description=o.description||r.description,r.docLinks=o.docLinks||r.docLinks,r.recommendation=o.recommendation||r.recommendation,r.severity=o.severity||r.severity,r.category=o.category||r.category}}C.push(r),x.add(r.patternID),"Pass"===r.status&&A++}catch(e){var a=e instanceof Error?e.message:String(e);f.push({pattern:n,error:a})}};for(var E of S)yield*N();d+=A,u.push({name:m,displayName:p.botDisplayName,result:C,score:A})};for(var m of c)yield*h();return f.length>0&&console.error("Errors while checking copilot components:",f),{items:u,totalBots:u.length,totalScore:u.length>0?d/(u.length*p)*100:0}}))}var pn=n(451);function fn(e,t){e instanceof Error?hn.error("".concat(t,": ").concat(e.message)):hn.error("".concat(t,": Unknown error"))}var hn=n.n(pn)()(Object.assign({browser:{asObject:!0},level:"error"},{}));const mn=hn;function gn(e){return e.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//gm,"")}function vn(e,t,n,r,i,o,a,s){for(var l in o=o.split("@")[0],n){var c=n[l];on.includes(l)||("Gallery"!==a||l.startsWith("On")||jn(l,c,r,e,t,0,s,o),Mn(l,c,r,e,t,0,s,o),Un(l,c,r,e,t,0,s,o),Bn(l,c,r,e,t,0,s,o),Tn(l,c,r,e,t,o),zn(l,c,r,e,t,0,s,o),Ln(l,c,r,e,t,0,s,o))}}function yn(e,t,n,r,i,o,a){for(var s of n){var l=Object.keys(s)[0],c=s[l];c.Properties&&vn(e,l,c.Properties,r,0,c.Control,o,a),c.Children&&yn(e,0,c.Children,r,i,c.Control,a)}}function bn(e,t,n){var r=Xt[e],i=t.length>0,o=(e,t)=>null!=e&&""!==e?e:t,a=r.patternID,{patternName:s,description:l,docLinks:c,recommendation:u,severity:d,category:p}=r;if(n){var f=n.find((e=>e.key===a));if(f){var{data:h}=f;s=o(h.patternName,s),l=o(h.description,l),c=o(h.docLinks,c),u=i?o(h.recommendation,u):"",d=o(h.severity,d),p=o(h.category,p)}}else u=i?u:"";return{patternID:a,patternName:s,description:l,status:i?"Fail":"Pass",instanceValue:t,failureReason:i?"Found ".concat(t.length," occurrences."):"",recommendation:u,docLinks:c,severity:d,category:p}}function wn(e){for(var t,n=[],r=/\b(Filter|Search|ForAll|LookUp|Patch)\s*\(/gi;null!==(t=r.exec(e));){var i=t[1],o=t.index+t[0].indexOf("("),{endIndex:a}=_n(e,o);if(-1!==a){var s=e.substring(o+1,a);n.push({functionName:i,startIndex:o+1,endIndex:a,content:s})}}return n}function _n(e,t){for(var n=1,r=t+1;r<e.length&&n>0;)"("===e[r]?n++:")"===e[r]&&n--,r++;return 0===n?{endIndex:r-1}:{endIndex:-1}}function kn(e){for(var t=0,n=0;n<e.length;){if("("===e[n])t++;else if(")"===e[n])t--;else if(","===e[n]&&0===t)break;n++}return e.substring(0,n).trim()}function Sn(e){return e.replace(/^[\[\']\s*@?\s*(.+?)\s*[\]\']$/i,"$1").trim()}function Cn(e){for(var t,n=[],r=/\b(Patch)\s*\(/gi;null!==(t=r.exec(e));){var i=t[1],o=t.index+t[0].indexOf("("),{endIndex:a}=_n(e,o);if(-1!==a){var s=e.substring(o+1,a);n.push({functionName:i,startIndex:o+1,endIndex:a,content:s})}}return n}function An(e,t){for(var n=0,r=0,i=0,o=0,a=1;r<e.length;){var s=e[r];if("("===s)n++;else if(")"===s)n--;else if(","===s&&0===n){if(a===t){o=r;break}a++,i=r+1}r++}return a===t&&0===o&&(o=e.length),a===t?e.substring(i,o).trim():null}function xn(e,t,n){for(var r,i=/([a-zA-Z_][a-zA-Z0-9_]*)\s*\(/g;null!==(r=i.exec(e));){var o=r[1],a=r.index+r[0].length-1,{endIndex:s}=_n(e,a);if(-1!==s){if(t>=a&&t<=s&&n.map((e=>e.toLowerCase())).includes(o.toLowerCase()))return!0;i.lastIndex=s+1}}return!1}function Nn(e){for(var t,n=[],r=/\b(Filter|Search)\s*\(/gi;null!==(t=r.exec(e));){var i=t[1],o=t.index+t[0].indexOf("("),{endIndex:a}=_n(e,o);if(-1!==a){var s=e.substring(o+1,a);n.push({functionName:i,startIndex:o+1,endIndex:a,content:s})}}return n}function En(e){for(var t,n=[],r=/\b(Filter|Search|LookUp)\s*\(/gi;null!==(t=r.exec(e));){var i=t[1],o=t.index+t[0].indexOf("("),{endIndex:a}=_n(e,o);if(-1!==a){var s=e.substring(o+1,a);n.push({functionName:i,startIndex:o+1,endIndex:a,content:s})}}return n}var In=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};function On(e){return In(this,void 0,void 0,(function*(){var t=Xt[Yt.MediaFileSize],n=!0,r="",i="",o=new Set,a=e.assets;if(a.length>0){var s=[];a.forEach((e=>{e.exceedsThreshold&&(n=!1,s.push(e.mediaName))})),s.length>0&&(r+=t.recommendation+" "+s.join(", ")+". ",i+="Following files are exceeding 300KB file size: "+s.join(", ")+". ")}return e.appCheckerIssues.forEach((e=>{rn.includes(e.RuleId)&&o.add(e.RuleId)})),o.size>0&&(n=!1,r+="Please address the listed issues in failure reason.",i+="Errors or warnings from App Checker Results: "+Array.from(o).join(", ")),{patternID:t.patternID,patternName:t.patternName,description:t.description,status:n?"Pass":"Fail",instanceValue:[],failureReason:n?"":i,recommendation:n?"":r,docLinks:t.docLinks,severity:t.severity,category:t.category}}))}function Rn(e){var t;return In(this,void 0,void 0,(function*(){var n=Xt[Yt.AppSettings],r=!0,i="",o="",a=(null===(t=e.appSettings)||void 0===t?void 0:t.AppPreviewFlagsMap)||{},s=[];for(var l of en)!1===a[l]&&s.push(l);return s.length>0&&(r=!1,i=n.recommendation+" ".concat(s.join(", "),"."),o="Following settings are turned off: ".concat(s.join(", "),".")),{patternID:n.patternID,patternName:n.patternName,description:n.description,status:r?"Pass":"Fail",instanceValue:[],failureReason:r?"":o,recommendation:r?"":i,docLinks:n.docLinks,severity:n.severity,category:n.category}}))}function Dn(e){return In(this,void 0,void 0,(function*(){var t=Xt[Yt.AppCheckerAccessibilityIssues],n=!0,r="Errors or warnings from App Checker Results: ",i=new Set;return e.appCheckerIssues.forEach((e=>{"accessibility"===e.Category&&i.add(e.RuleId)})),i.size>0&&(n=!1,r=r.concat(" ",Array.from(i).join(", "))),{patternID:t.patternID,patternName:t.patternName,description:t.description,status:n?"Pass":"Fail",instanceValue:[],failureReason:n?"":r,recommendation:n?"":t.recommendation,docLinks:t.docLinks,severity:t.severity,category:t.category}}))}function Pn(e){return In(this,void 0,void 0,(function*(){var t=Xt[Yt.UnusedElements],n=!0,r="Errors or warnings from App Checker Results: ",i=new Set;return e.appCheckerIssues.forEach((e=>{nn.includes(e.RuleId)&&i.add(e.RuleId)})),i.size>0&&(n=!1,r=r.concat(" "+Array.from(i).join(", "))),{patternID:t.patternID,patternName:t.patternName,description:t.description,status:n?"Pass":"Fail",instanceValue:[],failureReason:n?"":r,recommendation:n?"":t.recommendation,docLinks:t.docLinks,severity:t.severity,category:t.category}}))}function Fn(e,t,n){try{t[Object.keys(t)[0]].Control.startsWith("GroupContainer")||n.push({ScreenName:e,ControlName:"",PropertyName:"",Code:"",PatternName:Yt.UxLayout,FailureReason:"Use Containers to build responsive apps."})}catch(e){e instanceof Error?mn.error("Error processing pattern: ".concat(e.message)):mn.error("Unknown error processing pattern")}}function Tn(e,t,n,r,i,o){var a=t,s=gn(t);"string"==typeof s&&(a.length===s.length&&s.length>1e3&&n.push({ScreenName:r,ControlName:i,PropertyName:e,Code:s,PatternName:Yt.CodeReadability,FailureReason:"Code length exceeds 1000 characters without any comments.",ControlType:o}),function(e){for(var t=function(e){for(var t=[],n="",r=!1,i="",o=0;o<e.length;o++){var a=e[o];r?(n+=a,a===i&&"\\"!==e[o-1]&&(r=!1)):'"'===a||"'"===a?(n.trim()&&t.push(n.trim()),n=a,r=!0,i=a):"("===a||")"===a||","===a?(n.trim()&&t.push(n.trim()),t.push(a),n=""):/\s/.test(a)?n.trim()&&(t.push(n.trim()),n=""):n+=a}return n.trim()&&t.push(n.trim()),t}(e),n=[],r=0;r<t.length;r++){var i=t[r];if("if"===i.toLowerCase()){if(n.push("if"),n.length>1)return!0}else")"===i&&n.length>0&&"if"===n[n.length-1]&&n.pop()}return!1}(s)&&n.push({ScreenName:r,ControlName:i,PropertyName:e,Code:s,PatternName:Yt.CodeReadability,FailureReason:"Nested If statements detected.",ControlType:o}))}function zn(e,t,n,r,i,o,a,s){var l=gn(t);if("string"==typeof l){var c=wn(l);for(var u of c){var d=wn(u.content);for(var p of d){var f=Sn(kn(p.content));if(a.includes(f.toLowerCase())){n.push({ScreenName:r,ControlName:i,PropertyName:e,Code:l,PatternName:Yt.NestedAPICalls,ControlType:s});break}}}}}function Ln(e,t,n,r,i,o,a,s){var l=gn(t);if("string"==typeof l){var c=Cn(l);for(var u of c){var d=An(u.content,1);if(d){var p=Sn(d);a.includes(p.toLowerCase())&&(xn(l,u.startIndex-1,["IfError","IsError"])||n.push({ScreenName:r,ControlName:i,PropertyName:e,Code:l,PatternName:Yt.ErrorHandling,ControlType:s}))}}}}function jn(e,t,n,r,i,o,a,s){var l=gn(t);if("string"==typeof t)for(var c of tn)for(var u=new RegExp("".concat(c,"\\(([^)]+)\\)"),"gi"),d=void 0;null!==(d=u.exec(l));){var p=Sn(d[1].split(",")[0].trim());a.includes(p.toLowerCase())&&n.push({ScreenName:r,ControlName:i,PropertyName:e,Code:l,PatternName:Yt.NPlusOne,ControlType:s})}}function Mn(e,t,n,r,i,o,a,s){var l=gn(t);if("string"==typeof l){var c=function(e){for(var t,n=[],r=/\b(First|FirstN|Last|LastN)\s*\(/gi;null!==(t=r.exec(e));){var i=t[1],o=t.index+t[0].indexOf("("),{endIndex:a}=_n(e,o);if(-1!==a){var s=e.substring(o+1,a);n.push({functionName:i,startIndex:o+1,endIndex:a,content:s})}}return n}(l);for(var u of c){var d=Nn(u.content);for(var p of d){var f=Sn(kn(p.content));a.includes(f.toLowerCase())&&n.push({ScreenName:r,ControlName:i,PropertyName:e,Code:l,PatternName:Yt.InefficientDataRetrieval,ControlType:s})}}}}function Un(e,t,n,r,i,o,a,s){var l=gn(t);if("string"==typeof l){var c=Nn(l);for(var u of c){var d=En(u.content);for(var p of d){var f=Sn(kn(p.content));a.includes(f.toLowerCase())&&n.push({ScreenName:r,ControlName:i,PropertyName:e,Code:l,PatternName:Yt.NestedFilters,ControlType:s})}}}}function Bn(e,t,n,r,i,o,a,s){var l=gn(t);if("string"==typeof l){var c=Cn(l);for(var u of c){var d=An(u.content,2);if(d){var p=En(d);for(var f of p){var h=Sn(kn(f.content));a.includes(h.toLowerCase())&&n.push({ScreenName:r,ControlName:i,PropertyName:e,Code:l,PatternName:Yt.PatchFormulaOptimization,ControlType:s})}}}}}var Vn=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};function Wn(e,t){return Vn(this,void 0,void 0,(function*(){var n=e.folder("CanvasApps"),r=[],i=0,a=Object.keys(Yt).length;if(!n)return mn.error("No CanvasApps folder found in the solution."),{items:r,totalApps:0,totalScore:0};var s=[];n.forEach(((e,n)=>{e.endsWith(".msapp")&&(i++,s.push(function(e,t,n){return Vn(this,void 0,void 0,(function*(){try{var r=yield e.async("arraybuffer"),i=yield o().loadAsync(r),a={appSettings:{Name:"",AppPreviewFlagsMap:{},AppDescription:""},totalCodeComponents:0,dataSources:[],appCheckerIssues:[],assets:[],yaml:{},totalCanvasComponents:0,totalScreens:0},s=i.folder("Resources\\");yield Promise.all([qn(i,a),Zn(s,a),Hn(i,a),Kn(i,a),Gn(i,a),Yn(i,a),Qn(i,a)]);var l=[],c=new Set,u=0,d=[On,Rn,Dn,Pn],p=function*(){try{var e=yield f(a);if(n&&n.length>0){if(!c.has(e.patternID)){var t=n.find((t=>t.data.patternID===e.patternID));if(t){var r=t.data;e.patternName=null!=r.patternName&&""!==r.patternName?r.patternName:e.patternName,e.description=null!=r.description&&""!==r.description?r.description:e.description,e.docLinks=null!=r.docLinks&&""!==r.docLinks?r.docLinks:e.docLinks,e.recommendation=null!=r.recommendation&&""!==r.recommendation?r.recommendation:e.recommendation,e.severity=null!=r.severity&&""!==r.severity?r.severity:e.severity,e.category=null!=r.category&&""!==r.category?r.category:e.category}}l.push(e),c.add(e.patternID),"Pass"===e.status&&u++}}catch(e){e instanceof Error?mn.error("Error processing pattern: ".concat(e.message)):mn.error("Unknown error processing pattern")}};for(var f of d)yield*p();var h=function(e,t){var n=[],r=function(e){var t={};for(var n of e){var r=n.PatternName;t[r]||(t[r]=[]),t[r].push(n)}return t}(e),i=Object.keys(Xt);for(var o of i){var a=bn(o,r[o]||[],t);n.push(a)}return n}(function(e){var t=e.yaml.Screens,n=[];if(!t)return mn.error("No screens found in the yaml structure."),n;var r=function(e){return e.dataSources&&Array.isArray(e.dataSources)?e.dataSources.filter((e=>"CollectionDataSourceInfo"!==e.Type&&"StaticDataSourceInfo"!==e.Type)).map((e=>e.Name)):(console.error("DataSources not found or not an array in msapp."),[])}(e).map((e=>e.toLowerCase()));for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=t[i];(null==o?void 0:o.Properties)&&vn(i,"",o.Properties,n,0,o.Control||"","",r),(null==o?void 0:o.Children)&&(yn(i,0,o.Children,n,e,o.Control||"",r),Fn(i,o.Children[0],n))}var a=e.yaml.App;return(null==a?void 0:a.Properties)&&(function(e,t,n){if(t.hasOwnProperty("Formulas")){var r=t.Formulas;r&&"string"==typeof r&&r.trim().length>0||n.push({ScreenName:e,ControlName:"",PropertyName:"Formulas",Code:"",PatternName:Yt.NamedFormulas,FailureReason:"The 'Formulas' property exists but is empty."})}else n.push({ScreenName:e,ControlName:"",PropertyName:"Formulas",Code:"",PatternName:Yt.NamedFormulas,FailureReason:"The 'Formulas' property is missing."})}("App",a.Properties,n),vn("App","",a.Properties,n,0,"","",r)),n}(a),n);for(var m of h)c.has(m.patternID)||("Pass"===m.status&&u++,l.push(m),c.add(m.patternID));t.push({name:decodeURI(a.appSettings.Name.substring(0,a.appSettings.Name.length-6)).replace(/%2B/g," ").replace(/%2b/g,"+")||a.appSettings.Name||"Unknown App Name",result:l,totalScreens:a.totalScreens||0,totalCanvasComponents:a.totalCanvasComponents||0,totalCodeComponents:a.totalCodeComponents||0,score:u})}catch(e){fn(e,"Error processing pattern app file")}}))}(n,r,t)))})),yield Promise.all(s);var l=r.reduce(((e,t)=>e+(t.score||0)),0);return{items:r,totalApps:i,totalScore:i?l/(i*a)*100:0}}))}function qn(e,t){return Vn(this,void 0,void 0,(function*(){var n=e.file("Properties.json");if(n)try{var r=yield n.async("string"),i=JSON.parse(r);t.appSettings=i}catch(e){fn(e,"Error parsing Properties.json")}else mn.error("Properties.json file not found in the .msapp file.")}))}function Zn(e,t){return Vn(this,void 0,void 0,(function*(){if(e){var n=e.folder("Controls");if(n){var r=Object.keys(n.files).filter((e=>e.endsWith("bundle.js")));t.totalCodeComponents=r.length}}}))}function Hn(e,t){return Vn(this,void 0,void 0,(function*(){var n=0,r=e.folder("Components\\");r?n=Object.keys(r.files).filter((e=>!r.files[e].dir&&e.startsWith("Components\\")&&e.endsWith(".json"))).length:mn.error("Components folder not found in the .msapp file."),t.totalCanvasComponents=n,mn.info("Total canvas component files detected: ".concat(n))}))}function Kn(e,t){return Vn(this,void 0,void 0,(function*(){var n=e.file("References\\DataSources.json");if(n)try{var r=yield n.async("string"),i=JSON.parse(r);t.dataSources=i.DataSources}catch(e){fn(e,"Error parsing DataSources.json")}else mn.error("DataSources.json file not found in the References folder.")}))}function Gn(e,t){return Vn(this,void 0,void 0,(function*(){var n=e.file("AppCheckerResult.sarif");if(n)try{var r=yield n.async("string"),i=JSON.parse(r);t.appCheckerIssues=function(e){return e.runs?e.runs.flatMap((e=>{var t,n,r,i,o=new Map(null===(r=null===(n=null===(t=e.tool)||void 0===t?void 0:t.driver)||void 0===n?void 0:n.rules)||void 0===r?void 0:r.map((e=>[e.id,e])));return(null===(i=e.results)||void 0===i?void 0:i.map((e=>{var t,n,r,i,a,s,l,c,u,d,p=o.get(e.ruleId);return{RuleId:e.ruleId,HowToFix:(null===(t=null==p?void 0:p.properties)||void 0===t?void 0:t.howToFix)||"No recommendation provided",WhyFix:(null===(n=null==p?void 0:p.properties)||void 0===n?void 0:n.whyFix)||"",Message:(null===(i=null===(r=null==p?void 0:p.messageStrings)||void 0===r?void 0:r.issue)||void 0===i?void 0:i.text)||"No message provided",Location:(null===(c=null===(l=null===(s=null===(a=e.locations)||void 0===a?void 0:a[0])||void 0===s?void 0:s.physicalLocation)||void 0===l?void 0:l.address)||void 0===c?void 0:c.fullyQualifiedName)||"Unknown Location",Severity:(null===(u=e.properties)||void 0===u?void 0:u.level)||"Unknown Severity",Category:(null===(d=null==p?void 0:p.properties)||void 0===d?void 0:d.primaryCategory)||""}})))||[]})):[]}(i)}catch(e){fn(e,"Error parsing AppCheckerResult.sarif")}else mn.error("AppCheckerResult.sarif file not found in the .msapp file.")}))}function Yn(e,t){return Vn(this,void 0,void 0,(function*(){var n=e.folder("Assets\\Images");if(n){var r=Object.keys(n.files).filter((e=>!n.files[e].dir&&e.startsWith("Assets\\Images\\"))),i=[],o=function*(e){var r=n.file(e);if(r){var o=r.async("blob").then((n=>{var r=n.size,i=e.split("/").pop()||e;t.assets.push({mediaName:i,mediaSize:r,exceedsThreshold:r>$t})})).catch((t=>{mn.error("Failed to process file ".concat(e,": ").concat(t.message))}));i.push(o)}};for(var a of r)yield*o(a);yield Promise.all(i)}}))}function Qn(e,t){return Vn(this,void 0,void 0,(function*(){var n=e.folder("Src\\");if(n){var r=Object.keys(n.files).filter((e=>!n.files[e].dir&&e.startsWith("Src\\"))),i=[],o=0,a={},s=function*(t){var n=e.file(t);if(o++,n){var r=n.async("string").then((e=>{var n,r;if(e){var i=Mt.load(e),o=null===(n=t.split(/[/\\]/).pop())||void 0===n?void 0:n.replace(".pa.yaml","");"App"===o?a.App=i.App:o&&(null===(r=i.Screens)||void 0===r?void 0:r[o])&&(a.Screens=a.Screens||{},a.Screens[o]=i.Screens[o])}})).catch((e=>{mn.error("Failed to process file ".concat(t,": ").concat(e.message))}));i.push(r)}else mn.error("File not found in JSZip structure for path: ".concat(t))};for(var l of r)yield*s(l);yield Promise.all(i),t.totalScreens=o-1,t.yaml=a}else mn.error("Src folder not found in the .msapp file.")}))}function Jn(e){var t=Qt.UnusedVariables.patternID,n=Qt.UnusedVariables.recommendation,r=Qt.UnusedVariables.docLink,i=Qt.UnusedVariables.patternName,o=function(e){var t,n,r=(null===(n=null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.definition)||void 0===n?void 0:n.actions)||{},i=[];return Object.keys(r).forEach((e=>{var t,n=r[e];(null===(t=n.inputs)||void 0===t?void 0:t.variables)&&i.push(...n.inputs.variables)})),i}(e),a=function(e){var t,n,r=(null===(n=null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.definition)||void 0===n?void 0:n.actions)||{},i=new Set;return Object.keys(r).forEach((e=>{var t,n=r[e];(null===(t=null==n?void 0:n.inputs)||void 0===t?void 0:t.name)&&i.add(n.inputs.name)})),i}(e),s=[];function l(e,t){return"@variables('".concat(t,"')"),!("string"!=typeof e||!e.includes("variables('".concat(t,"')")))||!(!e||"object"!=typeof e)&&Object.values(e).some((e=>l(e,t)))}return o.forEach((t=>{l(e,t.name)&&a.add(t.name)})),o.forEach((e=>{a.has(e.name)||s.push(e.name)})),{patternID:t,patternName:i,description:"Check for variables that are declared but not used.",status:0===s.length?"Pass":"Fail",instanceValue:s,failureReason:s.length>0?"Unused variables detected.":"",recommendation:n,docLinks:r,severity:"Medium",category:"Coding Standards"}}function Xn(e){var t=Qt.ActionCount.patternID,n=Qt.ActionCount.recommendation,r=Qt.ActionCount.docLink,i=Qt.ActionCount.patternName,o=function e(t){var n=0;return t&&"object"==typeof t?(t.hasOwnProperty("actions")&&"object"==typeof t.actions&&(n+=Object.keys(t.actions).length),Object.values(t).forEach((t=>{("object"==typeof t||Array.isArray(t))&&(n+=e(t))}))):Array.isArray(t)&&t.forEach((t=>{n+=e(t)})),n}(e),a=o>50;return{patternID:t,patternName:i,description:"Limit the number of actions to optimize flow performance.",status:a?"Fail":"Pass",instanceValue:a?["".concat(o," actions detected, consider reduction.")]:[],failureReason:a?"Action count exceeds recommended limit.":"",recommendation:n,docLinks:r,severity:"Medium",category:"Performance"}}function $n(e){var t,n,r,i,o=Qt.NamingConventions.patternID,a=Qt.NamingConventions.recommendation,s=Qt.NamingConventions.docLink,l=Qt.NamingConventions.patternName,c=(null===(n=null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.definition)||void 0===n?void 0:n.actions)||{},u=(null===(i=null===(r=null==e?void 0:e.properties)||void 0===r?void 0:r.definition)||void 0===i?void 0:i.triggers)||{},d=[];function p(e,t){Object.keys(e).forEach((e=>{e.startsWith(t)||d.push(e)}))}return p(u,"Trg_"),p(c,"Act_"),{patternID:o,patternName:l,description:"Ensure naming consistency for triggers, actions, and variables.",status:0===d.length?"Pass":"Fail",instanceValue:d,failureReason:d.length>0?"Inconsistent naming detected.":"",recommendation:a,docLinks:s,severity:"Low",category:"Maintainability"}}function er(e){var t,n,r=Qt.NestedLoops.description,i=Qt.NestedLoops.patternID,o=Qt.NestedLoops.recommendation,a=Qt.NestedLoops.docLink,s=Qt.NestedLoops.patternName,l=(null===(n=null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.definition)||void 0===n?void 0:n.actions)||{},c=[],u=new Set;function d(e,t,n){if(e&&"object"==typeof e){if(u.has(t))return;u.add(t);var r=e.type;if("Foreach"===r||"Until"===r){if(n.length>0){var i=n[n.length-1];c.push("".concat(i," -> ").concat(t))}n.push(t)}e.actions&&Object.keys(e.actions).forEach((t=>{d(e.actions[t],t,[...n])})),"If"===r&&(e.actions&&Object.keys(e.actions).forEach((t=>{d(e.actions[t],t,[...n])})),e.else&&e.else.actions&&Object.keys(e.else.actions).forEach((t=>{d(e.else.actions[t],t,[...n])}))),"Switch"===r&&e.cases&&Object.entries(e.cases).forEach((e=>{var[t,r]=e;r.actions&&Object.keys(r.actions).forEach((e=>{d(r.actions[e],e,[...n])}))})),"Scope"===r&&e.actions&&Object.keys(e.actions).forEach((t=>{d(e.actions[t],t,[...n])})),"Foreach"!==r&&"Until"!==r||n.pop()}}return Object.keys(l).forEach((e=>{d(l[e],e,[])})),{patternID:i,patternName:s,description:r,status:0===c.length?"Pass":"Fail",instanceValue:c,failureReason:c.length>0?"Nested loops detected.":"",recommendation:o,docLinks:a,severity:"High",category:"Performance"}}function tr(e){var t,n,r=Qt.Concurrency.patternID,i=Qt.Concurrency.recommendation,o=Qt.Concurrency.docLink,a=Qt.Concurrency.patternName,s=[];return function e(t){t&&"object"==typeof t&&Object.keys(t).forEach((n=>{var r,i,o=t[n];"Foreach"!==o.type||(null===(i=null===(r=o.runtimeConfiguration)||void 0===r?void 0:r.concurrency)||void 0===i?void 0:i.repetitions)||s.push(n),"If"===o.type?(o.actions&&e(o.actions),o.else&&o.else.actions&&e(o.else.actions)):"Switch"===o.type&&o.cases?Object.values(o.cases).forEach((t=>{t.actions&&e(t.actions)})):("Until"===o.type&&o.actions||"Scope"===o.type&&o.actions||o.actions)&&e(o.actions)}))}((null===(n=null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.definition)||void 0===n?void 0:n.actions)||{}),{patternID:r,patternName:a,description:"Verify loops and actions use parallel execution and concurrency settings.",status:0===s.length?"Pass":"Fail",instanceValue:s,failureReason:s.length>0?"Concurrency settings missing.":"",recommendation:i,docLinks:o,severity:"Medium",category:"Performance"}}function nr(e){var t,n,r=Qt.TriggerCondition.patternID,i=Qt.TriggerCondition.recommendation,o=Qt.TriggerCondition.docLink,a=Qt.TriggerCondition.patternName,s=(null===(n=null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.definition)||void 0===n?void 0:n.triggers)||{},l=[];return s.manual||Object.keys(s).forEach((e=>{var t=s[e];t.conditions&&0!==t.conditions.length||l.push(e)})),{patternID:r,patternName:a,description:"Check if flow triggers are configured to prevent infinite runs.",status:0===l.length?"Pass":"Fail",instanceValue:l,failureReason:l.length>0?"Missing trigger conditions to avoid unnecessary flow executions.":"",recommendation:i,docLinks:o,severity:"High",category:"Validation"}}function rr(e){var t=Qt.MultipleInitializeVariableActions.description,n=Qt.MultipleInitializeVariableActions.patternID,r=Qt.MultipleInitializeVariableActions.recommendation,i=Qt.MultipleInitializeVariableActions.docLink,o=Qt.MultipleInitializeVariableActions.patternName,a=0;!function e(t){if(t&&"object"==typeof t&&("InitializeVariable"===t.type&&(a+=1),t.actions))for(var n in t.actions)e(t.actions[n])}(e.properties.definition);var s=a>1;return{patternID:n,patternName:o,description:t,status:s?"Fail":"Pass",instanceValue:s?["InitializeVariable actions count: ".concat(a)]:[],failureReason:s?"More than one 'InitializeVariable' action detected.":"",recommendation:r,docLinks:i,severity:"Low",category:"Coding Standards"}}function ir(e){var t=Qt.StaticVariables.description,n=Qt.StaticVariables.patternID,r=Qt.StaticVariables.recommendation,i=Qt.StaticVariables.docLink,o=Qt.StaticVariables.patternName,a=new Set,s=new Set,l=[];!function e(t){var n,r,i,o;if(t&&"object"==typeof t){if(t.type)if("InitializeVariable"===t.type){var l=null===(i=null===(r=null===(n=t.inputs)||void 0===n?void 0:n.variables)||void 0===r?void 0:r[0])||void 0===i?void 0:i.name;l&&a.add(l)}else if("SetVariable"===t.type||"IncrementVariable"===t.type||"DecrementVariable"===t.type||"AppendToStringVariable"===t.type||"AppendToArrayVariable"===t.type){var c=null===(o=t.inputs)||void 0===o?void 0:o.name;c&&s.add(c)}if(t.actions)for(var u in t.actions)e(t.actions[u]);for(var d in t)"actions"!==d&&t.hasOwnProperty(d)&&e(t[d])}}(e.properties.definition),a.forEach((e=>{s.has(e)||l.push(e)}));var c=l.length>0;return{patternID:n,patternName:o,description:t,status:c?"Fail":"Pass",instanceValue:l,failureReason:c?"Variables initialized but never updated detected. Use ":"",recommendation:r,docLinks:i,severity:"Low",category:"Optimization"}}function or(e){var t=Qt.PowerAppResponse.description,n=Qt.PowerAppResponse.patternID,r=Qt.PowerAppResponse.recommendation,i=Qt.PowerAppResponse.docLink,o=Qt.PowerAppResponse.patternName,a=!1;return function e(t){if(t&&"object"==typeof t){if("Response"===t.type&&"PowerApp"===t.kind&&(a=!0),t.actions)for(var n in t.actions)e(t.actions[n]);for(var r in t)"actions"!==r&&t.hasOwnProperty(r)&&e(t[r])}}(e.properties.definition),{patternID:n,patternName:o,description:t,status:a?"Fail":"Pass",instanceValue:a?["PowerApp response action found"]:[],failureReason:a?"Warning: Logic may fail if the response is not sent within 120 seconds.":"",recommendation:r,docLinks:i,severity:"Medium",category:"Reliability"}}function ar(e){var t=Qt.ScopeUsage.description,n=Qt.ScopeUsage.patternID,r=Qt.ScopeUsage.recommendation,i=Qt.ScopeUsage.docLink,o=Qt.ScopeUsage.patternName,a=!1,s=function e(t){var n=0;return t&&"object"==typeof t?(t.hasOwnProperty("actions")&&"object"==typeof t.actions&&(n+=Object.keys(t.actions).length),"Scope"===t.type&&(a=!0),Object.values(t).forEach((t=>{("object"==typeof t||Array.isArray(t))&&(n+=e(t))}))):Array.isArray(t)&&t.forEach((t=>{n+=e(t)})),n}(e),l=s>10&&!a;return{patternID:n,patternName:o,description:t,status:l?"Fail":"Pass",instanceValue:l?["Action count: ".concat(s)]:[],failureReason:l?"Use Scopes to group actions and implement error handling (with Run After conditions) to handle failures gracefully.":"",recommendation:r,docLinks:i,severity:"Low",category:"Coding Standards"}}function sr(e){var t,n,r=Qt.DataRetrievalParameters.description,i=Qt.DataRetrievalParameters.patternID,o=Qt.DataRetrievalParameters.recommendation,a=Qt.DataRetrievalParameters.docLink,s=Qt.DataRetrievalParameters.patternName,l=[],c=new Set;!function e(t){t&&"object"==typeof t&&Object.keys(t).forEach((n=>{var r=t[n];if(!c.has(n)){if(c.add(n),"OpenApiConnection"===r.type){var i=r.inputs;if(i&&i.host&&i.parameters){var o=i.host.operationId,a=i.host.apiId||"";if("GetItems"===o&&a.includes("sharepoint")){var s=i.parameters,u=s.hasOwnProperty("$filter"),d=s.hasOwnProperty("$top");u&&d||l.push("Action '".concat(n,"' (SharePoint GetItems) is missing '").concat(u?"":"$filter").concat(u||d?"":" and ").concat(d?"":"$top","'."))}else if("GetItem"===o&&a.includes("commondataservice"))i.parameters.hasOwnProperty("$select")||l.push("Action '".concat(n,"' (CDS GetItem) is missing '$select'."));else if("ListRecords"===o&&a.includes("commondataservice")){var p=i.parameters,f=[];if(p.hasOwnProperty("$select")||f.push("$select"),p.hasOwnProperty("$filter")||f.push("$filter"),p.hasOwnProperty("$top")||f.push("$top"),f.length>0){var h=1===(m=f).length?m[0]:2===m.length?"".concat(m[0]," and ").concat(m[1]):"".concat(m.slice(0,-1).join(", "),", and ").concat(m[m.length-1]);l.push("Action '".concat(n,"' (CDS ListRecords) is missing '").concat(h,"'."))}}}}var m;r.actions&&e(r.actions),"If"===r.type&&(r.actions&&e(r.actions),r.else&&r.else.actions&&e(r.else.actions)),"Switch"===r.type&&r.cases&&Object.values(r.cases).forEach((t=>{t.actions&&e(t.actions)})),"Foreach"!==r.type&&"Until"!==r.type||!r.actions||e(r.actions)}}))}((null===(n=null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.definition)||void 0===n?void 0:n.actions)||{});var u=l.length>0;return{patternID:i,patternName:s,description:r,status:u?"Fail":"Pass",instanceValue:l,failureReason:u?"Missing recommended parameters in data retrieval actions.":"",recommendation:o,docLinks:a,severity:"Medium",category:"Optimization"}}function lr(e){var t,n,r=Qt.ActionNote.description,i=Qt.ActionNote.patternID,o=Qt.ActionNote.recommendation,a=Qt.ActionNote.docLink,s=Qt.ActionNote.patternName,l=[];!function e(t){t&&"object"==typeof t&&Object.keys(t).forEach((n=>{var r,i=t[n];i.description&&""!==i.description.trim()||l.push(n),i.actions&&e(i.actions),"If"===i.type&&(i.actions&&e(i.actions),(null===(r=i.else)||void 0===r?void 0:r.actions)&&e(i.else.actions)),"Switch"===i.type&&i.cases&&Object.values(i.cases).forEach((t=>{t.actions&&e(t.actions)})),"Foreach"!==i.type&&"Until"!==i.type||!i.actions||e(i.actions)}))}((null===(n=null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.definition)||void 0===n?void 0:n.actions)||{});var c=l.length>0;return{patternID:i,patternName:s,description:r,status:c?"Fail":"Pass",instanceValue:l,failureReason:c?"Actions missing notes.":"",recommendation:o,docLinks:a,severity:"Low",category:"Mantainability"}}function cr(e){var t,n,r=Qt.CreateUpdateInsideLoop.description,i=Qt.CreateUpdateInsideLoop.patternID,o=Qt.CreateUpdateInsideLoop.recommendation,a=Qt.CreateUpdateInsideLoop.docLink,s=Qt.CreateUpdateInsideLoop.patternName,l=new Set,c=["CreateRecord","CreateRecordWithOrganization","UpdateOnlyRecord","UpdateOnlyRecordWithOrganization","UpdateRecord","UpdateRecordWithOrganization","DeleteRecord","DeleteRecordWithOrganization"],u=["CreateFile","PostItem","DeleteFile","DeleteItem","UpdateFile","PatchItem"];!function e(t,n){t&&"object"==typeof t&&Object.keys(t).forEach((r=>{var i,o,a,s,d,p=t[r],f=null===(o=null===(i=p.inputs)||void 0===i?void 0:i.host)||void 0===o?void 0:o.operationId,h=null===(s=null===(a=p.inputs)||void 0===a?void 0:a.host)||void 0===s?void 0:s.apiId;n&&"OpenApiConnection"===p.type&&((null==h?void 0:h.includes("commondataservice"))&&c.includes(f)||(null==h?void 0:h.includes("sharepoint"))&&u.includes(f))&&l.add(r),"Foreach"!==p.type&&"Until"!==p.type||e(p.actions,!0),p.actions&&e(p.actions,n),"If"===p.type&&(p.actions&&e(p.actions,n),(null===(d=p.else)||void 0===d?void 0:d.actions)&&e(p.else.actions,n)),"Switch"===p.type&&p.cases&&Object.values(p.cases).forEach((t=>{t.actions&&e(t.actions,n)}))}))}((null===(n=null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.definition)||void 0===n?void 0:n.actions)||{},!1);var d=l.size>0;return{patternID:i,patternName:s,description:r,status:d?"Fail":"Pass",instanceValue:Array.from(l),failureReason:d?"Create/Update actions found inside loops.":"",recommendation:o,docLinks:a,severity:"High",category:"Performance"}}function ur(e,t,n,r){return i=this,a=void 0,l=function*(){try{var i;if(t){var a={SolutionName:t,Managed:!1,getMetadata:()=>({boundParameter:null,parameterTypes:{SolutionName:{typeName:"Edm.String",structuralProperty:1},Managed:{typeName:"Edm.Boolean",structuralProperty:1}},operationType:0,operationName:"ExportSolution"})};try{var s=yield n.execute(a),l=yield s.json();if(!(null==l?void 0:l.ExportSolutionFile))return void console.error("No solution found or failed to export the solution.");var c=(v=l.ExportSolutionFile,y="function"==typeof atob?atob(v):Buffer.from(v,"base64").toString("binary"),Uint8Array.from(y,(e=>e.charCodeAt(0)))),u=new(o());i=yield u.loadAsync(new File([new Blob([c.buffer],{type:"application/zip"})],t))}catch(e){return void(e instanceof Error?console.error("Error exporting the solution:",e.message,e.stack):console.error("Unknown error occurred during solution export:",e))}}else if(e){var d=new(o());i=yield d.loadAsync(e)}if(i){var p=yield dn(i,r),f=yield Wn(i,r),h=yield function(e,t){return n=this,r=void 0,o=function*(){var n=e.folder("Workflows"),r=[],i=Object.keys(Kt).length,o=[],a=0;if(!n)return console.error("No Workflows folder found in the solution."),{listofPowerAutomate:[],totalFlows:0,totalScore:0};var s=[];return n.forEach(((e,n)=>{e.endsWith(".json")&&s.push(n.async("string").then((n=>{var i,s=JSON.parse(n),l=null===(i=e.split("/").pop())||void 0===i?void 0:i.replace(".json",""),c=[],u=0,d=new Set,p=[{fn:sr,name:"DataRetrievalParametersResult"},{fn:ar,name:"ScopeUsage"},{fn:er,name:"NestedLoops"},{fn:tr,name:"Concurrency"},{fn:$n,name:"NamingConventions"},{fn:nr,name:"TriggerCondition"},{fn:or,name:"PowerAppResponse"},{fn:ir,name:"StaticVariables"},{fn:rr,name:"MultipleInitializeVariableActions"},{fn:Jn,name:"UnusedVariables"},{fn:Xn,name:"ActionCounts"},{fn:lr,name:"ActionDescriptionCheck"},{fn:cr,name:"CreateUpdateInsideLoop"}],f=function(){var{fn:e,name:n}=h;try{var r=e(s);if(t&&t.length>0&&!d.has(r.patternID)){var i=t.find((e=>e.data.patternID===r.patternID));if(i){var a=i.data;r.patternName=a.patternName||r.patternName,r.description=a.description||r.description,r.docLinks=a.docLinks||r.docLinks,r.recommendation=a.recommendation||r.recommendation,r.severity=a.severity||r.severity,r.category=a.category||r.category}}c.push(r),d.add(r.patternID),"Pass"===r.status&&(u+=1)}catch(e){var l=e instanceof Error?e.message:String(e);o.push({pattern:n,error:l})}};for(var h of p)f();a+=u,r.push({name:l,displayName:null==l?void 0:l.split(/-[A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}/)[0],result:c,score:u})})).catch((t=>{var n=t instanceof Error?t.message:String(t);console.error("Failed to process file ".concat(e,":"),n),o.push({file:e,error:n})})))})),console.log(o),yield Promise.all(s),{items:r,totalFlows:r.length,totalScore:r.length>0?a/(r.length*i)*100:0}},new((i=void 0)||(i=Promise))((function(e,t){function a(e){try{l(o.next(e))}catch(e){t(e)}}function s(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(n,r||[])).next())}));var n,r,i,o}(i,r),m=0,g=0;return p.totalBots>0&&(m+=p.totalScore,g++),f.totalApps>0&&(m+=f.totalScore,g++),h.totalFlows>0&&(m+=h.totalScore,g++),{Copilot:p,PowerApps:f,PowerAutomate:h,SolutionScore:g>0?m/g:0}}}catch(e){e instanceof Error?console.error("An error occurred during review:",e.message,e.stack):console.error("Unknown error during review:",e)}var v,y},new((s=void 0)||(s=Promise))((function(e,t){function n(e){try{o(l.next(e))}catch(e){t(e)}}function r(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s((function(e){e(i)}))).then(n,r)}o((l=l.apply(i,a||[])).next())}));var i,a,s,l}var dr={1:"Entity",2:"Attribute",3:"Relationship",4:"Attribute Picklist Value",5:"Attribute Lookup Value",6:"View Attribute",7:"Localized Label",8:"Relationship Extra Condition",9:"Option Set",10:"Entity Relationship",11:"Entity Relationship Role",12:"Entity Relationship Relationships",13:"Managed Property",14:"Entity Key",16:"Privilege",17:"PrivilegeObjectTypeCode",18:"Index",20:"Role",21:"Role Privilege",22:"Display String",23:"Display String Map",24:"Form",25:"Organization",26:"Saved Query",29:"Workflow",31:"Report",32:"Report Entity",33:"Report Category",34:"Report Visibility",35:"Attachment",36:"Email Template",37:"Contract Template",38:"KB Article Template",39:"Mail Merge Template",44:"Duplicate Rule",45:"Duplicate Rule Condition",46:"Entity Map",47:"Attribute Map",48:"Ribbon Command",49:"Ribbon Context Group",50:"Ribbon Customization",52:"Ribbon Rule",53:"Ribbon Tab To Command Map",55:"Ribbon Diff",59:"Saved Query Visualization",60:"System Form",61:"Web Resource",62:"Site Map",63:"Connection Role",64:"Complex Control",65:"Hierarchy Rule",66:"Custom Control",68:"Custom Control Default Config",70:"Field Security Profile",71:"Field Permission",90:"Plugin Type",91:"Plugin Assembly",92:"SDK Message Processing Step",93:"SDK Message Processing Step Image",95:"Service Endpoint",150:"Routing Rule",151:"Routing Rule Item",152:"SLA",153:"SLA Item",154:"Convert Rule",155:"Convert Rule Item",161:"Mobile Offline Profile",162:"Mobile Offline Profile Item",165:"Similarity Rule",166:"Data Source Mapping",201:"SDKMessage",202:"SDKMessageFilter",203:"SdkMessagePair",204:"SdkMessageRequest",205:"SdkMessageRequestField",206:"SdkMessageResponse",207:"SdkMessageResponseField",208:"Import Map",210:"WebWizard",300:"Canvas App",371:"Connector",372:"Connector",380:"Environment Variable Definition",381:"Environment Variable Value",400:"AI Project Type",401:"AI Project",402:"AI Configuration",430:"Entity Analytics Configuration",431:"Attribute Image Configuration",432:"Entity Image Configuration"},pr=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},fr="application/xml",hr={0:"Workflow",1:"Dialog",2:"Business Rule",3:"Action",4:"Business Process Flow",5:"Modern Flow",6:"Desktop Flow",7:"AI Flow"};function mr(e,t,n){return pr(this,void 0,void 0,(function*(){try{var r;if(n){var i={SolutionName:n,Managed:!1,getMetadata:()=>({boundParameter:null,parameterTypes:{SolutionName:{typeName:"Edm.String",structuralProperty:1},Managed:{typeName:"Edm.Boolean",structuralProperty:1}},operationType:0,operationName:"ExportSolution"})};try{var a=yield e.execute(i),s=yield a.json();if(!(null==s?void 0:s.ExportSolutionFile))return void console.error("No solution found or failed to export the solution.");var l=(C=s.ExportSolutionFile,A="function"==typeof atob?atob(C):Buffer.from(C,"base64").toString("binary"),Uint8Array.from(A,(e=>e.charCodeAt(0)))),c=new(o());r=yield c.loadAsync(new File([new Blob([l.buffer],{type:"application/zip"})],n))}catch(e){return void(e instanceof Error?console.error("Error exporting the solution:",e.message,e.stack):console.error("Unknown error occurred during solution export:",e))}}else if(t){var u=new(o());r=yield u.loadAsync(t)}if(r){var d=yield function(e){return pr(this,void 0,void 0,(function*(){var t=e.folder("CanvasApps"),n={canvasApps:[]};if(!t)return console.error("No CanvasApps folder found in the solution."),n;var r=[];return t.forEach(((e,t)=>{e.endsWith(".msapp")&&r.push(function(e,t){return pr(this,void 0,void 0,(function*(){try{var n=yield e.async("arraybuffer"),r=yield o().loadAsync(n),i=e.name.replace(/\.msapp$/,"").split("/").pop()||"UnknownApp",a=yield function(e){return pr(this,void 0,void 0,(function*(){var t=e.file("Properties.json");if(!t)return mn.error("Properties.json file not found in the .msapp file."),"";try{var n=yield t.async("string");return JSON.parse(n).AppDescription}catch(e){return fn(e,"Error parsing Properties.json"),""}}))}(r),s=yield function(e){var t;return pr(this,void 0,void 0,(function*(){var n=e.folder("Src"),r={};if(n){var i=Object.keys(n.files).filter((e=>e.endsWith(".pa.yaml")&&!n.files[e].dir));for(var o of i){var a=e.file(o);if(a){var s=yield a.async("string"),l=null===(t=o.split(/[/\\]/).pop())||void 0===t?void 0:t.replace(".pa.yaml","");console.log(l),l&&"App"!==l&&(r[l]={screenName:l,screenYaml:s},console.log("Processed File: ".concat(o,", Screen: ").concat(l)))}else console.error("File not found: ".concat(o))}}else console.error("Src folder not found inside the .msapp file.");return r}))}(r),l={appName:i,appDescription:a,screens:Object.values(s)};t.push(l)}catch(t){console.error("Error processing app ".concat(e.name,":"),t)}}))}(t,n.canvasApps))})),yield Promise.all(r),n}))}(r),p=yield function(e){var t,n,r,i;return pr(this,void 0,void 0,(function*(){var o=e.file("solution.xml");if(o){var a=yield o.async("string"),s=(new DOMParser).parseFromString(a,fr),l=(null===(t=s.getElementsByTagName("UniqueName")[0])||void 0===t?void 0:t.textContent)||"";return{displayName:(null===(n=s.querySelector("LocalizedNames > LocalizedName"))||void 0===n?void 0:n.getAttribute("description"))||"",uniqueName:l,description:(null===(r=s.querySelector("Descriptions > Description"))||void 0===r?void 0:r.getAttribute("description"))||"",version:(null===(i=s.getElementsByTagName("Version")[0])||void 0===i?void 0:i.textContent)||""}}return console.error("solution.xml file not found."),null}))}(r),f=yield function(e){var t,n,r,i,o,a;return pr(this,void 0,void 0,(function*(){var s={workflows:[]},l=e.file("customizations.xml");if(!l)return console.error("No customizations.xml file found in the solution."),s;console.log("customizations.xml file found. Parsing XML...");var c,u=yield l.async("string"),d=new DOMParser;try{c=d.parseFromString(u,fr)}catch(e){return console.error("Failed to parse customizations.xml content:",e),s}var p=c.querySelector("ImportExportXml > Workflows");if(!p)return console.error("No Workflows node found in the customizations.xml file."),s;var f=p.querySelectorAll("Workflow"),h=Array.from(f);for(var m of h)try{var g=null!==(t=m.getAttribute("Name"))&&void 0!==t?t:"None",v=null!==(r=null===(n=m.querySelector("PrimaryEntity"))||void 0===n?void 0:n.textContent)&&void 0!==r?r:"None",y=parseInt(null!==(o=null===(i=m.querySelector("Category"))||void 0===i?void 0:i.textContent)&&void 0!==o?o:"0",10),b={name:g,primaryEntity:v,category:hr[y],json:void 0};if(5===y){var w=null===(a=m.querySelector("JsonFileName"))||void 0===a?void 0:a.textContent;if(w){w=w.startsWith("/")?w.slice(1):w;var _=e.file(w);if(_)try{var k=yield _.async("string");b.json=k}catch(e){console.error("Failed to read or parse JSON from ".concat(w,":"),e)}else console.warn("JSON file ".concat(w," referenced but not found in the zip."))}else console.warn("No JsonFileName specified for workflow with category 5.")}s.workflows.push(b)}catch(e){console.error("Error processing workflow: Name=".concat(name),e)}return 0===s.workflows.length?console.warn("No workflows processed. The solution may not contain valid workflows."):console.log("Successfully processed ".concat(s.workflows.length," workflows.")),s}))}(r),h=yield function(e){return pr(this,void 0,void 0,(function*(){var t={codeComponents:[]},n=e.folder("Controls");if(!n)return t;var r=[];return n.forEach(((e,n)=>{e.endsWith("ControlManifest.xml")&&r.push((()=>pr(this,void 0,void 0,(function*(){var r,i,o,a,s,l,c,u;try{var d=yield n.async("string"),p=(new DOMParser).parseFromString(d,"application/xml"),f=null!==(i=null===(r=p.querySelector("control"))||void 0===r?void 0:r.getAttribute("display-name-key"))&&void 0!==i?i:"",h=null!==(a=null===(o=p.querySelector("control"))||void 0===o?void 0:o.getAttribute("description-key"))&&void 0!==a?a:"",m=null!==(l=null===(s=p.querySelector("control"))||void 0===s?void 0:s.getAttribute("control-type"))&&void 0!==l?l:"",g=null!==(u=null===(c=p.querySelector("control"))||void 0===c?void 0:c.getAttribute("version"))&&void 0!==u?u:"";t.codeComponents.push({displayName:f,description:h,type:m,version:g})}catch(t){console.error("Error processing ControlManifest.xml in ".concat(e,":"),t)}})))())})),yield Promise.all(r),t}))}(r),m=yield function(e){return pr(this,void 0,void 0,(function*(){var t={customApis:[]},n=e.folder("customapis");if(!n)return console.error("No customapis folder found in the solution."),t;var r=[];return n.forEach(((n,i)=>{!i.dir&&n.endsWith("customapi.xml")?r.push(gr(i,n,t)):i.dir&&r.push(function(e,t,n,r){return pr(this,void 0,void 0,(function*(){var t=n.folder(e);if(t){var i=t.file("customapi.xml");i?yield gr(i,e,r):console.error("customapi.xml not found in ".concat(e,". Skipping this folder."))}}))}(n,0,e,t))})),yield Promise.all(r),console.log("Successfully processed ".concat(t.customApis.length," custom APIs.")),t}))}(r),g=yield function(e){return pr(this,void 0,void 0,(function*(){var t={environmentVariables:[]},n=e.folder("environmentvariabledefinitions");if(!n)return console.error("No environmentvariabledefinitions folder found in the solution."),t;var r=[];return n.forEach(((n,i)=>{i.dir?r.push(function(e,t,n,r){return pr(this,void 0,void 0,(function*(){var t=n.folder(e);if(t){var i=t.file("environmentvariabledefinition.xml");i?yield vr(i,e,r):console.error("environmentvariabledefinition.xml not found in ".concat(e,". Skipping this folder."))}}))}(n,0,e,t)):n.endsWith("environmentvariabledefinition.xml")&&r.push(vr(i,n,t))})),yield Promise.all(r),t}))}(r),v={roles:[]};yield function(e,t){return pr(this,void 0,void 0,(function*(){try{var n=e.file(Gt);if(!n)return;var r=yield n.async("string");(new DOMParser).parseFromString(r,fr).querySelectorAll("Roles > Role").forEach((e=>{var n=e.getAttribute("id")||"",r=e.getAttribute("name")||"";console.log("ID: ".concat(n,", Name: ").concat(r)),t.roles.push({name:r})}))}catch(e){console.error("Error processing security roles:",e)}}))}(r,v);var y={plugins:[]};yield function(e,t){return pr(this,void 0,void 0,(function*(){try{var n=e.file(Gt);if(!n)return;var r=yield n.async("string");(new DOMParser).parseFromString(r,fr).querySelectorAll("SolutionPluginAssemblies > PluginAssembly").forEach((e=>{e.querySelectorAll("PluginTypes > PluginType").forEach((e=>{var n=e.getAttribute("Name")||"";t.plugins.push({Name:n})}))}))}catch(e){console.error("Error processing plugins from customizations.xml:",e)}}))}(r,y);var b={connectionReferences:[]};yield function(e,t){return pr(this,void 0,void 0,(function*(){try{var n=e.file(Gt);if(!n)return;var r=yield n.async("string");(new DOMParser).parseFromString(r,fr).querySelectorAll("connectionreferences > connectionreference").forEach((e=>{var n,r,i=e.getAttribute("connectionreferencelogicalname")||"",o=(null===(n=e.querySelector("connectionreferencedisplayname"))||void 0===n?void 0:n.textContent)||"",a=(null===(r=e.querySelector("connectorid"))||void 0===r?void 0:r.textContent)||"";console.log("LogicalName: ".concat(i,", DisplayName: ").concat(o,", ConnectorID: ").concat(a)),t.connectionReferences.push({LogicalName:i,DisplayName:o,ConnectorID:a})}))}catch(e){console.error("Error processing connection references:",e)}}))}(r,b);var w={aiModels:[]};yield function(e,t){return pr(this,void 0,void 0,(function*(){try{var n=e.file(Gt);if(!n)return;var r=yield n.async("string");(new DOMParser).parseFromString(r,fr).querySelectorAll("AIModels > AIModel").forEach((e=>{var n,r=(null===(n=e.querySelector("msdyn_name"))||void 0===n?void 0:n.textContent)||"";t.aiModels.push({Name:r})}))}catch(e){console.error("Error processing AI models from customizations.xml:",e)}}))}(r,w);var _,k={missingDependencies:[]};yield function(e,t){return pr(this,void 0,void 0,(function*(){try{var n=e.file("solution.xml");if(!n)return void console.error("No solution.xml found in the solution.");var r=yield n.async("string");(new DOMParser).parseFromString(r,fr).querySelectorAll("SolutionManifest > MissingDependencies > MissingDependency").forEach((e=>{var n,r,i=parseInt((null===(n=e.querySelector("Required"))||void 0===n?void 0:n.getAttribute("type"))||"0"),o=parseInt((null===(r=e.querySelector("Dependent"))||void 0===r?void 0:r.getAttribute("type"))||"0"),a=dr[i]||"",s=dr[o]||"",l=e.querySelector("Required"),c=e.querySelector("Dependent");t.missingDependencies.push({Required:{Type:a,SchemaName:(null==l?void 0:l.getAttribute("schemaName"))||"",DisplayName:(null==l?void 0:l.getAttribute("displayName"))||"",Solution:(null==l?void 0:l.getAttribute("solution"))||""},Dependent:{Type:s,SchemaName:(null==c?void 0:c.getAttribute("schemaName"))||"",DisplayName:(null==c?void 0:c.getAttribute("displayName"))||""}})}))}catch(e){console.error("Error processing missing dependencies:",e)}}))}(r,k);try{_=yield yr(r)}catch(e){_={tables:[]}}var S={solutionOverview:p,canvasApps:d.canvasApps,tables:_.tables,workflows:f.workflows,codeComponents:h.codeComponents,customApis:m.customApis,environmentVariables:g.environmentVariables,securityRoles:v.roles,plugins:y.plugins,connectionReferences:b.connectionReferences,aiModels:w.aiModels,missingDependencies:k.missingDependencies};return console.log("Extracted Solution Details:",S),S}throw new Error("Invalid solution ZIP file.")}catch(e){e instanceof Error?console.error("An error occurred during review:",e.message,e.stack):console.error("Unknown error during review:",e)}var C,A}))}function gr(e,t,n){var r,i,o,a,s,l;return pr(this,void 0,void 0,(function*(){try{var c=yield e.async("string"),u=(new DOMParser).parseFromString(c,fr),d=null!==(i=null===(r=u.querySelector("customapi > displayname"))||void 0===r?void 0:r.getAttribute("default"))&&void 0!==i?i:"",p=null!==(a=null===(o=u.querySelector("customapi > description"))||void 0===o?void 0:o.getAttribute("default"))&&void 0!==a?a:"",f="1"===(null===(s=u.querySelector("customapi > isprivate"))||void 0===s?void 0:s.textContent),h="1"===(null===(l=u.querySelector("customapi > isfunction"))||void 0===l?void 0:l.textContent);n.customApis.push({displayName:d,description:p,isPrivate:f,isFunction:h})}catch(e){console.error("Error processing customapi.xml in ".concat(t,":"),e)}}))}function vr(e,t,n){var r,i,o,a,s,l,c;return pr(this,void 0,void 0,(function*(){try{var u=yield e.async("string"),d=(new DOMParser).parseFromString(u,fr),p=null!==(i=null===(r=d.querySelector("environmentvariabledefinition > displayname"))||void 0===r?void 0:r.getAttribute("default"))&&void 0!==i?i:"",f=null!==(a=null===(o=d.querySelector("environmentvariabledefinition > displayname > label"))||void 0===o?void 0:o.getAttribute("description"))&&void 0!==a?a:"",h=null!==(l=null===(s=d.querySelector("environmentvariabledefinition > type"))||void 0===s?void 0:s.textContent)&&void 0!==l?l:"",m=null!==(c={1e8:"String",100000001:"Number",100000002:"Boolean",100000003:"JSON",100000004:"Data Source",100000005:"Secret"}[h])&&void 0!==c?c:"Unknown";n.environmentVariables.push({displayName:p,description:f,type:m})}catch(e){console.error("Error processing environmentvariabledefinition.xml in ".concat(t,":"),e)}}))}var yr=e=>pr(void 0,void 0,void 0,(function*(){console.log("Generating Tables JSON from customizations.xml");var t={tables:[]};try{var n=e.file(Gt);if(!n)return t;var r=yield n.async("string"),i=(new DOMParser).parseFromString(r,fr),o=i.querySelectorAll("Entities > Entity > Name");if(0===o.length)return t;var a=function*(){var{displayName:e,description:n,schemaName:r}=function(e,t){var n,r,i,o,a=(null===(r=null===(n=t.closest("Entity"))||void 0===n?void 0:n.querySelector("EntityInfo > entity"))||void 0===r?void 0:r.getAttribute("Name"))||"Unknown Schema Name";console.log("Extracted schemaName: ".concat(a));var s=null===(i=t.closest("Entity"))||void 0===i?void 0:i.querySelector('EntityInfo > entity > LocalizedNames > LocalizedName[languagecode="1033"]'),l=(null==s?void 0:s.getAttribute("description"))||"Unnamed Table";console.log("Extracted displayName: ".concat(l));var c=null===(o=t.closest("Entity"))||void 0===o?void 0:o.querySelector('EntityInfo > entity > Descriptions > Description[languagecode="1033"]'),u=(null==c?void 0:c.getAttribute("description"))||"";return console.log("Extracted description: ".concat(u)),{displayName:l,description:u,schemaName:a}}(0,s),o={DisplayName:e,SchemaName:r,Description:n,Fields:[],Relationships:{OneToMany:[],ManyToOne:[],ManyToMany:[]}},a=yield function(e,t){return pr(this,void 0,void 0,(function*(){var n=[];return e.querySelectorAll("Entities > Entity").forEach((e=>{var r=e.querySelector("Name");if(r&&r.textContent===t){var i=e.querySelector("attributes");i&&i.querySelectorAll("attribute").forEach((e=>{var r,i,o,a=(null===(r=e.querySelector("Name"))||void 0===r?void 0:r.textContent)||"",s=(null===(i=e.querySelector("Type"))||void 0===i?void 0:i.textContent)||"";((null===(o=e.querySelector("LogicalName"))||void 0===o?void 0:o.textContent)||"").includes("_")&&n.push({Name:a,SchemaName:t,DataType:s})}))}})),n}))}(i,r);a.forEach((e=>{o.Fields.push({Name:e.Name,SchemaName:e.SchemaName,DataType:e.DataType})}));var l=yield function(e,t){return pr(this,void 0,void 0,(function*(){var n={OneToMany:[],ManyToOne:[],ManyToMany:[]};try{e.querySelectorAll("EntityRelationships > EntityRelationship").forEach((e=>{null===(r=e.querySelector("EntityRelationshipType"))||void 0===r||r.textContent;var r,i,o,a,s,l=null===(i=e.querySelector("ReferencingEntityName"))||void 0===i?void 0:i.textContent,c=null===(o=e.querySelector("ReferencedEntityName"))||void 0===o?void 0:o.textContent,u=null===(a=e.querySelector("FirstEntityName"))||void 0===a?void 0:a.textContent,d=null===(s=e.querySelector("SecondEntityName"))||void 0===s?void 0:s.textContent;!function(e,t,n,r,i){var o,a;"OneToMany"===(null===(o=e.querySelector("EntityRelationshipType"))||void 0===o?void 0:o.textContent)&&t===r&&(null==n?void 0:n.includes("_"))&&i.OneToMany.push({SchemaName:e.getAttribute("Name")||"",ReferencingEntity:t||"",ReferencingAttribute:(null===(a=e.querySelector("ReferencingAttributeName"))||void 0===a?void 0:a.textContent)||"",ReferencedEntity:n||""})}(e,l||void 0,c||void 0,t,n),function(e,t,n,r,i){var o,a;"ManyToOne"===(null===(o=e.querySelector("EntityRelationshipType"))||void 0===o?void 0:o.textContent)&&n===r&&((null==t?void 0:t.includes("_"))||(null==n?void 0:n.includes("_")))&&i.ManyToOne.push({SchemaName:e.getAttribute("Name")||"",ReferencedEntity:n||"",ReferencingAttribute:(null===(a=e.querySelector("ReferencingAttributeName"))||void 0===a?void 0:a.textContent)||""})}(e,l||void 0,c||void 0,t,n),function(e,t,n,r,i){var o;"ManyToMany"!==(null===(o=e.querySelector("EntityRelationshipType"))||void 0===o?void 0:o.textContent)||t!==r&&n!==r||!(null==t?void 0:t.includes("_"))&&!(null==n?void 0:n.includes("_"))||i.ManyToMany.push({SchemaName:e.getAttribute("Name")||"",Entity1LogicalName:t||"",Entity2LogicalName:n||""})}(e,u||void 0,d||void 0,t,n)})),0===n.OneToMany.length&&0===n.ManyToOne.length&&0===n.ManyToMany.length&&console.warn("No relationships found for schema: ".concat(t))}catch(e){console.error("Error parsing relationships for schema: ".concat(t),e)}return n}))}(i,r);l.OneToMany.forEach((e=>{o.Relationships.OneToMany.push({SchemaName:e.SchemaName,ReferencingEntity:e.ReferencingEntity||"",ReferencingAttribute:e.ReferencingAttribute||"",ReferencedEntity:e.ReferencedEntity||""})})),l.ManyToOne.forEach((e=>{o.Relationships.ManyToOne.push({SchemaName:e.SchemaName,ReferencedEntity:e.ReferencedEntity||"",ReferencingAttribute:e.ReferencingAttribute||""})})),l.ManyToMany.forEach((e=>{o.Relationships.ManyToMany.push({SchemaName:e.SchemaName,Entity1LogicalName:e.Entity1LogicalName||"",Entity2LogicalName:e.Entity2LogicalName||""})})),t.tables.push(o)};for(var s of Array.from(o))yield*a();return console.log("Generated Tables JSON:",JSON.stringify(t,null,2)),t}catch(e){throw console.error("Error generating Tables JSON:",e),new Error("Failed to generate Tables JSON. See console for details.")}})),br=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},wr=e.memo((n=>{var{initiateReview:r,resetInitiateReview:i,webapi:o,height:a,width:s,isAuthoringMode:l,chooseButtonTitle:c,solutionName:u,onResultEvaluation:d,onDetailsExtraction:p,hideUserInterface:f,solutionFile:h,patternDetails:m,reviewSolution:g,extractSolutionDetails:v}=n,[y,b]=e.useState(),w=e.useRef(null);e.useEffect((()=>{r&&(i(),_())}));var _=()=>br(void 0,void 0,void 0,(function*(){var e=l?y:h;if(e){if(!l&&e.fileUrl)try{e=yield(t=e.fileUrl,n=e.fileName,r=e.mimeType,br(void 0,void 0,void 0,(function*(){try{var e=yield fetch(t);if(!e.ok)throw new Error("HTTP error! Status: ".concat(e.status));var i=yield e.blob();return new File([i],n,{type:r})}catch(e){throw console.error("Error fetching or processing zip file:",e),e}})))}catch(e){return void alert("Error fetching the ZIP file from URL.")}var t,n,r;try{if(g){var i=yield ur(e,u,o,m);d(i)}if(v){var a=yield mr(o,e,u);p(a)}}catch(e){console.error("Error during the review process:",e)}finally{console.log("Review evaluation completed")}}else console.log("Please upload a ZIP file to start the review.")}));return f?e.createElement("div",{style:{width:s,height:a}}):e.createElement("div",{style:{width:s,height:a,display:"flex",alignItems:"center",justifyContent:"flex-start",overflow:"hidden",boxSizing:"border-box"}},e.createElement("input",{type:"file",accept:".zip",ref:w,onChange:e=>{var t,n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n){if("application/zip"!==n.type&&!n.name.endsWith(".zip"))return alert("Please upload a valid ZIP file."),void(e.target.value="");b(n)}},style:{display:"none"}}),e.createElement(t.Button,{onClick:()=>{w.current&&w.current.click()},appearance:"primary",style:{marginRight:"10px"}},c),e.createElement(t.Text,{style:{margin:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flexGrow:1,flexShrink:1,minWidth:0}},y?"Selected Solution: ".concat(y.name):"No solution selected"))}));wr.displayName="FileUploadComponent";class _r{static getReviewSchema(){return{ReviewResults:{$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{Copilot:{type:"object",properties:{items:{type:"array",items:{type:"object",properties:{name:{type:"string"},displayName:{type:"string"},result:{type:"array",items:{type:"object",properties:{patternName:{type:"string"},patternID:{type:"string"},status:{type:"string"},instanceValue:{type:"array",items:{type:"object",properties:{Topic:{type:"array",items:{type:"object",properties:{TopicName:{type:"string"},InvalidTriggerQueries:{type:"array",items:{type:"string"}}}}},Flows:{type:"array",items:{type:"string"}},KnowledgeSource:{type:"array",items:{type:"string"}},Entity:{type:"object",properties:{RegexEntity:{type:"array",items:{type:"object",properties:{name:{type:"string"},pattern:{type:"string"},matchingPatternEntityList:{type:"array",items:{type:"string"}}}}}}}}}},failureReason:{type:"string"},recommendation:{type:"string"},docLinks:{type:"string",format:"uri"},category:{type:"string"},description:{type:"string"},severity:{type:"string"}}}},score:{type:"integer"}}}},totalBots:{type:"integer"},totalScore:{type:"number"}}},PowerAutomate:{type:"object",properties:{items:{type:"array",items:{type:"object",properties:{name:{type:"string"},displayName:{type:"string"},result:{type:"array",items:{type:"object",properties:{patternName:{type:"string"},patternID:{type:"string"},status:{type:"string"},instanceValue:{type:"array",items:{type:"string"}},failureReason:{type:"string"},recommendation:{type:"string"},docLinks:{type:"string",format:"uri"},category:{type:"string"},description:{type:"string"},severity:{type:"string"}}}},score:{type:"number"}}}},totalFlows:{type:"integer"},totalScore:{type:"number"}}},PowerApps:{type:"object",properties:{items:{type:"array",items:{type:"object",properties:{name:{type:"string"},displayName:{type:"string"},totalScreens:{type:"integer"},totalCanvasComponents:{type:"integer"},totalCodeComponents:{type:"integer"},result:{type:"array",items:{type:"object",properties:{patternName:{type:"string"},patternID:{type:"string"},status:{type:"string"},instanceValue:{type:"array",items:{type:"object",properties:{ScreenName:{type:"string"},ControlName:{type:"string"},PropertyName:{type:"string"},Code:{type:"string"},PatternName:{type:"string"},ControlType:{type:"string"}}}},failureReason:{type:"string"},recommendation:{type:"string"},docLinks:{type:"string",format:"uri"},category:{type:"string"},description:{type:"string"},severity:{type:"string"}}}},score:{type:"integer"}}}},totalApps:{type:"integer"},totalScore:{type:"number"}}},SolutionScore:{type:"number"}}},SolutionDetails:{$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{solutionOverview:{type:"object",properties:{displayName:{type:"string"},uniqueName:{type:"string"},description:{type:"string"},version:{type:"string"}},required:["displayName","uniqueName","version"]},canvasApps:{type:"array",items:{type:"object",properties:{appName:{type:"string"},appDescription:{type:"string"},screens:{type:"array",items:{type:"object",properties:{screenName:{type:"string"},screenYaml:{type:"string"}},required:["screenName","screenYaml"]}}},required:["appName","appDescription","screens"]}},tables:{type:"array",items:{type:"object",properties:{DisplayName:{type:"string"},SchemaName:{type:"string"},Description:{type:"string"},Fields:{type:"array",items:{type:"object",properties:{Name:{type:"string"},SchemaName:{type:"string"},DataType:{type:"string"}},required:["Name","SchemaName","DataType"]}},Relationships:{type:"object",properties:{OneToMany:{type:"array",items:{type:"object",properties:{SchemaName:{type:"string"},ReferencingEntity:{type:"string"},ReferencingAttribute:{type:"string"},ReferencedEntity:{type:"string"}},required:["SchemaName","ReferencingEntity","ReferencingAttribute","ReferencedEntity"]}},ManyToOne:{type:"array",items:{type:"object"}},ManyToMany:{type:"array",items:{type:"object",properties:{SchemaName:{type:"string"},Entity1LogicalName:{type:"string"},Entity2LogicalName:{type:"string"}},required:["SchemaName","Entity1LogicalName","Entity2LogicalName"]}}}}},required:["DisplayName","SchemaName","Fields","Relationships"]}},workflows:{type:"array",items:{type:"object",properties:{name:{type:"string"},primaryEntity:{type:"string"},category:{type:"string"},json:{type:"string"}},required:["name","primaryEntity","category"]}},codeComponents:{type:"array",items:{type:"object",properties:{displayName:{type:"string"},description:{type:"string"},type:{type:"string"},version:{type:"string"}},required:["displayName","description","type","version"]}},customApis:{type:"array",items:{type:"object",properties:{displayName:{type:"string"},description:{type:"string"},isPrivate:{type:"boolean"},isFunction:{type:"boolean"}},required:["displayName","description","isPrivate","isFunction"]}},environmentVariables:{type:"array",items:{type:"object",properties:{displayName:{type:"string"},description:{type:"string"},type:{type:"string"}},required:["displayName","description","type"]}},securityRoles:{type:"array",items:{type:"object",properties:{name:{type:"string"}}}},plugins:{type:"array",items:{type:"object",properties:{Name:{type:"string"}}}},connectionReferences:{type:"array",items:{type:"object",properties:{LogicalName:{type:"string"},DisplayName:{type:"string"},ConnectorID:{type:"string"}}}},aiModels:{type:"array",items:{type:"object",properties:{Name:{type:"string"}}}},missingDependencies:{type:"array",items:{type:"object",properties:{Required:{type:"object",properties:{Type:{type:"string"},SchemaName:{type:"string"},DisplayName:{type:"string"},Solution:{type:"string"}}},Dependent:{type:"object",properties:{Type:{type:"string"},SchemaName:{type:"string"},DisplayName:{type:"string"}}}}}}},required:["solutionOverview","canvasApps","tables","workflows","codeComponents","customApis","environmentVariables","securityRoles","plugins","connectionReferences","aiModels","missingDependencies"]},ReviewResultsFile:{type:"object",properties:{name:{type:"string"},type:{type:"string"},size:{type:"integer"},lastModified:{type:"integer"}},required:["name","type","size","lastModified"]}}}}class kr{constructor(){this.inputEventValue="",this.patternDetails=[]}init(e,t,n,r){this.context=e,this.notifyOutputChanged=t,this.container=r,e.mode.trackContainerResize(!0),this.onResultEvaluation=this.onResultEvaluation.bind(this),this.resetInitiateReview=this.resetInitiateReview.bind(this),this.onDetailsExtraction=this.onDetailsExtraction.bind(this)}updateView(t){var n,r,i;this.initiateReview=!1;var o=parseInt(t.mode.allocatedWidth),a=parseInt(t.mode.allocatedHeight),s=null!==(n=t.parameters.InputEvent.raw)&&void 0!==n?n:"",l=t.parameters.SolutionFile.raw,c=null!==(r=t.parameters.SolutionName.raw)&&void 0!==r?r:"",u=this.inputEventValue!==s;this.eventstobeTriggered&&this.triggerEvents();var d=t.parameters.PatternDetails;return l&&l.fileUrl&&l.fileUrl!==this.fileUrl&&(this.patternDetails=function(e){if(e.error||void 0===e.paging.totalResultCount)return[];var t={};return e.sortedRecordIds.map((n=>{var r=e.records[n],i=r.getValue("PatternID");return void 0!==t[i]?(t[i]++,i+="_".concat(t[i])):t[i]=1,{id:r.getRecordId(),key:i,text:r.getFormattedValue("PatternName"),clickable:!0,data:{patternID:r.getValue("PatternID"),patternName:r.getValue("PatternName"),description:r.getValue("PatternDescription"),recommendation:r.getValue("PatternRecommendation"),docLinks:r.getValue("PatternDocLink"),severity:r.getValue("PatternSeverity"),category:r.getValue("PatternCategory"),patternType:r.getValue("PatternType"),patternScore:r.getValue("PatternScore"),patternActive:r.getValue("PatternActive")}}}))}(d),this.fileUrl=l.fileUrl,this.initiateReview=!0),u&&s.startsWith("StartReview")&&c&&(this.inputEventValue=s,this.initiateReview=!0),e.createElement(wr,{initiateReview:this.initiateReview,webapi:t.webAPI,width:o,height:a,chooseButtonTitle:null!==(i=t.parameters.ChooseButtonTitle.raw)&&void 0!==i?i:"Choose Solution",solutionName:c,isAuthoringMode:"{00000000-0000-0000-0000-000000000000}"===t.userSettings.userId,onResultEvaluation:this.onResultEvaluation,onDetailsExtraction:this.onDetailsExtraction,resetInitiateReview:this.resetInitiateReview,reviewSolution:t.parameters.ReviewSolution.raw,extractSolutionDetails:t.parameters.ExtractSolutionDetails.raw,solutionFile:t.parameters.SolutionFile.raw,hideUserInterface:t.parameters.HideUserInterface.raw,patternDetails:this.patternDetails})}resetInitiateReview(){this.initiateReview=!1}triggerEvents(){this.context.events.OnReviewComplete(),this.eventstobeTriggered=!1}onDetailsExtraction(e){e&&this.solutionDetails!==e&&(this.solutionDetails=e,this.eventstobeTriggered=!0,this.notifyOutputChanged())}onResultEvaluation(e){e&&this.result!==e&&(this.result=e,this.eventstobeTriggered=!0,this.notifyOutputChanged())}getOutputSchema(e){return t=this,n=void 0,i=function*(){return Promise.resolve(_r.getReviewSchema())},new((r=void 0)||(r=Promise))((function(e,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(a,s)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}getOutputs(){return console.log({ReviewResults:this.result,SolutionDetails:this.solutionDetails,ReviewResultsFile:new File([this.result],"Review_Results.json",{type:"application/json"})}),{ReviewResults:this.result,SolutionDetails:this.solutionDetails,ReviewResultsFile:new File([this.result],"Review_Results.json",{type:"application/json"})}}destroy(){}}})(),pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad=r})();
if (window.ComponentFramework && window.ComponentFramework.registerControl) {
	ComponentFramework.registerControl('PowerCAT.IntelligentReviewVisualizer', pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.IntelligentReviewVisualizer);
} else {
	var PowerCAT = PowerCAT || {};
	PowerCAT.IntelligentReviewVisualizer = pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.IntelligentReviewVisualizer;
	pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad = undefined;
}