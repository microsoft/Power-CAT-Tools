# ************************************************************************************************
# Warning: YAML source code for Canvas Apps is in preview. The schema is being actively developed.
# Content may be incomplete and subject to change.
# This file is read-only and should only be used to review changes made within Power Apps Studio.
# This file isn't used when loading the app. External editing, merging and conflict resolution are
# not supported.
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  SettingsLandingScreen:
    Properties:
      Fill: =RGBA(255, 255, 255, 1)
      LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
      OnVisible: "=/* Load data for this page while spinner is loading */\r\nIf(\r\n    init <> true,\r\n    UpdateContext({pageTitle: DVAssessmentPageLoc.settings});\r\n    UpdateContext({init: true});\r\n    \r\n);\r\n"
    Children:
      - cAppFrame_5:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =ColorValue(AppTheme.palette.neutralLighterAlt)
            Height: =Parent.Height
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutOverflowY: =LayoutOverflow.Scroll
            PaddingRight: =Self.PaddingLeft
            Width: =Parent.Width
          Children:
            - cTopNav_6:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.None
                  Fill: =ColorValue(AppTheme.palette.neutralLighter)
                  FillPortions: =FlexOff
                  Height: =60
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutGap: =24
                  PaddingLeft: =20
                  PaddingRight: =20
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                  - AutoWidthLabel1_8:
                      Control: CodeComponent
                      ComponentName: cat_PowerCAT.AutoWidthLabel
                      Properties:
                        FontSize: =18
                        FontSizeUnits: ='PowerCAT.AutoWidthLabel.FontSizeUnits'.Px
                        FontWeight: ="600"
                        Height: =24
                        Text: =_featureName
                        Tooltip: ="AutoWidthLabel_Desc"
                        Width: =Self.AutoWidth
                  - TabList1_6:
                      Control: TabList@2.2.30
                      Properties:
                        AccessibleLabel: ="SettingsLandingScreenTabList"
                        DefaultSelectedItems: =LookUp(Nav, ThisRecord.Screen = App.ActiveScreen)
                        FillPortions: =FlexOn
                        Items: =Nav
                        OnChange: =Navigate(Self.Selected.Screen);
                      Children:
                        - DisplayName1_6:
                            Control: TabListDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="DisplayName"
                              FieldName: ="DisplayName"
                              FieldType: ="s"
                              Order: =1
                  - Container11_7:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =
                        BorderStyle: =BorderStyle.None
                        DropShadow: =DropShadow.None
                        Height: =Parent.Height
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutGap: =8
                        LayoutJustifyContent: =LayoutJustifyContent.End
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                      Children:
                        - LearnIcon_1:
                            Control: CodeComponent
                            ComponentName: cat_PowerCAT.Icon
                            Properties:
                              AccessibilityLabel: =DVAssessmentPageLoc.learnButtonText
                              FontColor: ="#424242"
                              Height: =Parent.Height
                              HoverFillColor: =AppTheme.palette.neutralLight
                              HoverFontColor: ="#424242"
                              HoverIconColor: ="#424242"
                              IconColor: ="#424242"
                              IconName: ="BookAnswers"
                              IconSize: =20
                              OnChange: |-
                                =Launch(
                                    "https://aka.ms/dvacc/riskassess",
                                    {},
                                    LaunchTarget.New
                                )
                              Tooltip: =DVAssessmentPageLoc.learnButtonText
                              Width: =32
                        - QuestionIcon_1:
                            Control: CodeComponent
                            ComponentName: cat_PowerCAT.Icon
                            Properties:
                              AccessibilityLabel: =DVAssessmentPageLoc.helpButtonText
                              FontColor: ="#424242"
                              Height: =Parent.Height
                              HoverFillColor: =AppTheme.palette.neutralLight
                              HoverFontColor: ="#424242"
                              HoverIconColor: ="#424242"
                              IconColor: ="#424242"
                              IconName: ="StatusCircleQuestionMark"
                              IconSize: =28
                              OnChange: |-
                                =Launch(
                                    "https://aka.ms/dvacc/riskassess/help",
                                    {},
                                    LaunchTarget.New
                                )
                              Tooltip: =DVAssessmentPageLoc.helpButtonText
                              Width: =32
                        - BugIcon_1:
                            Control: CodeComponent
                            ComponentName: cat_PowerCAT.Icon
                            Properties:
                              AccessibilityLabel: ="Report a bug"
                              FontColor: ="#424242"
                              Height: =Parent.Height
                              HoverFillColor: =AppTheme.palette.neutralLight
                              HoverFontColor: ="#424242"
                              HoverIconColor: ="#424242"
                              IconColor: ="#424242"
                              IconName: ="Bug"
                              IconSize: =20
                              OnChange: |-
                                =Launch(
                                    "https://aka.ms/dvacc/riskassess/bug",
                                    {},
                                    LaunchTarget.New
                                )
                              Tooltip: ="Report a bug"
                              Width: =32
            - cScreenContainer_3:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  Fill: =ColorValue(AppTheme.palette.neutralLighterAlt)
                  Height: =Parent.Height
                  LayoutAlignItems: =LayoutAlignItems.Stretch
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutOverflowY: =LayoutOverflow.Scroll
                  PaddingLeft: =Margins
                  PaddingRight: =Margins
                  Width: =Parent.Width
                Children:
                  - cPageHeaderMain_6:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.Center
                        DropShadow: =DropShadow.None
                        Fill: =ColorValue(AppTheme.palette.neutralLighterAlt)
                        FillPortions: =0
                        Height: =div_10.Y + 1
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =4
                        PaddingLeft: =If(Self.X = 0, Margins, 0)
                        PaddingRight: =Self.PaddingLeft
                        PaddingTop: =16
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Parent.Width - Margins
                        X: =92
                        Y: =40
                      Children:
                        - cPageHeaderTop_6:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              FillPortions: =FlexOff
                              Height: =75
                              LayoutAlignItems: =LayoutAlignItems.Center
                              LayoutDirection: =LayoutDirection.Horizontal
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =1042
                              X: =68
                              Y: =52
                            Children:
                              - cPageHeaderTitle_8:
                                  Control: GroupContainer@1.3.0
                                  Variant: AutoLayout
                                  Properties:
                                    AlignInContainer: =AlignInContainer.SetByContainer
                                    DropShadow: =DropShadow.None
                                    FillPortions: =FlexOn
                                    Height: =cHeaderText_11.Height
                                    LayoutAlignItems: =LayoutAlignItems.Center
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutGap: =16
                                    RadiusBottomLeft: =0
                                    RadiusBottomRight: =0
                                    RadiusTopLeft: =0
                                    RadiusTopRight: =0
                                    Width: =431
                                    X: =36
                                    Y: =40
                                  Children:
                                    - ButtonCanvas4_11:
                                        Control: Button@0.0.44
                                        Properties:
                                          AccessibleLabel: ="Back"
                                          Appearance: ='ButtonCanvas.Appearance'.Subtle
                                          Icon: ="ArrowLeft"
                                          Layout: ='ButtonCanvas.Layout'.IconOnly
                                          OnSelect: =Back()
                                          Text: =
                                          Width: =32
                                    - cHeaderText_11:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          FillPortions: =0
                                          Height: =rDivider_PageHeader_11.Y
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutGap: =4
                                          LayoutJustifyContent: =LayoutJustifyContent.Center
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                          Width: =Parent.Width - Self.X
                                          X: =1-1
                                          Y: '=1-1 '
                                        Children:
                                          - h2Title_11:
                                              Control: Text@0.0.50
                                              Properties:
                                                Align: ='TextCanvas.Align'.Start
                                                AlignInContainer: =AlignInContainer.Start
                                                Font: =Font.'Segoe UI'
                                                Height: =36
                                                Size: =20
                                                Text: =pageTitle
                                                Weight: ='TextCanvas.Weight'.Semibold
                                                Width: =Parent.Width - Self.X * 2
                                                X: =394.49
                                          - Label3_13:
                                              Control: Label@2.5.1
                                              Properties:
                                                AlignInContainer: =AlignInContainer.Start
                                                AutoHeight: =true
                                                BorderColor: =RGBA(0, 18, 107, 1)
                                                Color: =ColorValue("#424242")
                                                Font: =Font.'Segoe UI'
                                                LineHeight: =1.4
                                                PaddingBottom: =0
                                                PaddingLeft: =0
                                                PaddingRight: =0
                                                PaddingTop: =0
                                                Size: =Switch(App.ActiveScreen.Size,ScreenSize.Small,11,ScreenSize.Medium,12,14)*0.75
                                                Text: ="Define your risk tolerance and how often assessment scans run on roles in this environment."
                                                VerticalAlign: =VerticalAlign.Top
                                                Visible: =!IsBlank(Self.Text)
                                                Width: =Min(600, Parent.Width)
                                                X: =394.49
                                          - rDivider_PageHeader_11:
                                              Control: Rectangle@2.3.0
                                              Properties:
                                                AlignInContainer: =AlignInContainer.Start
                                                Fill: =RGBA(0,0,0,0)
                                                Height: =1
                                                Width: =Parent.Width - Self.X * 2
                                                X: =72
                                                Y: =52
                              - tlbRight_14:
                                  Control: Toolbar@2.0.5
                                  Properties:
                                    AccessibleLabel: ="Toolbar"
                                    Height: =44
                                    Items: |-
                                      =Table({ItemKey:"1",ItemDisplayName:"",ItemIconName:"Circle",ItemAppearance:"Subtle",ItemIconStyle:"Subtle",ItemTooltip:"Action"},{ItemKey:"2",ItemDisplayName:"",ItemIconName:"Circle",ItemAppearance:"Subtle",ItemIconStyle:"Subtle"},{ItemKey:"3",ItemDisplayName:"",ItemIconName:"Circle",ItemDisabled: false ,ItemAppearance:"Subtle"})
                                    Visible: =false
                                    Width: =200
                        - div_10:
                            Control: Rectangle@2.3.0
                            Properties:
                              AlignInContainer: =AlignStart
                              Fill: =ColorValue(AppTheme.palette.neutralLight)
                              Height: =1
                              Width: =Parent.Width - Self.X * 2
                              X: =84
                              Y: =256
                  - cBuffer_6:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        FillPortions: =FlexOff
                        Height: =16
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                  - Container2_2:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.Center
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =Max(cBufferHub_2.Y + cBufferHub_2.Height, Parent.Height-Self.Y)
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =16
                        PaddingLeft: =2
                        PaddingRight: =2
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =Parent.Width - Margins
                      Children:
                        - MainContainer1_4:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              AlignInContainer: =AlignInContainer.Start
                              BorderColor: =
                              BorderStyle: =BorderStyle.None
                              DropShadow: =DropShadow.None
                              Fill: =RGBA(0, 0, 0, 0)//RGBA(255, 255, 255, 1)
                              FillPortions: =0
                              Height: =Max(div_15.Y, 120)
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutGap: =16
                              PaddingLeft: =5
                              PaddingTop: =5
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Parent.Width - Self.X * 2
                            Children:
                              - cGetStartedPane:
                                  Control: GroupContainer@1.3.0
                                  Variant: AutoLayout
                                  Properties:
                                    AlignInContainer: =AlignInContainer.Start
                                    BorderColor: =RGBA(209, 209, 209, 1)
                                    DropShadow: =DropShadow.Semilight
                                    Fill: =RGBA(255, 255, 255, 1)
                                    FillPortions: =0
                                    Height: |-
                                      =If(
                                          SettingsLandingScreen.Size = 1 || (SettingsLandingScreen.Size = 2 && SettingsLandingScreen.Orientation = Layout.Horizontal && SettingsLandingScreen.Width <= 800),
                                          cSetupLeft.Height + cSetupRight.Height + 60,
                                          Max(
                                              cSetupLeft.Height,
                                              cSetupRight.Height
                                          )+20
                                      )
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutGap: =24
                                    LayoutWrap: =true
                                    PaddingBottom: =16
                                    PaddingLeft: =24
                                    PaddingRight: =16
                                    PaddingTop: =16
                                    RadiusBottomLeft: =8
                                    RadiusBottomRight: =8
                                    RadiusTopLeft: =8
                                    RadiusTopRight: =8
                                    Visible: =showSettingsSetupCard <> false
                                    Width: =Parent.Width-10//AssessmentSettingsListContainer.Width
                                  Children:
                                    - Container29:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          Height: =cSetupLeft.Height
                                          LayoutDirection: =LayoutDirection.Horizontal
                                          LayoutGap: =16
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                          - Image3:
                                              Control: Image@2.2.3
                                              Properties:
                                                BorderColor: =RGBA(0, 0, 0, 0)
                                                BorderStyle: =BorderStyle.None
                                                BorderThickness: =2
                                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                                DisabledFill: =RGBA(0, 0, 0, 0)
                                                Height: =46
                                                HoverBorderColor: =RGBA(0, 0, 0, 0)
                                                HoverFill: =RGBA(0, 0, 0, 0)
                                                Image: ='Task List Square Settings'
                                                PressedBorderColor: =RGBA(0, 0, 0, 0)
                                                PressedFill: =RGBA(0, 0, 0, 0)
                                                Width: =46
                                          - cSetupLeft:
                                              Control: GroupContainer@1.3.0
                                              Variant: AutoLayout
                                              Properties:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                DropShadow: =DropShadow.None
                                                Height: =SetupRiskAssessmentSettingsText.Height + ReviewandUpdateAssessmentSettingsText.Height + btnManageAssessmentSettings.Height
                                                LayoutDirection: =LayoutDirection.Vertical
                                                RadiusBottomLeft: =0
                                                RadiusBottomRight: =0
                                                RadiusTopLeft: =0
                                                RadiusTopRight: =0
                                              Children:
                                                - Container16:
                                                    Control: GroupContainer@1.3.0
                                                    Variant: AutoLayout
                                                    Properties:
                                                      BorderColor: =
                                                      BorderStyle: =BorderStyle.None
                                                      DropShadow: =DropShadow.None
                                                      FillPortions: =0
                                                      Height: =SetupRiskAssessmentSettingsText.Height
                                                      LayoutAlignItems: =LayoutAlignItems.Center
                                                      LayoutDirection: =LayoutDirection.Horizontal
                                                      RadiusBottomLeft: =0
                                                      RadiusBottomRight: =0
                                                      RadiusTopLeft: =0
                                                      RadiusTopRight: =0
                                                    Children:
                                                      - SetupRiskAssessmentSettingsText:
                                                          Control: Text@0.0.50
                                                          Properties:
                                                            FillPortions: =FlexOff
                                                            Font: =Font.'Segoe UI'
                                                            Height: |-
                                                              =If(
                                                                  SettingsLandingScreen.Size = 1 || SettingsLandingScreen.Size = 2,
                                                                  58,
                                                                  32
                                                              )
                                                            Size: =20
                                                            Text: ="Set up your assessment settings"
                                                            Weight: ='TextCanvas.Weight'.Semibold
                                                            Width: =300
                                                      - InfoButton_Settings:
                                                          Control: InfoButton@0.0.31
                                                          Properties:
                                                            AccessibleLabel: ="InfoButton"
                                                            Content: ="Click manage to review and update the risk ratings for each security role access level in the default profile, which is used to assess the risk of a security role during scans."
                                                            Height: =24
                                                            Width: =22
                                                - ReviewandUpdateAssessmentSettingsText:
                                                    Control: FluentV8/Label@1.8.6
                                                    Properties:
                                                      AutoHeight: =true
                                                      FontSize: =12 * 0.725
                                                      Text: ="Review and update your risk assessment settings profile before scanning."
                                                      Width: =Parent.Width-20
                                                - btnManageAssessmentSettings:
                                                    Control: Button@0.0.44
                                                    Properties:
                                                      AccessibleLabel: ="Review default"
                                                      Appearance: ='ButtonCanvas.Appearance'.Secondary
                                                      DisplayMode: =If(isLoggedInUserSysAdmin,DisplayMode.Edit,DisplayMode.Disabled)
                                                      OnSelect: |
                                                        =Set(
                                                            currentSelectedAssessmentSetting,
                                                            DefaultRiskAssessmentSetting
                                                        );
                                                        Navigate(EditSettingsScreen);
                                                      Text: ="Review default "
                                                      Width: =120
                                    - Rectangle3_3:
                                        Control: Rectangle@2.3.0
                                        Properties:
                                          BorderColor: =RGBA(166, 166, 166, 1)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          Fill: =ColorValue(AppTheme.palette.neutralLight)
                                          FocusedBorderColor: =RGBA(0, 120, 212, 1)
                                          Height: =Parent.Height - 48
                                          Visible: |-
                                            =If(
                                                SettingsLandingScreen.Size = 1 || (SettingsLandingScreen.Size = 2 && SettingsLandingScreen.Orientation = Layout.Horizontal && SettingsLandingScreen.Width <= 800),
                                                false,
                                                true
                                            )
                                          Width: =1
                                    - cSetupRight:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          AlignInContainer: =AlignInContainer.SetByContainer
                                          DropShadow: =DropShadow.None
                                          Height: =ReadyToScanText.Height + AutoScanningText.Height + Container32.Height
                                          LayoutDirection: =LayoutDirection.Vertical
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                          - ReadyToScanText:
                                              Control: Text@0.0.50
                                              Properties:
                                                Size: =20
                                                Text: =If(AutoScanEnvVar.Value = "yes", "Auto scanning enabled", "Ready to scan?")
                                                Weight: ='TextCanvas.Weight'.Semibold
                                                Width: =Parent.Width
                                          - AutoScanningText:
                                              Control: FluentV8/Label@1.8.6
                                              Properties:
                                                AutoHeight: =true
                                                FontSize: =12 * 0.725
                                                Text: =If( AutoScanEnvVar.Value = "yes", "Auto scanning is enabled; every role change triggers a new scan and updates the assessment results for that role.", "Scan all roles once, or enable auto scanning for continuous evaluation whenever changes are made to security roles.")
                                                VerticalAlignment: =VerticalAlign.Top
                                                Width: =Parent.Width-20
                                          - Container32:
                                              Control: GroupContainer@1.3.0
                                              Variant: AutoLayout
                                              Properties:
                                                AlignInContainer: =AlignInContainer.Start
                                                DropShadow: =DropShadow.None
                                                FillPortions: =0
                                                Height: |-
                                                  =If(
                                                      SettingsLandingScreen.Size = 1,
                                                      btnScanAllRoles_SettingScreen.Height+btnEnableAutoScan_SettingsScreen.Height+10,
                                                      44
                                                  )
                                                LayoutAlignItems: =LayoutAlignItems.Center
                                                LayoutDirection: =LayoutDirection.Horizontal
                                                LayoutGap: =8//If(AutoScanEnvVar.Value <> "yes", 8)
                                                LayoutWrap: =true
                                                RadiusBottomLeft: =0
                                                RadiusBottomRight: =0
                                                RadiusTopLeft: =0
                                                RadiusTopRight: =0
                                                Width: =Parent.Width-20
                                              Children:
                                                - btnScanAllRoles_SettingScreen:
                                                    Control: Button@0.0.44
                                                    Properties:
                                                      AccessibleLabel: =DVAssessmentPageLoc.scanAllRoles
                                                      Appearance: ='ButtonCanvas.Appearance'.Secondary
                                                      DisplayMode: =If(CountRows(AllCustomSecurityRoles)>0 && isLoggedInUserSysAdmin,DisplayMode.Edit,DisplayMode.Disabled)
                                                      OnSelect: "=If(\n    BatchStatus = \"Running\",\n    Notify(\n        \"Scanning of the role is still in inprogress State. Please try after some time\",\n        NotificationType.Information,\n        5000\n    ),\n    UpdateContext(\n        {\n            init: false,\n            spinnerLabelForEditSettings: \"Queuing scans...\"\n        }\n    );\n    With(\n        {\n            s: \"msdyn_DVAcceleratorBatchStatus\",\n            v: JSON(\n                First(\n                    Table(\n                        {\n                            BatchId: GUID(),\n                            BatchStatus: \"Running\"\n                        }\n                    )\n                )\n            )\n        },\n        If(\n            IsBlankOrError(BatchStatusEnvVar),\n            Patch(\n                [@'Environment Variable Values'],\n                Defaults([@'Environment Variable Values']),\n                {\n                    'Environment Variable Definition': LookUp(\n                        'Environment Variable Definitions',\n                        'Schema Name' = s\n                    ),\n                    'Schema Name': s,\n                    Value: v\n                }\n            ),\n            Patch(\n                [@'Environment Variable Values'],\n                BatchStatusEnvVar,\n                {\n                    'Schema Name': s,\n                    Value: v\n                }\n            )\n        )\n    );\n    '[RiskAssessment]Scanallcustomroles'.Run(Blank());\n    Concurrent(\n        Refresh('Risk Assessments'),\n        Refresh('Security Roles'),\n        Refresh('Environment Variable Definitions'),\n        Refresh('Environment Variable Values')\n    );\n    Notify(\n        \"Currently scanning all roles, this might take a few minutes. Refresh to get the latest status\",\n        NotificationType.Information,\n        5000\n    );\n    UpdateContext(\n        {\n            init: true,\n            spinnerLabelForEditSettings: \"\"\n        }\n    );\n    \n);\n"
                                                      Text: ="Scan all roles"
                                                      Width: =114
                                                      X: =-9
                                                - btnEnableAutoScan_SettingsScreen:
                                                    Control: Button@0.0.44
                                                    Properties:
                                                      AccessibleLabel: =DVAssessmentPageLoc.enableAutoScan
                                                      Appearance: ='ButtonCanvas.Appearance'.Secondary
                                                      DisplayMode: =DisplayMode.Edit//If(AutoScanEnvVar.Value <> "yes", DisplayMode.Edit, DisplayMode.Disabled)
                                                      OnSelect: |
                                                        =With(
                                                            {
                                                                s: "msdyn_DVAcceleratorAutoScan",
                                                                v: "yes"
                                                            },
                                                            If(
                                                                IsBlankOrError(AutoScanEnvVar),
                                                                Patch(
                                                                    [@'Environment Variable Values'],
                                                                    Defaults([@'Environment Variable Values']),
                                                                    {
                                                                        'Environment Variable Definition': LookUp(
                                                                            'Environment Variable Definitions',
                                                                            'Schema Name' = s
                                                                        ),
                                                                        'Schema Name': s,
                                                                        Value: v
                                                                    }
                                                                ),
                                                                Patch(
                                                                    [@'Environment Variable Values'],
                                                                    AutoScanEnvVar,
                                                                    {
                                                                        'Schema Name': s,
                                                                        Value: v
                                                                    }
                                                                )
                                                            )
                                                        );
                                                      Text: ="Enable auto scan"
                                                      Visible: =//AutoScanEnvVar.Value <> "yes"
                                                      Width: =138
                                                      X: =110
                                    - HidecGetStartedPaneButton:
                                        Control: Button@0.0.44
                                        Properties:
                                          AccessibleLabel: ="Dismiss"
                                          Appearance: ='ButtonCanvas.Appearance'.Subtle
                                          Icon: ="Dismiss"
                                          OnSelect: |-
                                            =UpdateContext({ showSettingsSetupCard: false })
                                          Text: =
                                          Visible: =If(SettingsLandingScreen.Size=1|| (SettingsLandingScreen.Size = 2 && SettingsLandingScreen.Orientation = Layout.Horizontal && SettingsLandingScreen.Width <= 800),false,true)
                                          Width: =32
                              - txtAssessmentSettingsHeading:
                                  Control: Text@0.0.50
                                  Properties:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Font: =Font.'Segoe UI'
                                    FontColor: |
                                      =RGBA(36, 36, 36, 1)
                                    Height: =28
                                    Size: =16
                                    Text: =DVAssessmentPageLoc.assessmentSettingsHeading
                                    Weight: ='TextCanvas.Weight'.Semibold
                              - AssessmentSettingsInfoContainer:
                                  Control: GroupContainer@1.3.0
                                  Variant: AutoLayout
                                  Properties:
                                    AlignInContainer: =AlignInContainer.Start
                                    BorderColor: =RGBA(255, 255, 255, 0)
                                    DropShadow: =DropShadow.Semilight
                                    Fill: =RGBA(255, 255, 255, 1)
                                    FillPortions: =0
                                    Height: =Container14.Height+Rectangle1.Height+Container15.Height+22
                                    LayoutDirection: =LayoutDirection.Vertical
                                    PaddingBottom: =16
                                    PaddingLeft: =16
                                    PaddingRight: =16
                                    PaddingTop: =16
                                    RadiusBottomLeft: =8
                                    RadiusBottomRight: =8
                                    RadiusTopLeft: =8
                                    RadiusTopRight: =8
                                    Width: =Parent.Width-10
                                  Children:
                                    - Container14:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          BorderColor: =
                                          BorderStyle: =BorderStyle.None
                                          DropShadow: =DropShadow.None
                                          FillPortions: =0
                                          Height: =RiskProfilesTextContainer.Height
                                          LayoutAlignItems: =LayoutAlignItems.Center
                                          LayoutDirection: =LayoutDirection.Horizontal
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                          - RiskProfilesTextContainer:
                                              Control: GroupContainer@1.3.0
                                              Variant: AutoLayout
                                              Properties:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =
                                                BorderStyle: =BorderStyle.None
                                                DropShadow: =DropShadow.None
                                                Height: =TextCanvas5.Height+TextCanvas6.Height+36
                                                LayoutDirection: =LayoutDirection.Vertical
                                                PaddingBottom: =12
                                                PaddingLeft: =12
                                                PaddingRight: =12
                                                PaddingTop: =12
                                                RadiusBottomLeft: =0
                                                RadiusBottomRight: =0
                                                RadiusTopLeft: =0
                                                RadiusTopRight: =0
                                              Children:
                                                - TextCanvas5:
                                                    Control: Text@0.0.50
                                                    Properties:
                                                      AlignInContainer: =AlignInContainer.Stretch
                                                      Font: =Font.'Segoe UI'
                                                      FontColor: |-
                                                        =RGBA(
                                                            36,
                                                            36,
                                                            36,
                                                            1
                                                        )
                                                      Height: =24
                                                      Size: =16
                                                      Text: ="Risk profiles"
                                                - TextCanvas6:
                                                    Control: Text@0.0.50
                                                    Properties:
                                                      AlignInContainer: =AlignInContainer.Start
                                                      Font: =Font.'Segoe UI'
                                                      FontColor: |-
                                                        =RGBA(
                                                            36,
                                                            36,
                                                            36,
                                                            1
                                                        )
                                                      Height: |-
                                                        =If(
                                                            SettingsLandingScreen.Size = 1 || SettingsLandingScreen.Size = 2 ,
                                                            40,
                                                            22
                                                        )
                                                      Text: ="Control the risk assessment settings that are shared."
                                                      Width: =Parent.Width-20
                                          - btnNavigateToProfiles:
                                              Control: Button@0.0.44
                                              Properties:
                                                AccessibleLabel: ="Navigate to profiles"
                                                Align: =Align.Right
                                                Appearance: ='ButtonCanvas.Appearance'.Transparent
                                                DisplayMode: =If(isLoggedInUserSysAdmin,DisplayMode.Edit,DisplayMode.Disabled)
                                                FillPortions: =1
                                                Font: =Font.'Segoe UI'
                                                FontColor: =RGBA(66,66,66,1)
                                                FontSize: =14
                                                FontWeight: =FontWeight.Normal
                                                Icon: ="ChevronRight"
                                                Layout: ='ButtonCanvas.Layout'.IconAfter
                                                OnSelect: =Navigate(BaselineSettingsScreen);
                                                Text: =CountRows(Filter(AllRiskAssessmentsSettings,Status= 'Status (Risk Assessment Settings)'.Active)) &"  profiles"
                                                VerticalAlign: =
                                                Width: =130
                                    - Rectangle1:
                                        Control: Rectangle@2.3.0
                                        Properties:
                                          AlignInContainer: =AlignInContainer.Stretch
                                          BorderColor: =RGBA(166, 166, 166, 1)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          DisabledFill: =
                                          DisplayMode: =DisplayMode.View
                                          Fill: =ColorValue(AppTheme.palette.neutralLight)
                                          FocusedBorderColor: =RGBA(0, 120, 212, 1)
                                          Height: =1
                                          HoverFill: =
                                          PressedFill: =
                                          Width: =Parent.Width-30
                                    - Container15:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          BorderColor: =
                                          BorderStyle: =BorderStyle.None
                                          DropShadow: =DropShadow.None
                                          FillPortions: =0
                                          Height: =DefaultSettingsTextContainer.Height
                                          LayoutAlignItems: =LayoutAlignItems.Center
                                          LayoutDirection: =LayoutDirection.Horizontal
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                          - DefaultSettingsTextContainer:
                                              Control: GroupContainer@1.3.0
                                              Variant: AutoLayout
                                              Properties:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =
                                                BorderStyle: =BorderStyle.None
                                                DropShadow: =DropShadow.None
                                                Height: =txtDefaultSettings.Height+txtSelectProfile.Height+36
                                                LayoutDirection: =LayoutDirection.Vertical
                                                PaddingBottom: =12
                                                PaddingLeft: =12
                                                PaddingRight: =12
                                                PaddingTop: =12
                                                RadiusBottomLeft: =0
                                                RadiusBottomRight: =0
                                                RadiusTopLeft: =0
                                                RadiusTopRight: =0
                                              Children:
                                                - txtDefaultSettings:
                                                    Control: Text@0.0.50
                                                    Properties:
                                                      AlignInContainer: =AlignInContainer.Stretch
                                                      Font: =Font.'Segoe UI'
                                                      FontColor: |-
                                                        =RGBA(
                                                            36,
                                                            36,
                                                            36,
                                                            1
                                                        )
                                                      Height: =24
                                                      Size: =16
                                                      Text: ="Default settings"
                                                - txtSelectProfile:
                                                    Control: Text@0.0.50
                                                    Properties:
                                                      AlignInContainer: =AlignInContainer.Stretch
                                                      Font: =Font.'Segoe UI'
                                                      FontColor: |-
                                                        =RGBA(
                                                            36,
                                                            36,
                                                            36,
                                                            1
                                                        )
                                                      Height: |-
                                                        =If(
                                                            SettingsLandingScreen.Size = 1 || SettingsLandingScreen.Size = 2 ,
                                                            40,
                                                            22
                                                        )
                                                      Text: ="Select which risk assessment profile is automatically run"
                                                      Width: =Parent.Width
                                          - btnNavigateToProfiles_1:
                                              Control: Button@0.0.44
                                              Properties:
                                                AccessibleLabel: ="Navigate to default profile"
                                                Align: =Align.Right
                                                AlignInContainer: =AlignInContainer.Center
                                                Appearance: ='ButtonCanvas.Appearance'.Transparent
                                                DisplayMode: =If(isLoggedInUserSysAdmin,DisplayMode.Edit,DisplayMode.Disabled)
                                                FillPortions: =1
                                                Font: =Font.'Segoe UI'
                                                FontColor: =RGBA(66,66,66,1)
                                                FontSize: =14
                                                FontWeight: =FontWeight.Normal
                                                Icon: ="ChevronRight"
                                                Layout: ='ButtonCanvas.Layout'.IconAfter
                                                OnSelect: =Navigate(UpdateDefaultSettingScreen);
                                                Text: ="Default risk assessment profile"
                                                VerticalAlign: =
                                                Width: =300
                              - txtScanFrequency:
                                  Control: Text@0.0.50
                                  Properties:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Font: =Font.'Segoe UI'
                                    FontColor: |
                                      =RGBA(36, 36, 36, 1)
                                    Height: =28
                                    Size: =16
                                    Text: ="Scan frequency"
                                    Weight: ='TextCanvas.Weight'.Semibold
                              - ScanFrequencyContainer:
                                  Control: GroupContainer@1.3.0
                                  Variant: AutoLayout
                                  Properties:
                                    AlignInContainer: =AlignInContainer.Start
                                    BorderColor: =RGBA(255, 255, 255, 0)
                                    DropShadow: =DropShadow.Semilight
                                    Fill: =RGBA(255, 255, 255, 1)
                                    FillPortions: =0
                                    Height: =Container14_1.Height+20
                                    LayoutDirection: =LayoutDirection.Vertical
                                    PaddingBottom: =12
                                    PaddingLeft: =12
                                    PaddingRight: =12
                                    PaddingTop: =12
                                    RadiusBottomLeft: =8
                                    RadiusBottomRight: =8
                                    RadiusTopLeft: =8
                                    RadiusTopRight: =8
                                    Width: =Parent.Width-10
                                  Children:
                                    - Container14_1:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          BorderColor: =
                                          BorderStyle: =BorderStyle.None
                                          DropShadow: =DropShadow.None
                                          FillPortions: =0
                                          Height: =ContinuousScanningContainer.Height
                                          LayoutAlignItems: =LayoutAlignItems.Center
                                          LayoutDirection: =LayoutDirection.Horizontal
                                          RadiusBottomLeft: =0
                                          RadiusBottomRight: =0
                                          RadiusTopLeft: =0
                                          RadiusTopRight: =0
                                        Children:
                                          - ContinuousScanningContainer:
                                              Control: GroupContainer@1.3.0
                                              Variant: AutoLayout
                                              Properties:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =
                                                BorderStyle: =BorderStyle.None
                                                DropShadow: =DropShadow.None
                                                Height: =txtContinuousScanning.Height+TextCanvas6_1.Height+36
                                                LayoutDirection: =LayoutDirection.Vertical
                                                PaddingBottom: =12
                                                PaddingLeft: =12
                                                PaddingRight: =12
                                                PaddingTop: =12
                                                RadiusBottomLeft: =0
                                                RadiusBottomRight: =0
                                                RadiusTopLeft: =0
                                                RadiusTopRight: =0
                                              Children:
                                                - txtContinuousScanning:
                                                    Control: Text@0.0.50
                                                    Properties:
                                                      AlignInContainer: =AlignInContainer.Stretch
                                                      Font: =Font.'Segoe UI'
                                                      FontColor: |-
                                                        =RGBA(
                                                            36,
                                                            36,
                                                            36,
                                                            1
                                                        )
                                                      Height: =24
                                                      Size: =16
                                                      Text: ="Continuous scanning"
                                                - TextCanvas6_1:
                                                    Control: Text@0.0.50
                                                    Properties:
                                                      AlignInContainer: =AlignInContainer.Start
                                                      Font: =Font.'Segoe UI'
                                                      FontColor: |-
                                                        =RGBA(
                                                            36,
                                                            36,
                                                            36,
                                                            1
                                                        )
                                                      Height: |-
                                                        =If(
                                                            SettingsLandingScreen.Size = 1 || SettingsLandingScreen.Size = 2 || (SettingsLandingScreen.Size = 3 && SettingsLandingScreen.Orientation = Layout.Horizontal),
                                                            40,
                                                            22
                                                        )
                                                      Text: ="When this setting is on, an new role created or update to an existing custom role in this environment will trigger a new risk assessment scan."
                                                      Width: =Parent.Width-20
                                          - toggleAutoRun:
                                              Control: Toggle@1.1.5
                                              Properties:
                                                AccessibleLabel: ="Toggle auto run"
                                                BasePaletteColor: |
                                                  =RGBA(15, 108, 189, 1)
                                                Checked: |-
                                                  =If(
                                                     AutoScanEnvVar.Value = "yes",
                                                      true,
                                                      false
                                                  )
                                                DisplayMode: |-
                                                  =If(
                                                      isLoggedInUserSysAdmin && CountRows('Risk Assessment Settings'.'Risk Assessment Setting') > 0,
                                                      DisplayMode.Edit,
                                                      DisplayMode.Disabled
                                                  )
                                                Label: =
                                                OnCheck: |
                                                  =UpdateContext(
                                                      {
                                                          init: false,
                                                          spinnerLabelForEditSettings: "Enabling auto scan..."
                                                      }
                                                  );
                                                  With(
                                                      {
                                                          s: "msdyn_DVAcceleratorAutoScan",
                                                          v: "yes"
                                                      },
                                                      If(
                                                          IsBlankOrError(AutoScanEnvVar),
                                                          Patch(
                                                              [@'Environment Variable Values'],
                                                              Defaults([@'Environment Variable Values']),
                                                              {
                                                                  'Environment Variable Definition': LookUp(
                                                                      'Environment Variable Definitions',
                                                                      'Schema Name' = s
                                                                  ),
                                                                  'Schema Name': s,
                                                                  Value: v
                                                              }
                                                          ),
                                                          Patch(
                                                              [@'Environment Variable Values'],
                                                              AutoScanEnvVar,
                                                              {
                                                                  'Schema Name': s,
                                                                  Value: v
                                                              }
                                                          )
                                                      )
                                                  );
                                                  If(
                                                      CountOfCustomSecurityRoles > 0,
                                                      If(
                                                          BatchStatus = "Running",
                                                          Notify(
                                                              "Scanning of the role is still in inprogress State. Please try after some time",
                                                              NotificationType.Information,
                                                              5000
                                                          ),
                                                          UpdateContext({spinnerLabelForEditSettings: "Queuing scan..."});
                                                          With(
                                                              {
                                                                  s: "msdyn_DVAcceleratorBatchStatus",
                                                                  v: JSON(
                                                                      First(
                                                                          Table(
                                                                              {
                                                                                  BatchId: GUID(),
                                                                                  BatchStatus: "Running"
                                                                              }
                                                                          )
                                                                      )
                                                                  )
                                                              },
                                                              If(
                                                                  IsBlankOrError(BatchStatusEnvVar),
                                                                  Patch(
                                                                      [@'Environment Variable Values'],
                                                                      Defaults([@'Environment Variable Values']),
                                                                      {
                                                                          'Environment Variable Definition': LookUp(
                                                                              'Environment Variable Definitions',
                                                                              'Schema Name' = s
                                                                          ),
                                                                          'Schema Name': s,
                                                                          Value: v
                                                                      }
                                                                  ),
                                                                  Patch(
                                                                      [@'Environment Variable Values'],
                                                                      BatchStatusEnvVar,
                                                                      {
                                                                          'Schema Name': s,
                                                                          Value: v
                                                                      }
                                                                  )
                                                              )
                                                          );
                                                          '[RiskAssessment]Scanallcustomroles'.Run(Blank());
                                                          Concurrent(
                                                              Refresh('Risk Assessments'),
                                                              Refresh('Security Roles'),
                                                              Refresh('Environment Variable Definitions'),
                                                              Refresh('Environment Variable Values')
                                                          );
                                                          Notify(
                                                              "Currently scanning all roles, this might take a few minutes. Refresh to get the latest status",
                                                              NotificationType.Information,
                                                              5000
                                                          );
                                                      ),
                                                      false
                                                  );
                                                  UpdateContext(
                                                      {
                                                          init: true,
                                                          spinnerLabelForEditSettings: ""
                                                      }
                                                  );
                                                OnUncheck: |-
                                                  =

                                                  UpdateContext({
                                                      init:false,
                                                      spinnerLabelForEditSettings:"Disabling auto scan..."
                                                  });


                                                  With(
                                                      {
                                                          s: "msdyn_DVAcceleratorAutoScan",
                                                          v: "no"
                                                      },
                                                      If(
                                                          IsBlankOrError(AutoScanEnvVar),
                                                          Patch(
                                                              [@'Environment Variable Values'],
                                                              Defaults([@'Environment Variable Values']),
                                                              {
                                                                  'Environment Variable Definition': LookUp(
                                                                      'Environment Variable Definitions',
                                                                      'Schema Name' = s
                                                                  ),
                                                                  'Schema Name': s,
                                                                  Value: v
                                                              }
                                                          ),
                                                          Patch(
                                                              [@'Environment Variable Values'],
                                                              AutoScanEnvVar,
                                                              {
                                                                  'Schema Name': s,
                                                                  Value: v
                                                              }
                                                          )
                                                      )
                                                  );

                                                  UpdateContext({
                                                      init:true,
                                                      spinnerLabelForEditSettings:Blank()
                                                  });
                              - div_15:
                                  Control: Rectangle@2.3.0
                                  Properties:
                                    AlignInContainer: =AlignStart
                                    Fill: =RGBA(0,0,0,0)
                                    Height: =2
                                    Width: =Parent.Width - Self.X * 2
                                    X: =84
                                    Y: =256
                        - cBufferHub_2:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              FillPortions: =FlexOff
                              Height: =24
                              LayoutDirection: =LayoutDirection.Vertical
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
      - cSpinner_7:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 0.7)
            Height: =Parent.Height
            LayoutDirection: =LayoutDirection.Vertical
            Visible: =init <> true
            Width: =Parent.Width
          Children:
            - Spinner1_10:
                Control: Spinner@1.4.6
                Properties:
                  AccessibleLabel: ="Spinner"
                  Height: =Parent.Height
                  Label: =spinnerLabelForEditSettings
                  SpinnerSize: ='Spinner.SpinnerSize'.Large
                  Width: =Parent.Width
